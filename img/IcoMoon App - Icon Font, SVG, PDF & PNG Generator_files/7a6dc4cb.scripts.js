function RGBColor(a){this.ok=!1,"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in b)a==c&&(a=b[c]);for(var d=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],e=0;e<d.length;e++){var f=d[e].re,g=d[e].process,h=f.exec(a);h&&(channels=g(h),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},this.getHelpXML=function(){for(var a=new Array,c=0;c<d.length;c++)for(var e=d[c].example,f=0;f<e.length;f++)a[a.length]=e[f];for(var g in b)a[a.length]=g;var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var c=0;c<a.length;c++)try{var i=document.createElement("li"),j=new RGBColor(a[c]),k=document.createElement("div");k.style.cssText="margin: 3px; border: 1px solid black; background:"+j.toHex()+"; "+"color:"+j.toHex(),k.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+a[c]+" -> "+j.toRGB()+" -> "+j.toHex());i.appendChild(k),i.appendChild(l),h.appendChild(i)}catch(m){}return h}}!function(){"use strict";String.prototype.hashCode=function(){var a,b,c=0,d=this.length;for(b=0;d>b;b+=1)a=this.charCodeAt(b),c=31*c+a,c|=0;return c},String.fromCodePoint=String.fromCodePoint||function(){for(var a,b=arguments.length,c=[];b--;){if(a=arguments[b],0>a||a>1114111)throw new RangeError;65536>a?c.unshift(a):(a-=65536,c.unshift(55296|a>>10,56320|1023&a))}return String.fromCharCode.apply(String,c)},String.prototype.codePointAt=String.prototype.codePointAt||function(a){var b=this.toString(),c=b.length,d=b.charCodeAt(a),e=b.charCodeAt(a+1);return 0>a||a>=c?0/0:55296>d||d>56319||a+1===c?d:56320>e||d>57343?d:65536+1024*(d-55296)+e-56320},ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){var c,d,e,f=new Uint8Array(this);for("undefined"==typeof b&&(b=f.length),e=new Uint8Array(b-a),d=e.length,c=0;d>c;c+=1)e[c]=f[c+a];return e.buffer}),ArrayBuffer.prototype.toString=function(a){if(a){var b,c=new Uint8Array(this),d=this.byteLength,e="";for(b=0;d>b;b+=1)e+=String.fromCharCode(c[b]);return btoa(e)}return"[object ArrayBuffer]"};try{var a=window.indexedDB,b=a.open("icomoon-idb-test",1);b.onerror=function(){window.supportsIndexedDB=!1},window.supportsIndexedDB=a&&null===b.onupgradeneeded}catch(c){window.supportsIndexedDB=!1}}(),angular.module("scriptLoader",[]).factory("scriptLoader",["$q",function(a){var b=[],c=function(c,d){function e(){h.resolve(),d&&d()}var f,g,h=a.defer();return b.indexOf(c)<0?(b.push(c),f=document.getElementsByTagName("script")[0],g=document.createElement("script"),g.src=c,g.addEventListener?g.addEventListener("load",function(){e()},!1):g.onreadystatechange=function(){g.readyState in{loaded:1,complete:1}&&(g.onreadystatechange=null,e())},f.parentNode.insertBefore(g,f)):e(),h.promise};return{load:c}}]),function(){function a(){var a={};return a.FRAMERATE=30,a.MAX_VIRTUAL_PIXELS=3e4,a.init=function(b){var c=0;a.UniqueId=function(){return c++,"canvg"+c},a.Definitions={},a.Styles={},a.Animations=[],a.Images=[],a.ctx=b,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var b=0;b<a.Images.length;b++)if(!a.Images[b].loaded)return!1;return!0},a.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},a.ajax=function(a){var b;return b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b?(b.open("GET",a,!1),b.send(null),b.responseText):null},a.parseXml=function(a){if(window.DOMParser){var b=new DOMParser;return b.parseFromString(a,"text/xml")}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var c=new ActiveXObject("Microsoft.XMLDOM");return c.async="false",c.loadXML(a),c},a.Property=function(a,b){this.name=a,this.value=b},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},a.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},a.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},a.Property.prototype.addOpacity=function(b){var c=this.value;if(null!=b&&""!=b&&"string"==typeof this.value){var d=new RGBColor(this.value);d.ok&&(c="rgba("+d.r+", "+d.g+", "+d.b+", "+b+")")}return new a.Property(this.name,c)},a.Property.prototype.getDefinition=function(){var b=this.value.match(/#([^\)'"]+)/);return b&&(b=b[1]),b||(b=this.value),a.Definitions[b]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(b,c){var d=this.getDefinition();if(null!=d&&d.createGradient)return d.createGradient(a.ctx,b,c);if(null!=d&&d.createPattern){if(d.getHrefAttribute().hasValue()){var e=d.attribute("patternTransform");d=d.getHrefAttribute().getDefinition(),e.hasValue()&&(d.attribute("patternTransform",!0).value=e.value)}return d.createPattern(a.ctx,b)}return null},a.Property.prototype.getDPI=function(){return 96},a.Property.prototype.getEM=function(b){var c=12,d=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);return d.hasValue()&&(c=d.toPixels(b)),c},a.Property.prototype.getUnits=function(){var a=this.value+"";return a.replace(/[0-9\.\-]/g,"")},a.Property.prototype.toPixels=function(b,c){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(b);if(d.match(/ex$/))return this.numValue()*this.getEM(b)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(b)*(1/72);if(d.match(/pc$/))return 15*this.numValue();if(d.match(/cm$/))return this.numValue()*this.getDPI(b)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(b)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(b);if(d.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(b);var e=this.numValue();return c&&1>e?e*a.ViewPort.ComputeSize(b):e},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():a.match(/ms$/)?this.numValue():this.numValue()},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(b,c,d,e,f,g){var h=null!=g?this.Parse(g):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:f||h.fontFamily,fontSize:e||h.fontSize,fontStyle:b||h.fontStyle,fontWeight:d||h.fontWeight,fontVariant:c||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var b=this;this.Parse=function(c){for(var d={},e=a.trim(a.compressSpaces(c||"")).split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",h=0;h<e.length;h++)f.fontStyle||-1==b.Styles.indexOf(e[h])?f.fontVariant||-1==b.Variants.indexOf(e[h])?f.fontWeight||-1==b.Weights.indexOf(e[h])?f.fontSize?"inherit"!=e[h]&&(g+=e[h]):("inherit"!=e[h]&&(d.fontSize=e[h].split("/")[0]),f.fontStyle=f.fontVariant=f.fontWeight=f.fontSize=!0):("inherit"!=e[h]&&(d.fontWeight=e[h]),f.fontStyle=f.fontVariant=f.fontWeight=!0):("inherit"!=e[h]&&(d.fontVariant=e[h]),f.fontStyle=f.fontVariant=!0):("inherit"!=e[h]&&(d.fontStyle=e[h]),f.fontStyle=!0);return""!=g&&(d.fontFamily=g),d}},a.ToNumberArray=function(b){for(var c=a.trim(a.compressSpaces((b||"").replace(/,/g," "))).split(" "),d=0;d<c.length;d++)c[d]=parseFloat(c[d]);return c},a.Point=function(a,b){this.x=a,this.y=b},a.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},a.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},a.CreatePoint=function(b){var c=a.ToNumberArray(b);return new a.Point(c[0],c[1])},a.CreatePath=function(b){for(var c=a.ToNumberArray(b),d=[],e=0;e<c.length;e+=2)d.push(new a.Point(c[e],c[e+1]));return d},a.BoundingBox=function(a,b,c,d){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(a,b){null!=a&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),null!=b&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=b,this.y2=b),b<this.y1&&(this.y1=b),b>this.y2&&(this.y2=b))},this.addX=function(a){this.addPoint(a,null)},this.addY=function(a){this.addPoint(null,a)},this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1),this.addPoint(a.x2,a.y2)},this.addQuadraticCurve=function(a,b,c,d,e,f){var g=a+2/3*(c-a),h=b+2/3*(d-b),i=g+1/3*(e-a),j=h+1/3*(f-b);this.addBezierCurve(a,b,g,i,h,j,e,f)},this.addBezierCurve=function(a,b,c,d,e,f,g,h){var j=[a,b],k=[c,d],l=[e,f],m=[g,h];for(this.addPoint(j[0],j[1]),this.addPoint(m[0],m[1]),i=0;1>=i;i++){var n=function(a){return Math.pow(1-a,3)*j[i]+3*Math.pow(1-a,2)*a*k[i]+3*(1-a)*Math.pow(a,2)*l[i]+Math.pow(a,3)*m[i]},o=6*j[i]-12*k[i]+6*l[i],p=-3*j[i]+9*k[i]-9*l[i]+3*m[i],q=3*k[i]-3*j[i];if(0!=p){var r=Math.pow(o,2)-4*q*p;if(!(0>r)){var s=(-o+Math.sqrt(r))/(2*p);s>0&&1>s&&(0==i&&this.addX(n(s)),1==i&&this.addY(n(s)));var t=(-o-Math.sqrt(r))/(2*p);t>0&&1>t&&(0==i&&this.addX(n(t)),1==i&&this.addY(n(t)))}}else{if(0==o)continue;var u=-q/o;u>0&&1>u&&(0==i&&this.addX(n(u)),1==i&&this.addY(n(u)))}}},this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2},this.addPoint(a,b),this.addPoint(c,d)},a.Transform=function(b){var c=this;this.Type={},this.Type.translate=function(b){this.p=a.CreatePoint(b),this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)},this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(b){var c=a.ToNumberArray(b);this.angle=new a.Property("angle",c[0]),this.cx=c[1]||0,this.cy=c[2]||0,this.apply=function(a){a.translate(this.cx,this.cy),a.rotate(this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.unapply=function(a){a.translate(this.cx,this.cy),a.rotate(-1*this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]),a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(b){this.p=a.CreatePoint(b),this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(b){this.m=a.ToNumberArray(b),this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(b){this.base=c.Type.matrix,this.base(b),this.angle=new a.Property("angle",b)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)},this.unapply=function(a){for(var b=this.transforms.length-1;b>=0;b--)this.transforms[b].unapply(a)},this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};for(var d=a.trim(a.compressSpaces(b)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),e=0;e<d.length;e++){var f=a.trim(d[e].split("(")[0]),g=d[e].split("(")[1].replace(")",""),h=new this.Type[f](g);h.type=f,this.transforms.push(h)}},a.AspectRatio=function(b,c,d,e,f,g,h,i,j,k){c=a.compressSpaces(c),c=c.replace(/^defer\s/,"");var l=c.split(" ")[0]||"xMidYMid",m=c.split(" ")[1]||"meet",n=d/e,o=f/g,p=Math.min(n,o),q=Math.max(n,o);"meet"==m&&(e*=p,g*=p),"slice"==m&&(e*=q,g*=q),j=new a.Property("refX",j),k=new a.Property("refY",k),j.hasValue()&&k.hasValue()?b.translate(-p*j.toPixels("x"),-p*k.toPixels("y")):(l.match(/^xMid/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&b.translate(d/2-e/2,0),l.match(/YMid$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&b.translate(0,f/2-g/2),l.match(/^xMax/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&b.translate(d-e,0),l.match(/YMax$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&b.translate(0,f-g)),"none"==l?b.scale(n,o):"meet"==m?b.scale(p,p):"slice"==m&&b.scale(q,q),b.translate(null==h?0:-h,null==i?0:-i)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(b){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(b,c){var d=this.attributes[b];return null!=d?d:(1==c&&(d=new a.Property(b,""),this.attributes[b]=d),d||a.EmptyProperty)},this.getHrefAttribute=function(){for(var b in this.attributes)if(b.match(/:href$/))return this.attributes[b];return a.EmptyProperty},this.style=function(b,c){var d=this.styles[b];if(null!=d)return d;var e=this.attribute(b);if(null!=e&&e.hasValue())return this.styles[b]=e,e;var f=this.parent;if(null!=f){var g=f.style(b);if(null!=g&&g.hasValue())return g}return 1==c&&(d=new a.Property(b,""),this.styles[b]=d),d||a.EmptyProperty},this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value){if(a.save(),this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else if(this.style("filter").hasValue()){var c=this.style("filter").getDefinition();null!=c&&c.apply(a,this)}else this.setContext(a),this.renderChildren(a),this.clearContext(a);a.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)},this.addChild=function(b,c){var d=b;c&&(d=a.CreateElement(b)),d.parent=this,this.children.push(d)},null!=b&&1==b.nodeType){for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];if(1==d.nodeType&&this.addChild(d,!0),this.captureTextNodes&&3==d.nodeType){var e=d.nodeValue||d.text||"";""!=a.trim(a.compressSpaces(e))&&this.addChild(new a.Element.tspan(d),!1)}}for(var c=0;c<b.attributes.length;c++){var f=b.attributes[c];this.attributes[f.nodeName]=new a.Property(f.nodeName,f.nodeValue)}var g=a.Styles[b.nodeName];if(null!=g)for(var h in g)this.styles[h]=g[h];if(this.attribute("class").hasValue())for(var i=a.compressSpaces(this.attribute("class").value).split(" "),j=0;j<i.length;j++){if(g=a.Styles["."+i[j]],null!=g)for(var h in g)this.styles[h]=g[h];if(g=a.Styles[b.nodeName+"."+i[j]],null!=g)for(var h in g)this.styles[h]=g[h]}if(this.attribute("id").hasValue()){var g=a.Styles["#"+this.attribute("id").value];if(null!=g)for(var h in g)this.styles[h]=g[h]}if(this.attribute("style").hasValue())for(var g=this.attribute("style").value.split(";"),c=0;c<g.length;c++)if(""!=a.trim(g[c])){var k=g[c].split(":"),h=a.trim(k[0]),l=a.trim(k[1]);this.styles[h]=new a.Property(h,l)}this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this)}},a.Element.RenderedElementBase=function(b){this.base=a.Element.ElementBase,this.base(b),this.setContext=function(b){if(this.style("fill").isUrlDefinition()){var c=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=c&&(b.fillStyle=c)}else if(this.style("fill").hasValue()){var d=this.style("fill");"currentColor"==d.value&&(d.value=this.style("color").value),b.fillStyle="none"==d.value?"rgba(0,0,0,0)":d.value}if(this.style("fill-opacity").hasValue()){var d=new a.Property("fill",b.fillStyle);d=d.addOpacity(this.style("fill-opacity").value),b.fillStyle=d.value}if(this.style("stroke").isUrlDefinition()){var c=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=c&&(b.strokeStyle=c)}else if(this.style("stroke").hasValue()){var e=this.style("stroke");"currentColor"==e.value&&(e.value=this.style("color").value),b.strokeStyle="none"==e.value?"rgba(0,0,0,0)":e.value}if(this.style("stroke-opacity").hasValue()){var e=new a.Property("stroke",b.strokeStyle);e=e.addOpacity(this.style("stroke-opacity").value),b.strokeStyle=e.value}if(this.style("stroke-width").hasValue()){var f=this.style("stroke-width").toPixels();b.lineWidth=0==f?.001:f}if(this.style("stroke-linecap").hasValue()&&(b.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(b.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(b.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()){var g=a.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof b.setLineDash?b.setLineDash(g):"undefined"!=typeof b.webkitLineDash?b.webkitLineDash=g:"undefined"!=typeof b.mozDash&&(b.mozDash=g);var h=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof b.lineDashOffset?b.lineDashOffset=h:"undefined"!=typeof b.webkitLineDashOffset?b.webkitLineDashOffset=h:"undefined"!=typeof b.mozDashOffset&&(b.mozDashOffset=h)}if("undefined"!=typeof b.font&&(b.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var i=new a.Transform(this.attribute("transform").value);i.apply(b)}if(this.style("clip-path").hasValue()){var j=this.style("clip-path").getDefinition();null!=j&&j.apply(b)}this.style("opacity").hasValue()&&(b.globalAlpha=this.style("opacity").numValue())}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.path=function(b){return null!=b&&b.beginPath(),new a.BoundingBox},this.renderChildren=function(b){this.path(b),a.Mouse.checkPath(this,b),""!=b.fillStyle&&(this.attribute("fill-rule").hasValue()?b.fill(this.attribute("fill-rule").value):b.fill()),""!=b.strokeStyle&&b.stroke();var c=this.getMarkers();if(null!=c){if(this.style("marker-start").isUrlDefinition()){var d=this.style("marker-start").getDefinition();d.render(b,c[0][0],c[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var d=this.style("marker-mid").getDefinition(),e=1;e<c.length-1;e++)d.render(b,c[e][0],c[e][1]);if(this.style("marker-end").isUrlDefinition()){var d=this.style("marker-end").getDefinition();d.render(b,c[c.length-1][0],c[c.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.baseClearContext=this.clearContext,this.clearContext=function(b){this.baseClearContext(b),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(b){b.strokeStyle="rgba(0,0,0,0)",b.lineCap="butt",b.lineJoin="miter",b.miterLimit=4,this.baseSetContext(b),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),b.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var c=a.ViewPort.width(),d=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");var e=0,f=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(e=-this.attribute("refX").toPixels("x"),f=-this.attribute("refY").toPixels("y")),b.beginPath(),b.moveTo(e,f),b.lineTo(c,f),b.lineTo(c,d),b.lineTo(e,d),b.closePath(),b.clip()}if(a.ViewPort.SetCurrent(c,d),this.attribute("viewBox").hasValue()){var g=a.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];c=g[2],d=g[3],a.AspectRatio(b,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),c,a.ViewPort.height(),d,h,i,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(g[2],g[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(b){this.base=a.Element.PathElementBase,this.base(b),this.path=function(b){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),f=this.attribute("height").toPixels("y"),g=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=g),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(g=h),g=Math.min(g,e/2),h=Math.min(h,f/2),null!=b&&(b.beginPath(),b.moveTo(c+g,d),b.lineTo(c+e-g,d),b.quadraticCurveTo(c+e,d,c+e,d+h),b.lineTo(c+e,d+f-h),b.quadraticCurveTo(c+e,d+f,c+e-g,d+f),b.lineTo(c+g,d+f),b.quadraticCurveTo(c,d+f,c,d+f-h),b.lineTo(c,d+h),b.quadraticCurveTo(c,d,c+g,d),b.closePath()),new a.BoundingBox(c,d,c+e,d+f)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(b){this.base=a.Element.PathElementBase,this.base(b),this.path=function(b){var c=this.attribute("cx").toPixels("x"),d=this.attribute("cy").toPixels("y"),e=this.attribute("r").toPixels();return null!=b&&(b.beginPath(),b.arc(c,d,e,0,2*Math.PI,!0),b.closePath()),new a.BoundingBox(c-e,d-e,c+e,d+e)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(b){this.base=a.Element.PathElementBase,this.base(b),this.path=function(b){var c=4*((Math.sqrt(2)-1)/3),d=this.attribute("rx").toPixels("x"),e=this.attribute("ry").toPixels("y"),f=this.attribute("cx").toPixels("x"),g=this.attribute("cy").toPixels("y");return null!=b&&(b.beginPath(),b.moveTo(f,g-e),b.bezierCurveTo(f+c*d,g-e,f+d,g-c*e,f+d,g),b.bezierCurveTo(f+d,g+c*e,f+c*d,g+e,f,g+e),b.bezierCurveTo(f-c*d,g+e,f-d,g+c*e,f-d,g),b.bezierCurveTo(f-d,g-c*e,f-c*d,g-e,f,g-e),b.closePath()),new a.BoundingBox(f-d,g-e,f+d,g+e)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(b){this.base=a.Element.PathElementBase,this.base(b),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(b){var c=this.getPoints();return null!=b&&(b.beginPath(),b.moveTo(c[0].x,c[0].y),b.lineTo(c[1].x,c[1].y)),new a.BoundingBox(c[0].x,c[0].y,c[1].x,c[1].y)},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(b){this.base=a.Element.PathElementBase,this.base(b),this.points=a.CreatePath(this.attribute("points").value),this.path=function(b){var c=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=b&&(b.beginPath(),b.moveTo(this.points[0].x,this.points[0].y));for(var d=1;d<this.points.length;d++)c.addPoint(this.points[d].x,this.points[d].y),null!=b&&b.lineTo(this.points[d].x,this.points[d].y);return c},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(b){this.base=a.Element.polyline,this.base(b),this.basePath=this.path,this.path=function(a){var b=this.basePath(a);return null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath()),b}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(b){this.base=a.Element.PathElementBase,this.base(b);var c=this.attribute("d").value;c=c.replace(/,/gm," "),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),c=c.replace(/([0-9])([+\-])/gm,"$1 $2"),c=c.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),c=a.compressSpaces(c),c=a.trim(c),this.PathParser=new function(b){this.tokens=b.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var b=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(b)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var b=new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return b},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(c),this.path=function(b){var c=this.PathParser;c.reset();var d=new a.BoundingBox;for(null!=b&&b.beginPath();!c.isEnd();)switch(c.nextCommand(),c.command){case"M":case"m":var e=c.getAsCurrentPoint();for(c.addMarker(e),d.addPoint(e.x,e.y),null!=b&&b.moveTo(e.x,e.y),c.start=c.current;!c.isCommandOrEnd();){var e=c.getAsCurrentPoint();c.addMarker(e,c.start),d.addPoint(e.x,e.y),null!=b&&b.lineTo(e.x,e.y)}break;case"L":case"l":for(;!c.isCommandOrEnd();){var f=c.current,e=c.getAsCurrentPoint();c.addMarker(e,f),d.addPoint(e.x,e.y),null!=b&&b.lineTo(e.x,e.y)}break;case"H":case"h":for(;!c.isCommandOrEnd();){var g=new a.Point((c.isRelativeCommand()?c.current.x:0)+c.getScalar(),c.current.y);c.addMarker(g,c.current),c.current=g,d.addPoint(c.current.x,c.current.y),null!=b&&b.lineTo(c.current.x,c.current.y)}break;case"V":case"v":for(;!c.isCommandOrEnd();){var g=new a.Point(c.current.x,(c.isRelativeCommand()?c.current.y:0)+c.getScalar());
c.addMarker(g,c.current),c.current=g,d.addPoint(c.current.x,c.current.y),null!=b&&b.lineTo(c.current.x,c.current.y)}break;case"C":case"c":for(;!c.isCommandOrEnd();){var h=c.current,i=c.getPoint(),j=c.getAsControlPoint(),k=c.getAsCurrentPoint();c.addMarker(k,j,i),d.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=b&&b.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"S":case"s":for(;!c.isCommandOrEnd();){var h=c.current,i=c.getReflectedControlPoint(),j=c.getAsControlPoint(),k=c.getAsCurrentPoint();c.addMarker(k,j,i),d.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=b&&b.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"Q":case"q":for(;!c.isCommandOrEnd();){var h=c.current,j=c.getAsControlPoint(),k=c.getAsCurrentPoint();c.addMarker(k,j,j),d.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=b&&b.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"T":case"t":for(;!c.isCommandOrEnd();){var h=c.current,j=c.getReflectedControlPoint();c.control=j;var k=c.getAsCurrentPoint();c.addMarker(k,j,j),d.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=b&&b.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"A":case"a":for(;!c.isCommandOrEnd();){var h=c.current,l=c.getScalar(),m=c.getScalar(),n=c.getScalar()*(Math.PI/180),o=c.getScalar(),p=c.getScalar(),k=c.getAsCurrentPoint(),q=new a.Point(Math.cos(n)*(h.x-k.x)/2+Math.sin(n)*(h.y-k.y)/2,-Math.sin(n)*(h.x-k.x)/2+Math.cos(n)*(h.y-k.y)/2),r=Math.pow(q.x,2)/Math.pow(l,2)+Math.pow(q.y,2)/Math.pow(m,2);r>1&&(l*=Math.sqrt(r),m*=Math.sqrt(r));var s=(o==p?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(q.y,2)-Math.pow(m,2)*Math.pow(q.x,2))/(Math.pow(l,2)*Math.pow(q.y,2)+Math.pow(m,2)*Math.pow(q.x,2)));isNaN(s)&&(s=0);var t=new a.Point(s*l*q.y/m,s*-m*q.x/l),u=new a.Point((h.x+k.x)/2+Math.cos(n)*t.x-Math.sin(n)*t.y,(h.y+k.y)/2+Math.sin(n)*t.x+Math.cos(n)*t.y),v=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},w=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(v(a)*v(b))},x=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(w(a,b))},y=x([1,0],[(q.x-t.x)/l,(q.y-t.y)/m]),z=[(q.x-t.x)/l,(q.y-t.y)/m],A=[(-q.x-t.x)/l,(-q.y-t.y)/m],B=x(z,A);w(z,A)<=-1&&(B=Math.PI),w(z,A)>=1&&(B=0);var C=1-p?1:-1,D=y+C*(B/2),E=new a.Point(u.x+l*Math.cos(D),u.y+m*Math.sin(D));if(c.addMarkerAngle(E,D-C*Math.PI/2),c.addMarkerAngle(k,D-C*Math.PI),d.addPoint(k.x,k.y),null!=b){var w=l>m?l:m,F=l>m?1:l/m,G=l>m?m/l:1;b.translate(u.x,u.y),b.rotate(n),b.scale(F,G),b.arc(0,0,w,y,y+B,1-p),b.scale(1/F,1/G),b.rotate(-n),b.translate(-u.x,-u.y)}}break;case"Z":case"z":null!=b&&b.closePath(),c.current=c.start}return d},this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],d=0;d<a.length;d++)c.push([a[d],b[d]]);return c}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(b){this.base=a.Element.ElementBase,this.base(b),this.createPattern=function(b){var c=this.attribute("width").toPixels("x",!0),d=this.attribute("height").toPixels("y",!0),e=new a.Element.svg;e.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),e.attributes.width=new a.Property("width",c+"px"),e.attributes.height=new a.Property("height",d+"px"),e.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),e.children=this.children;var f=document.createElement("canvas");f.width=c,f.height=d;var g=f.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&g.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var h=-1;1>=h;h++)for(var i=-1;1>=i;i++)g.save(),g.translate(h*f.width,i*f.height),e.render(g),g.restore();var j=b.createPattern(f,"repeat");return j}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(b){this.base=a.Element.ElementBase,this.base(b),this.baseRender=this.render,this.render=function(b,c,d){b.translate(c.x,c.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&b.rotate(d),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&b.scale(b.lineWidth,b.lineWidth),b.save();var e=new a.Element.svg;e.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),e.attributes.refX=new a.Property("refX",this.attribute("refX").value),e.attributes.refY=new a.Property("refY",this.attribute("refY").value),e.attributes.width=new a.Property("width",this.attribute("markerWidth").value),e.attributes.height=new a.Property("height",this.attribute("markerHeight").value),e.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),e.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),e.children=this.children,e.render(b),b.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&b.scale(1/b.lineWidth,1/b.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&b.rotate(-d),b.translate(-c.x,-c.y)}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(b){this.base=a.Element.ElementBase,this.base(b),this.render=function(){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(b){this.base=a.Element.ElementBase,this.base(b),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var c=0;c<this.children.length;c++){var d=this.children[c];"stop"==d.type&&this.stops.push(d)}this.getGradient=function(){},this.createGradient=function(b,c,d){var e=this;this.getHrefAttribute().hasValue()&&(e=this.getHrefAttribute().getDefinition());var f=function(b){if(d.hasValue()){var c=new a.Property("color",b);return c.addOpacity(d.value).value}return b},g=this.getGradient(b,c);if(null==g)return f(e.stops[e.stops.length-1].color);for(var h=0;h<e.stops.length;h++)g.addColorStop(e.stops[h].offset,f(e.stops[h].color));if(this.attribute("gradientTransform").hasValue()){var i=a.ViewPort.viewPorts[0],j=new a.Element.rect;j.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),j.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),j.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),j.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var k=new a.Element.g;k.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),k.children=[j];var l=new a.Element.svg;l.attributes.x=new a.Property("x",0),l.attributes.y=new a.Property("y",0),l.attributes.width=new a.Property("width",i.width),l.attributes.height=new a.Property("height",i.height),l.children=[k];var m=document.createElement("canvas");m.width=i.width,m.height=i.height;var n=m.getContext("2d");return n.fillStyle=g,l.render(n),n.createPattern(m,"no-repeat")}return g}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(b){this.base=a.Element.GradientBase,this.base(b),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return d==f&&e==g?null:a.createLinearGradient(d,e,f,g)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(b){this.base=a.Element.GradientBase,this.base(b),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var d="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=d,g=e;this.attribute("fx").hasValue()&&(f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(f,g,0,d,e,h)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(b){this.base=a.Element.ElementBase,this.base(b),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var c=this.style("stop-color");this.style("stop-opacity").hasValue()&&(c=c.addOpacity(this.style("stop-opacity").value)),this.color=c.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(b){this.base=a.Element.ElementBase,this.base(b),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var a=this.attribute("attributeType").value,b=this.attribute("attributeName").value;return"CSS"==a?this.parent.style(b,!0):this.parent.attribute(b,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(a){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed?!1:(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+a;var b=!1;if(this.begin<this.duration){var c=this.calcValue();if(this.attribute("type").hasValue()){var d=this.attribute("type").value;c=d+"("+c+")"}this.getProperty().value=c,b=!0}return b},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var b={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var c=b.progress*(this.values.value.length-1),d=Math.floor(c),e=Math.ceil(c);b.from=new a.Property("from",parseFloat(this.values.value[d])),b.to=new a.Property("to",parseFloat(this.values.value[e])),b.progress=(c-d)/(e-d)}else b.from=this.from,b.to=this.to;return b}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(b){this.base=a.Element.AnimateBase,this.base(b),this.calcValue=function(){var a=this.progress(),b=a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress;return b+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(b){this.base=a.Element.AnimateBase,this.base(b),this.calcValue=function(){var a=this.progress(),b=new RGBColor(a.from.value),c=new RGBColor(a.to.value);if(b.ok&&c.ok){var d=b.r+(c.r-b.r)*a.progress,e=b.g+(c.g-b.g)*a.progress,f=b.b+(c.b-b.b)*a.progress;return"rgb("+parseInt(d,10)+","+parseInt(e,10)+","+parseInt(f,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(b){this.base=a.Element.AnimateBase,this.base(b),this.calcValue=function(){for(var b=this.progress(),c=a.ToNumberArray(b.from.value),d=a.ToNumberArray(b.to.value),e="",f=0;f<c.length;f++)e+=c[f]+(d[f]-c[f])*b.progress+" ";return e}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(b){this.base=a.Element.ElementBase,this.base(b),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var c=0;c<this.children.length;c++){var d=this.children[c];"font-face"==d.type?(this.fontFace=d,d.style("font-family").hasValue()&&(a.Definitions[d.style("font-family").value]=this)):"missing-glyph"==d.type?this.missingGlyph=d:"glyph"==d.type&&(""!=d.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[d.unicode]&&(this.glyphs[d.unicode]=[]),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(b){this.base=a.Element.ElementBase,this.base(b),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(b){this.base=a.Element.path,this.base(b),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(b){this.base=a.Element.path,this.base(b),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(b){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(b),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.style("dominant-baseline").hasValue()&&(a.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(a.textBaseline=this.style("alignment-baseline").value)},this.getBoundingBox=function(){return new a.BoundingBox(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"),0,0)},this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,b)},this.getAnchorDelta=function(a,b,c){var d=this.style("text-anchor").valueOrDefault("start");if("start"!=d){for(var e=0,f=c;f<b.children.length;f++){var g=b.children[f];if(f>c&&g.attribute("x").hasValue())break;e+=g.measureTextRecursive(a)}return-1*("end"==d?e:e/2)}return 0},this.renderChild=function(a,b,c){var d=b.children[c];d.attribute("x").hasValue()?d.x=d.attribute("x").toPixels("x")+this.getAnchorDelta(a,b,c):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),d.attribute("dx").hasValue()&&(this.x+=d.attribute("dx").toPixels("x")),d.x=this.x),this.x=d.x+d.measureText(a),d.attribute("y").hasValue()?d.y=d.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),d.attribute("dy").hasValue()&&(this.y+=d.attribute("dy").toPixels("y")),d.y=this.y),this.y=d.y,d.render(a);for(var c=0;c<d.children.length;c++)this.renderChild(a,d,c)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.getGlyph=function(a,b,c){var d=b[c],e=null;if(a.isArabic){var f="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(f="terminal"),c>0&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(f="medial"),c>0&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(f="initial"),"undefined"!=typeof a.glyphs[d]&&(e=a.glyphs[d][f],null==e&&"glyph"==a.glyphs[d].type&&(e=a.glyphs[d]))}else e=a.glyphs[d];return null==e&&(e=a.missingGlyph),e},this.renderChildren=function(b){var c=this.parent.style("font-family").getDefinition();if(null==c)""!=b.fillStyle&&b.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=b.strokeStyle&&b.strokeText(a.compressSpaces(this.getText()),this.x,this.y);else{var d=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),e=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=a.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(c,f,h),j=d/c.fontFace.unitsPerEm;b.translate(this.x,this.y),b.scale(j,-j);var k=b.lineWidth;b.lineWidth=b.lineWidth*c.fontFace.unitsPerEm/d,"italic"==e&&b.transform(1,0,.4,1,0,0),i.render(b),"italic"==e&&b.transform(1,0,-.4,1,0,0),b.lineWidth=k,b.scale(1/j,-1/j),b.translate(-this.x,-this.y),this.x+=d*(i.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(this.x+=g[h])}}},this.getText=function(){},this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b},this.measureText=function(b){var c=this.parent.style("font-family").getDefinition();if(null!=c){var d=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),e=0,f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=a.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(c,f,h);e+=(i.horizAdvX||c.horizAdvX)*d/c.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(e+=g[h])}return e}var j=a.compressSpaces(this.getText());if(!b.measureText)return 10*j.length;b.save(),this.setContext(b);var k=b.measureText(j).width;return b.restore(),k}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(b){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(b),this.text=b.nodeValue||b.text||"",this.getText=function(){return this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(b){this.base=a.Element.TextElementBase,this.base(b),this.getText=function(){var a=this.getHrefAttribute().getDefinition();return null!=a?a.children[0].getText():void 0}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(b){this.base=a.Element.TextElementBase,this.base(b),this.hasText=!0;for(var c=0;c<b.childNodes.length;c++)3!=b.childNodes[c].nodeType&&(this.hasText=!1);this.text=this.hasText?b.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(b){if(this.hasText){this.baseRenderChildren(b);var c=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-c.toPixels("y"),this.x+this.measureText(b),this.y))}else{var d=new a.Element.g;d.children=this.children,d.parent=this,d.render(b)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(b){this.base=a.Element.RenderedElementBase,this.base(b);var c=this.getHrefAttribute().value,d=c.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,d)this.img=a.ajax(c),this.loaded=!0;else{this.img=document.createElement("img");var e=this;this.img.onload=function(){e.loaded=!0},this.img.onerror=function(){"undefined"!=typeof console&&(console.log('ERROR: image "'+c+'" not found'),e.loaded=!0)},this.img.src=c}this.renderChildren=function(b){var c=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");0!=f&&0!=g&&(b.save(),d?b.drawSvg(this.img,c,e,f,g):(b.translate(c,e),a.AspectRatio(b,this.attribute("preserveAspectRatio").value,f,this.img.width,g,this.img.height,0,0),b.drawImage(this.img,0,0)),b.restore())},this.getBoundingBox=function(){var b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new a.BoundingBox(b,c,b+d,c+e)}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.getBoundingBox=function(){for(var b=new a.BoundingBox,c=0;c<this.children.length;c++)b.addBoundingBox(this.children[c].getBoundingBox());return b}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.baseSetContext=this.setContext,this.setContext=function(b){if(this.baseSetContext(b),this.attribute("viewBox").hasValue()){var c=a.ToNumberArray(this.attribute("viewBox").value),d=c[0],e=c[1];width=c[2],height=c[3],a.AspectRatio(b,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,d,e),a.ViewPort.SetCurrent(c[2],c[3])}}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(b){this.base=a.Element.ElementBase,this.base(b);for(var c="",d=0;d<b.childNodes.length;d++)c+=b.childNodes[d].nodeValue;c=c.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),c=a.compressSpaces(c);for(var e=c.split("}"),d=0;d<e.length;d++)if(""!=a.trim(e[d]))for(var f=e[d].split("{"),g=f[0].split(","),h=f[1].split(";"),i=0;i<g.length;i++){var j=a.trim(g[i]);if(""!=j){for(var k={},l=0;l<h.length;l++){var m=h[l].indexOf(":"),n=h[l].substr(0,m),o=h[l].substr(m+1,h[l].length-m);null!=n&&null!=o&&(k[a.trim(n)]=new a.Property(a.trim(n),a.trim(o)))}if(a.Styles[j]=k,"@font-face"==j)for(var p=k["font-family"].value.replace(/"/g,""),q=k.src.value.split(","),r=0;r<q.length;r++)if(q[r].indexOf('format("svg")')>0)for(var s=q[r].indexOf("url"),t=q[r].indexOf(")",s),u=q[r].substr(s+5,t-s-6),v=a.parseXml(a.ajax(u)),w=v.getElementsByTagName("font"),x=0;x<w.length;x++){var y=a.CreateElement(w[x]);a.Definitions[p]=y}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(b){this.base=a.Element.RenderedElementBase,this.base(b),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var a=this.getHrefAttribute().getDefinition();return this.attribute("width").hasValue()&&(a.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(a.attribute("height",!0).value=this.attribute("height").value),a},this.path=function(a){var b=this.getDefinition();null!=b&&b.path(a)},this.getBoundingBox=function(){var a=this.getDefinition();return null!=a?a.getBoundingBox():void 0},this.renderChildren=function(a){var b=this.getDefinition();if(null!=b){var c=b.parent;b.parent=null,b.render(a),b.parent=c}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(b,c){var d=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");if(0==f&&0==g){for(var h=new a.BoundingBox,i=0;i<this.children.length;i++)h.addBoundingBox(this.children[i].getBoundingBox());var d=Math.floor(h.x1),e=Math.floor(h.y1),f=Math.floor(h.width()),g=Math.floor(h.height())}var j=c.attribute("mask").value;c.attribute("mask").value="";var k=document.createElement("canvas");k.width=d+f,k.height=e+g;var l=k.getContext("2d");this.renderChildren(l);var m=document.createElement("canvas");m.width=d+f,m.height=e+g;var n=m.getContext("2d");c.render(n),n.globalCompositeOperation="destination-in",n.fillStyle=l.createPattern(k,"no-repeat"),n.fillRect(0,0,d+f,e+g),b.fillStyle=n.createPattern(m,"no-repeat"),b.fillRect(0,0,d+f,e+g),c.attribute("mask").value=j},this.render=function(){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(b){for(var c=0;c<this.children.length;c++){var d=this.children[c];if("undefined"!=typeof d.path){var e=null;d.attribute("transform").hasValue()&&(e=new a.Transform(d.attribute("transform").value),e.apply(b)),d.path(b),b.clip(),e&&e.unapply(b)}}},this.render=function(){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(a,b){var c=b.getBoundingBox(),d=Math.floor(c.x1),e=Math.floor(c.y1),f=Math.floor(c.width()),g=Math.floor(c.height()),h=b.style("filter").value;b.style("filter").value="";for(var i=0,j=0,k=0;k<this.children.length;k++){var l=this.children[k].extraFilterDistance||0;i=Math.max(i,l),j=Math.max(j,l)}var m=document.createElement("canvas");m.width=f+2*i,m.height=g+2*j;var n=m.getContext("2d");n.translate(-d+i,-e+j),b.render(n);for(var k=0;k<this.children.length;k++)this.children[k].apply(n,0,0,f+2*i,g+2*j);a.drawImage(m,0,0,f+2*i,g+2*j,d-i,e-j,f+2*i,g+2*j),b.style("filter",!0).value=h},this.render=function(){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(b){this.base=a.Element.ElementBase,this.base(b),this.apply=function(){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(b){function c(a,b,c,d,e,f){return a[4*c*d+4*b+f]}function d(a,b,c,d,e,f,g){a[4*c*d+4*b+f]=g}this.base=a.Element.ElementBase,this.base(b),this.apply=function(a,b,e,f,g){for(var h=a.getImageData(0,0,f,g),e=0;g>e;e++)for(var b=0;f>b;b++){var i=c(h.data,b,e,f,g,0),j=c(h.data,b,e,f,g,1),k=c(h.data,b,e,f,g,2),l=(i+j+k)/3;d(h.data,b,e,f,g,0,l),d(h.data,b,e,f,g,1,l),d(h.data,b,e,f,g,2,l)}a.clearRect(0,0,f,g),a.putImageData(h,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(b){this.base=a.Element.ElementBase,this.base(b),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(b,c,d,e,f){return"undefined"==typeof stackBlurCanvasRGBA?("undefined"!=typeof console&&console.log("ERROR: StackBlur.js must be included for blur to work"),void 0):(b.canvas.id=a.UniqueId(),b.canvas.style.display="none",document.body.appendChild(b.canvas),stackBlurCanvasRGBA(b.canvas.id,c,d,e,f,this.blurRadius),document.body.removeChild(b.canvas),void 0)}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(a){"undefined"!=typeof console&&console.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(b){var c=b.nodeName.replace(/^[^:]+:/,"");c=c.replace(/\-/g,"");var d=null;return d="undefined"!=typeof a.Element[c]?new a.Element[c](b):new a.Element.MISSING(b),d.type=b.nodeName,d},a.load=function(b,c){a.loadXml(b,a.ajax(c))},a.loadXml=function(b,c){a.loadXmlDoc(b,a.parseXml(c))},a.loadXmlDoc=function(b,c){a.init(b);var d=function(a){for(var c=b.canvas;c;)a.x-=c.offsetLeft,a.y-=c.offsetTop,c=c.offsetParent;return window.scrollX&&(a.x+=window.scrollX),window.scrollY&&(a.y+=window.scrollY),a};1!=a.opts.ignoreMouse&&(b.canvas.onclick=function(b){var c=d(new a.Point(null!=b?b.clientX:event.clientX,null!=b?b.clientY:event.clientY));a.Mouse.onclick(c.x,c.y)},b.canvas.onmousemove=function(b){var c=d(new a.Point(null!=b?b.clientX:event.clientX,null!=b?b.clientY:event.clientY));a.Mouse.onmousemove(c.x,c.y)});var e=a.CreateElement(c.documentElement);e.root=!0;var f=!0,g=function(){a.ViewPort.Clear(),b.canvas.parentNode&&a.ViewPort.SetCurrent(b.canvas.parentNode.clientWidth,b.canvas.parentNode.clientHeight),1!=a.opts.ignoreDimensions&&(e.style("width").hasValue()&&(b.canvas.width=e.style("width").toPixels("x"),b.canvas.style.width=b.canvas.width+"px"),e.style("height").hasValue()&&(b.canvas.height=e.style("height").toPixels("y"),b.canvas.style.height=b.canvas.height+"px"));var d=b.canvas.clientWidth||b.canvas.width,g=b.canvas.clientHeight||b.canvas.height;if(1==a.opts.ignoreDimensions&&e.style("width").hasValue()&&e.style("height").hasValue()&&(d=e.style("width").toPixels("x"),g=e.style("height").toPixels("y")),a.ViewPort.SetCurrent(d,g),null!=a.opts.offsetX&&(e.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(e.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth&&null!=a.opts.scaleHeight){var h=1,i=1,j=a.ToNumberArray(e.attribute("viewBox").value);e.attribute("width").hasValue()?h=e.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(j[2])||(h=j[2]/a.opts.scaleWidth),e.attribute("height").hasValue()?i=e.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(j[3])||(i=j[3]/a.opts.scaleHeight),e.attribute("width",!0).value=a.opts.scaleWidth,e.attribute("height",!0).value=a.opts.scaleHeight,e.attribute("viewBox",!0).value="0 0 "+d*h+" "+g*i,e.attribute("preserveAspectRatio",!0).value="none"}1!=a.opts.ignoreClear&&b.clearRect(0,0,d,g),e.render(b),f&&(f=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(c))},h=!0;a.ImagesLoaded()&&(h=!1,g()),a.intervalID=setInterval(function(){var b=!1;if(h&&a.ImagesLoaded()&&(h=!1,b=!0),1!=a.opts.ignoreMouse&&(b|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var c=0;c<a.Animations.length;c++)b|=a.Animations[c].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(b=!0),b&&(g(),a.Mouse.runEvents())},1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){a.onclick&&a.onclick()}})},this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){a.onmousemove&&a.onmousemove()}})},this.eventElements=[],this.checkPath=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInPath&&b.isPointInPath(d.x,d.y)&&(this.eventElements[c]=a)}},this.checkBoundingBox=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInBox(d.x,d.y)&&(this.eventElements[c]=a)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var b=0;b<this.events.length;b++)for(var c=this.events[b],d=this.eventElements[b];d;)c.run(d),d=d.parent;this.events=[],this.eventElements=[]}},a}this.canvg=function(b,c,d){if(null!=b||null!=c||null!=d){d=d||{},"string"==typeof b&&(b=document.getElementById(b)),null!=b.svg&&b.svg.stop();var e=a();(1!=b.childNodes.length||"OBJECT"!=b.childNodes[0].nodeName)&&(b.svg=e),e.opts=d;var f=b.getContext("2d");"undefined"!=typeof c.documentElement?e.loadXmlDoc(f,c):"<"==c.substr(0,1)?e.loadXml(f,c):e.load(f,c)}else for(var g=document.getElementsByTagName("svg"),h=0;h<g.length;h++){var i=g[h],j=document.createElement("canvas");j.width=i.clientWidth,j.height=i.clientHeight,i.parentNode.insertBefore(j,i),i.parentNode.removeChild(i);var k=document.createElement("div");k.appendChild(i),canvg(j,k.innerHTML)}}}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(a,b,c,d,e){canvg(this.canvas,a,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:b,offsetY:c,scaleWidth:d,scaleHeight:e})}),angular.module("storage",[]).factory("storage",[function(){var a={},b=!1,c=function(){},d={},e=!1,f=[],g="storage",h="storeKey",i=!1,j=function(){e||(e=!0,d=new IDBStore({dbVersion:1,storeName:g||"storage",keyPath:h,onStoreReady:function(){i=!0;var a;for(a=0;a<f.length;a+=1)f[a]()}}))};return a.save=function(a,e,g,h){if(window.supportsIndexedDB){j();var k=function(){d.put({storeKey:a,obj:e},g||c,h||c)};i?k():f.push(k)}else setTimeout(function(){try{localStorage.setItem(a,JSON.stringify(e))}catch(c){b=b||{},b[a]=JSON.stringify(e)
}g&&g()},0)},a.load=function(a,e,g){if(window.supportsIndexedDB){if(j(),!a&&isNaN(a)||"function"!=typeof e)return;var h=function(){d.get(a,function(a){e(a&&a.obj)},g||c)};i?h():f.push(h)}else{if(!a&&isNaN(a)||"function"!=typeof e)return;setTimeout(function(){b?e(JSON.parse(b[a])):e(JSON.parse(localStorage.getItem(a)))},0)}},a.remove=function(a,e){if(window.supportsIndexedDB){j();var g=function(){d.remove(a,e||c,onerror||c)};i?g():f.push(g)}else b?delete localStorage[a]:delete b[a],e&&e()},a.clear=function(a,e){window.supportsIndexedDB?(j(),d.clear(a,e||c)):setTimeout(function(){b?b={}:localStorage.clear(),a&&a()},0)},a}]),function(){"use strict";var a={};angular.module("tmpl",[]).factory("template",["$http","$q",function(b,c){var d=function(a,b,c){var d,e,f,g,h,i,j,k,l=[],m=b.length,n=c.length,o={};for(i=new Array(m+1).join(" "),d=new Array(n+1).join(" ");a.length;){e=a.indexOf(b),k=e+m,j=a.slice(k),f=0;do f=j.indexOf(c),g=j.indexOf(b),-1!==g&&(j=j.slice(0,g)+i+j.slice(g+m)),j=j.slice(0,f)+d+j.slice(f+n);while(-1!==g&&f>g);if(f+=k,!(f>e&&-1!==e)){l.push(a);break}k=a.slice(0,e),k&&l.push(k),k=a.slice(e+m,f),k&&(l.push(""),o[k]||(o[k]=[]),o[k].push(l.length-1)),a=a.slice(f+n)}for(h in o)k=h.indexOf(b),o.hasOwnProperty(h)&&-1!==k&&(e=h.search(/\s/),-1!==e&&(k=Math.min(k,e)),k=h.slice(0,k),o[k]={str:h.slice(k.length).replace(/^\n/,""),opening:b,closing:c,idxArray:o[h]},delete o[h]);return{stringArray:l,map:o}};return function e(f){var g,h="}}",i="{{",j="tmpl/",k={};return k.config=function(a){return"string"==typeof a.opening&&a.opening.length>0&&(i=a.opening),"string"==typeof a.closing&&a.closing.length>0&&(h=a.closing),"string"==typeof a.tmplDir&&(j=a.tmplDir),this},k.set=function(a){return g=d(a,i,h),this},k.get=function(d){var e=c.defer(),f=d.replace(/\.tmpl$/,"");return a.hasOwnProperty(f)?e.resolve(a[f]):b.get(j+f+".tmpl",{transformResponse:!1}).then(function(b){a[f]=k.set(b.data),e.resolve(a[f])}),e.promise},k.fillup=function(a){var b,c,d,f,h,i,j,k=g.map,l=g.stringArray;for(f in a)if(k.hasOwnProperty(f)){if(k[f].fillup||k[f].str){if(k[f].str&&(b=k[f].idxArray,k[f]=e(k[f].str,k[f].opening,k[f].closing),k[f].idxArray=b),i=a[f].length,j="",a[f]){for(d=0;i>d;d+=1)j+=k[f].fillup(a[f][d]);i||(j=k[f].fillup(a[f]))}b=k[f].idxArray}else j=a[f],b=k[f];for(c=0,h=b.length;h>c;c+=1)l[b[c]]=j}return l.join("")},f&&k.set(f),k}}])}(),function(){"use strict";angular.module("color",[]).factory("color",[function(){function a(a){var b=1-a.k;return{r:Math.round(255*(1-a.c)*b),g:Math.round(255*(1-a.m)*b),b:Math.round(255*(1-a.y)*b)}}function b(a){var b,c,d,e,f,g,h,i=a.h,j=a.s/100,k=a.l/100;return b=(1-Math.abs(2*k-1))*j,i%=360,f=i/60,h=b*(1-Math.abs(f%2-1)),f>=0&&1>f?(c=b,d=h,e=0):f>=1&&2>f?(c=h,d=b,e=0):f>=2&&3>f?(c=0,d=b,e=h):f>=3&&4>f?(c=0,d=h,e=b):f>=4&&5>f?(c=h,d=0,e=b):f>=5&&6>f&&(c=b,d=0,e=h),g=k-b/2,{r:Math.round(255*(c+g)),g:Math.round(255*(d+g)),b:Math.round(255*(e+g))}}function c(a){var b,c=a.r/255,d=a.g/255,e=a.b/255,f={},g=Math.max(c,d,e),h=Math.min(c,d,e),i=g-h;return 0===i?b=0:g===c?b=(d-e)/i%6:g===d?b=(e-c)/i+2:g===e&&(b=(c-d)/i+4),f.h=60*b,f.h<0&&(f.h+=360),f.l=(g+h)/2,f.s=0===f.l||1===f.l?0:i/(1-Math.abs(2*f.l-1)),f.h=Math.round(f.h),f.s=Math.round(100*f.s),f.l=Math.round(100*f.l),f}function d(a){var b,c=[],d=a.r/255,e=a.g/255,f=a.b/255,g=[d,e,f];for(b=0;3>b;b+=1)c[b]=g[b]<=.04045?g[b]/12.92:Math.pow((g[b]+.055)/1.055,2.4);return{x:.4124*c[0]+.3576*c[1]+.1805*c[2],y:.2126*c[0]+.7152*c[1]+.0722*c[2],z:.0193*c[0]+.1192*c[1]+.9505*c[2]}}function e(a){function b(a){var b=6/29;return a>b*b*b?Math.pow(a,1/3):7.787037037037035*a+4/29}var c,e,f;return a=d(a),c=b(a.x/h.x),e=b(a.y/h.y),f=b(a.z/h.z),{l:116*e-16,a:500*(c-e),b:200*(e-f)}}function f(a){var b=a.r+", "+a.g+", "+a.b;return b=1!==a.a?"rgba("+b+", "+a.a:"rgb("+b,b+=")"}function g(c){var d,e,f,g,h,i;if(Array.isArray(c)&&c.length>=3)return h=Number(c[0])||0,g=Number(c[1])||0,f=Number(c[2])||0,d=Number(c[3])||1,{r:h,g:g,b:f,a:d};if(c&&"undefined"!=typeof c.r&&"undefined"!=typeof c.g&&"undefined"!=typeof c.b)return{r:Number(c.r),g:Number(c.g),b:Number(c.b),a:Number(c.a)||1};if(c&&"undefined"!=typeof c.c&&"undefined"!=typeof c.m&&"undefined"!=typeof c.y&&"undefined"!=typeof c.k)return i=a(c),i.a=c.a||1,i;if(c&&"undefined"!=typeof c.h&&"undefined"!=typeof c.s&&"undefined"!=typeof c.l)return c.h=Number(c.h),c.s=Number(c.s),c.l=Number(c.l),i=b(c),i.a=Number(c.a)||1,i;if("number"==typeof c){for(c=Math.round(c).toString(16);c.length<6;)c="0"+c;c="#"+c}if("string"==typeof c){if(c=c.replace(/\s+/g,""),e=c.match(/#([\da-f])([\da-f])([\da-f])$/i))return h=parseInt(e[1]+e[1],16),g=parseInt(e[2]+e[2],16),f=parseInt(e[3]+e[3],16),{r:h,g:g,b:f,a:1};if(e=c.match(/#([\da-f]{2})([\da-f]{2})([\da-f]{2})/i))return h=parseInt(e[1],16),g=parseInt(e[2],16),f=parseInt(e[3],16),{r:h,g:g,b:f,a:1};if(e=c.match(/rgb\((\d+),(\d+),(\d+)\)/i))return h=parseInt(e[1],10),g=parseInt(e[2],10),f=parseInt(e[3],10),{r:h,g:g,b:f,a:1};if(e=c.match(/rgba\((\d+),(\d+),(\d+),(.*)\)/i))return h=parseInt(e[1],10),g=parseInt(e[2],10),f=parseInt(e[3],10),d=Number(e[4])||1,{r:h,g:g,b:f,a:d}}return{r:0,g:0,b:0,a:1}}var h={x:.9505,y:1,z:1.089};return function(a){var b=g(a);return b.toString=function(){return f(b)},b.toArray=function(){return[b.r,b.g,b.b,b.a]},b.toHSL=function(){return c(b)},b.toNumber=function(){return 65536*b.r+256*b.g+b.b},b.distance=function(a){var c=e(b),d=e(a);return Math.sqrt(Math.pow(c.l-d.l,2)+Math.pow(c.a-d.a,2)+Math.pow(c.b-d.b,2))},b.average=function(a){return b.r=Math.round((b.r+a.r)/2),b.g=Math.round((b.g+a.g)/2),b.b=Math.round((b.b+a.b)/2),b},b}}])}(),function(){"use strict";angular.module("swatch",["color","svg","tmpl"]).factory("swatch",["color","svgPath","template",function(a,b,c){function d(c){var d,e=b(c),f=[],g=[];return d=e.getAttrs(),d.forEach(function(b){var c,d;b.fill&&(c=a(b.fill),d=c.toNumber(),-1===g.indexOf(d)&&(g.push(d),f.push(c)))}),f}function e(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=new DataView(a),p=[];if(1095976262!==o.getUint32(0)||65536!==o.getUint32(4))return p;for(k=o.getUint32(8),l=12,g=0;k>g&&l+6<a.byteLength;g+=1)try{if(b=o.getUint16(l),c=o.getUint32(l+2),m=o.getUint16(l+6),49153===b)f=[],p.push(f);else if(1===b){for(j=l+8+2*m,d=String.fromCharCode.apply(null,new Uint8Array(a,j,4)),j+=4,e=[o.getFloat32(j)],j+=4,i=/^(RGB|LAB)/.test(d)?2:3,h=0;i>h;h+=1)e.push(o.getFloat32(j)),j+=4;d=d.slice(0,i+1),"CMYK"===d?f.push({c:e[0],m:e[1],y:e[2],k:e[3]}):"RGB"===d?f.push({r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}):"LAB"===d?f.push({l:e[0],a:e[1],b:e[2]}):"Gray"===d&&(n=Math.round(255*e[0]),f.push({r:n,g:n,b:n}))}l+=c+6}catch(q){break}return p}function f(b){function c(a){for(var b=a.toString(16);b.length<6;)b="0"+b;return b}var d,e,f,g,h=[],j=[];for(b&&b.colors&&(h=b.colors),h.length<6?(f=h.length,g=1):(f=Math.ceil(Math.sqrt(h.length)),g=Math.ceil(h.length/f)),d=0;g>d;d+=1)for(e=0;f>e&&d*f+e<h.length;e+=1)j.push({y:64*d,x:64*e,fill:"#"+c(a(h[d*f+e]).toNumber())});return i.fillup({width:64*f,height:64*g,rects:j})}function g(a,b,c){var d,e,f,g,h=a.length;for(1===b?f="setUint8":(f="setUint16",b=2),d=new ArrayBuffer(h*b),e=new DataView(d),g=0;h>g;g+=1)e[f](g*b,a.charCodeAt(g),c);return d}function h(b){var c,d,e,f,h,i,j=b.colors.length+2,k=0;for(i=20+(2+2*b.name.length)+28*b.colors.length+6,c=new ArrayBuffer(i),d=new Uint8Array(c),f=new DataView(c),f.setUint32(k,1095976262),k+=4,f.setUint32(k,65536),k+=4,f.setUint32(k,j),k+=4,f.setUint16(k,49153),k+=2,f.setUint32(k,4+2*b.name.length),k+=4,f.setUint16(k,b.name.length+1),k+=2,d.set(new Uint8Array(g(b.name,2)),k),k+=2*b.name.length+2,h=0;h<b.colors.length;h+=1)f.setUint16(k,1),k+=2,f.setUint32(k,22),k+=4,f.setUint16(k,1),k+=2,f.setUint16(k,0),k+=2,f.setUint32(k,1380401696),k+=4,e=a(b.colors[h]),f.setFloat32(k,e.r/255),k+=4,f.setFloat32(k,e.g/255),k+=4,f.setFloat32(k,e.b/255),k+=4,f.setUint16(k,2),k+=2;return f.setUint16(k,49154),c}var i=c(['<?xml version="1.0" encoding="utf-8"?>',"<!-- A Color Theme Generated by IcoMoon.io -->",'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">','<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{{width}}" height="{{height}}" viewBox="0 0 {{width}} {{height}}">',"{{rects",'<rect x="{{x}}" y="{{y}}" fill="{{fill}}" width="64" height="64"></rect>',"}}</svg>",""].join("\n"));return function(a){var b={};return b.getASE=function(a){return b.colors?h({colors:b.colors,name:a&&a.name||""}):!1},b.getSVG=function(){return b.colors?f({colors:b.colors}):!1},b.setColors=function(a){Array.isArray(a)?b.colors=a:a.ase?b.colors=e(a.ase)[0]:a.svg&&(b.colors=d(a.svg))},b.setColors(a),b}}])}(),angular.element.prototype.is||(angular.element.prototype.is=function(a){var b,c,d=a.split(/[,\s]+/);try{c=this[0].tagName.toUpperCase()}catch(e){return!1}for(b=0;b<d.length;b+=1)if(d[b].toUpperCase()===this[0].tagName.toUpperCase())return!0;return!1}),angular.element2||(angular.element2=function(a){"string"==typeof a&&(a=a.trim()),a=angular.element(a);var b;for(b=0;b<a.length;b+=1)if(1===a[b].nodeType)return angular.element(a[b]);return a}),angular.module("svg",["tmpl","color"]).factory("svgPath",["template","color",function(a,b){function c(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}}function d(a,b){var c=function(a,b,c){var d=a[0][b],e=a[1][b],f=a[2][b],g=1-c;return g*g*d+2*g*c*e+c*c*f};return{x:c(a,"x",b),y:c(a,"y",b)}}function e(a,b){var c=function(a,b,c){var d=a[0][b],e=a[1][b],f=a[2][b],g=a[3][b],h=1-c;return h*h*h*d+3*h*h*c*e+3*c*c*h*f+c*c*c*g};return{x:c(a,"x",b),y:c(a,"y",b)}}function f(a,b){return{x:2*b.x-a.x,y:2*b.y-a.y}}function g(a,b){var c,d,e,f,g,h,i,j,k;if(b&&a){if(c=isNaN(b.a)?1:b.a,d=isNaN(b.b)?0:b.b,e=isNaN(b.c)?0:b.c,f=isNaN(b.d)?1:b.d,g=isNaN(b.e)?0:b.e,h=isNaN(b.f)?0:b.f,j=a.length,!j)return{x:c*a.x+e*a.y+g,y:d*a.x+f*a.y+h};if(a[0]&&!isNaN(a[0].x)&&!isNaN(a[0].y)){for(k=[],i=0;j>i;i+=1)k[i]={},k[i].x=c*a[i].x+e*a[i].y+g,k[i].y=d*a[i].x+f*a[i].y+h;return k}if("number"==typeof a[0]&&0===j%2)for(i=0;j>i;i+=2)k={x:a[i],y:a[i+1]},a[i]=c*k.x+e*k.y+g,a[i+1]=d*k.x+f*k.y+h}}function h(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function i(a,b){return h({x:b.x-a.x,y:b.y-a.y})}function j(a,b){var c,d=a.x*b.y-a.y*b.x<0?1:-1;return c=(a.x*b.x+a.y*b.y)/(h(a)*h(b)),c>1?c=1:-1>c&&(c=-1),180*d*Math.acos(c)/Math.PI}function k(a,b){return(isNaN(b)||0>b)&&(b=3),a.toFixed(b).replace(/\.0+$/,"").replace(/(\.[^0]+)0+$/,"$1")}function l(a){return a=a.toLowerCase(),/[vh]/.test(a)?1:/[mlt]/.test(a)?2:/[sq]/.test(a)?4:/[c]/.test(a)?6:/[a]/.test(a)?7:0}function m(a){var b,c,d,e,f,g,h,i=[];if(!a)return i;for(a=a.replace(/,/g," ").replace(/-/g," -").replace(/-\s+/g,"-").replace(/e\s*/gi,"e").replace(/\.(\d+)\./g,".$1 .").replace(/\.(\d+)\./g,".$1 .").replace(/\s+/g," "),i=a.replace(/([mzlhvcsqta])\s?/gi,"|$1").split("|"),i.splice(0,1),f=i.length,d=0;f>d;d+=1){if(h=i[d],c=h[0],b=h.substr(1).trim())for(b=b.split(/\s/),g=b.length,e=0;g>e;e+=1)b[e]=Number(b[e]);else b=[];i[d]={cmd:c,args:b}}return i}function n(a){var b=[],c=0,d=a.length;for(c;d>c;c+=1)b.push(a[c].x),b.push(a[c].y);return b}function o(a){var b,c,d=[];if("string"==typeof a){for(d=a.trim().split(/[\s,]+/),c=d.length,b=0;c>b;b+=1)d[b]=Number(d[b]);return d}return a}function p(a){var b,c=[];return a=o(a),b=a.length,b-=b%2,b>3&&(c.push({cmd:"M",args:[a[0],a[1]]}),c.push({cmd:"L",args:a.slice(2)})),c}function q(a){var b=p(a);return b.push({cmd:"Z"}),b}function r(a,b,c,d,e,f){function h(a){u.push({cmd:"L",args:a})}function i(a){var b=[{x:p,y:r},{x:o,y:r},{x:o,y:q},{x:p,y:q}];t[a]&&(t[a].points=g(t[a].points,{e:b[a].x,f:b[a].y}),u.push({cmd:"C",args:n(t[a].points.slice(1))}))}var j,k,l,m,o,p,q,r,s,t=[],u=[];return a=Number(a),b=Number(b),e=Math.abs(Number(e)),f=Math.abs(Number(f)),c=Math.abs(Number(c)),d=Math.abs(Number(d)),0!==c&&0!==d?(!f&&e?f=e:!e&&f?e=f:e||f||(e=f=0),s=c/2,e/2>s&&(e=s),s=d/2,f/2>s&&(f=s),l=c-2*e,m=d-2*f,e&&(j=a+c/2,k=b+d/2,t=v({cx:0,cy:0,rx:e,ry:f})),o=a+e,p=o+l,q=b+f,r=q+m,u.push({cmd:"M",args:[o,b]}),l&&h([p,b]),i(3),m&&h([p+e,r]),i(0),l&&h([o,r+f]),i(1),m&&h([o-e,q]),i(2),u.push({cmd:"Z"}),u):void 0}function s(a,b,c,d){var e,f,g,h=[];if(a=Number(a),b=Number(b),c=Number(c),d=Number(d),0!==c||0!==d){for(e=v({cx:a,cy:b,rx:c,ry:d}),h.push({cmd:"M",args:[a+c,b]}),g=e.length,f=0;g>f;f+=1)h.push({cmd:"C",args:n(e[f].points.slice(1))});return h.push({cmd:"Z"}),h}}function t(a){var b,c,d=!1,e=a.tagName.toUpperCase();return a.getAttribute||(d=!0,a.getAttribute=function(b){return a[b]}),"PATH"===e?(b=m(a.getAttribute("d")),"evenodd"===(a.style["fill-rule"]||a.getAttribute("fill-rule"))&&(b.evenOdd=!0)):"POLYGON"===e?b=q(a.getAttribute("points")):"POLYLINE"===e?b=p(a.getAttribute("points")):"RECT"===e?b=r(a.getAttribute("x"),a.getAttribute("y"),a.getAttribute("width"),a.getAttribute("height"),a.getAttribute("rx"),a.getAttribute("ry")):"ELLIPSE"===e?b=s(a.getAttribute("cx"),a.getAttribute("cy"),a.getAttribute("rx"),a.getAttribute("ry")):"CIRCLE"===e&&(c=a.getAttribute("r"),b=s(a.getAttribute("cx"),a.getAttribute("cy"),c,c)),d&&delete a.getAttribute,b}function u(a){var b,c,d,e,f,g,h,i=[];for(f="string"==typeof a?m(a):t(a),h=f?f.length:0,e=0;h>e;e+=1)if(c=f[e].args,d=f[e].cmd,/m/.test(d)&&2===c.length&&f[e+1]&&/m/.test(f[e+1]));else if(b=l(d),c=c||[],c.length>b){g=0;do i.push({cmd:d,args:c.slice(g,g+b)}),g+=b,"m"===d?d="l":"M"===d&&(d="L");while(g<c.length)}else i.push({cmd:d,args:c});return x(i,{evenOdd:f&&f.evenOdd})}function v(a){function b(a,b){var c=(b-90*a)/90;return p?c:1-c}var c,d,e,f,g,h,i,j,k,l=a.cx,m=a.cy,n=a.rx,o=a.ry,p=a.angleDiff&&a.angleDiff>0,q=a.startAngle?a.startAngle%360:0,r=a.angleDiff?(a.angleDiff+q)%360:360,s=4*(Math.sqrt(2)-1)/3,t=s*n,u=s*o,v=[],w=[],x={x:l,y:m-o},y={x:l+n,y:m},z={x:l,y:m+o},A={x:l-n,y:m};if(0>q&&(q+=360),0>r&&(r+=360),e=x.x-t,f=x.x+t,g=A.y-u,h=A.y+u,v.push([{x:x.x,y:x.y},{x:f,y:x.y},{x:y.x,y:g},{x:y.x,y:y.y}]),v.push([{x:A.x,y:A.y},{x:A.x,y:g},{x:e,y:x.y},{x:x.x,y:x.y}]),v.push([{x:z.x,y:z.y},{x:e,y:z.y},{x:A.x,y:h},{x:A.x,y:A.y}]),v.push([{x:y.x,y:y.y},{x:y.x,y:h},{x:f,y:z.y},{x:z.x,y:z.y}]),p){for(c=Math.floor(q/90),c>3&&(c=0),d=Math.ceil(r/90)-1,0>d&&(d=3),k=v.length,j=0;k>j;j+=1)v[j].reverse();for(j=c;j!==d;)w.push(v[j]),j+=1,j>3&&(j=0);w.push(v[j])}else{for(c=Math.ceil(q/90)-1,0>c&&(c=3),d=Math.floor(r/90),d>3&&(d=0),j=c;j!==d;)w.push(v[j]),j-=1,0>j&&(j=3);w.push(v[j])}for(0!==q%90&&(i=N(w[0]),w[0]=i.splitAt(b(c,q))[1].points),0!==r%90&&(j=w.length-1,i=N(w[j]),w[j]=i.splitAt(b(d,r))[0].points),k=w.length,j=0;k>j;j+=1)w[j]=N(w[j]);return w}function w(a,b){function c(a){return g(a,{a:F,b:G,c:-G,d:F})}var d,e,f,h,i,k,l,m,n,o,p,q,r,s=a.x,t=a.y,u=b[5],w=b[6],x=b[3],y=b[4],z=Math.abs(b[0]),A=Math.abs(b[1]),B=z*z,C=A*A,D=b[2]%360*Math.PI/180,E={},F=Math.cos(D),G=Math.sin(D);if(s!==u||t!==w){if(!z||!A)return E.cmd="L",E.args=[u,w],E;for(x=x?1:0,y=y?1:0,f=g({x:(s-u)/2,y:(t-w)/2},{a:F,b:-G,c:G,d:F}),k=f.x*f.x,l=f.y*f.y,e=k/B+l/C,e>1&&(e=Math.sqrt(e),z*=e,A*=e,B=z*z,C=A*A),i=(x===y?-1:1)*Math.sqrt(Math.abs((B*C-B*l-C*k)/(B*l+C*k))),i={x:i*(z*f.y/A),y:i*(-A*f.x/z)},h=c(i),h.x+=(s+u)/2,h.y+=(t+w)/2,e={x:(f.x-i.x)/z,y:(f.y-i.y)/A},m=j({x:1,y:0},e),n=j(e,{x:-(f.x+i.x)/z,y:-(f.y+i.y)/A})%360,y&&n>0?n-=360:!y&&0>n&&(n+=360),d=v({cx:h.x,cy:h.y,rx:z,ry:A,startAngle:m,angleDiff:n}),b=[],q=d.length,o=0;q>o;o+=1)for(e=d[o],r=e.points.length,b[o]=[],p=0;r>p;p+=1)D&&(e.points[p]=g(e.points[p],{e:-h.x,f:-h.y}),e.points[p]=c(e.points[p]),e.points[p]=g(e.points[p],{e:h.x,f:h.y})),p>0&&(b[o].push(e.points[p].x),b[o].push(e.points[p].y));return b}}function x(a,b){function c(a,b){var c,d,e,f,g,h,j,k,l=[],m=0/0;if(b=b||.001,g=a.length,3>g)return!1;for(e=0;g>e;e+=1)f=a[e],c=f.cmd,"Z"===c?(h=!1,j=!1):"M"===c?(h={x:f.args[0],y:f.args[1]},j=!1):"C"===c?(h={x:f.args[4],y:f.args[5]},j=!1):"S"===c||"Q"===c?(h={x:f.args[2],y:f.args[3]},j=!1):"T"===c?(h={x:f.args[0],y:f.args[1]},j=!1):"L"===c&&(d={x:f.args[0],y:f.args[1]},h?(k=(d.y-h.y)/(d.x-h.x),!isNaN(m)&&(k===m||Math.abs(k-m)<b||i(h,d)<b)?l.pop():j?(h=j,m=(d.y-j.y)/(d.x-j.x)):isNaN(k)||(m=k)):h=d,j=d),"L"!==c&&(m=0/0),l.push(f);return l[0].cmd="M",l}var d,e,f,g,h,j,k,l,m,n={x:0,y:0},o=[],p=0;for(g=0,k=a.length;k>g;g+=1){if(e=a[g].cmd,h=/[a-z]/.test(e),e=e.toUpperCase(),d=a[g].args,"Z"===e)n=f,f=!1;else if(f||"M"===e||(f=n),"A"===e)h&&(d[5]+=n.x,d[6]+=n.y),m={x:d[5],y:d[6]},d=w(n,d),n=m,e="C";else if("H"===e)h&&(d[0]+=n.x),n={x:d[0],y:n.y},d[1]=n.y,e="L";else if("V"===e)h&&(d[0]+=n.y),n={x:n.x,y:d[0]},d[0]=n.x,d[1]=n.y,e="L";else{if("M"===e)try{m=a[g+1].cmd.toUpperCase(),"Z"===m?(d=!1,g+=1):p+=1}catch(q){}for(l=d.length,j=0;l>j;j+=2)h&&(d[j]+=n.x,d[j+1]+=n.y),0===(j+2)%l&&(n={x:d[j],y:d[j+1]})}if("M"===e&&f&&"Z"!==a[g-1].cmd.toUpperCase()&&o.push({cmd:"Z",args:[]}),d&&("M"!==e||!a[g+1]||"M"!==a[g+1].cmd.toUpperCase()))if("M"===e&&(f=n),d[0]&&d[0].length)for(l=d.length,j=0;l>j;j+=1)o.push({cmd:e,args:d[j]});else o.push({cmd:e,args:d})}return"Z"!==e&&o.push({cmd:"Z",args:[]}),o=c(o),b.evenOdd&&p>1?H(o):o}function y(a){var b,c,d,e,f={xMin:0/0,xMax:0/0,yMin:0/0,yMax:0/0};for(d=0,e=a.length;e>d;d+=1)b=a[d].args,c={x:b[b.length-2],y:b[b.length-1]},isNaN(c.x)||isNaN(c.y)||(f.xMin=f.xMin<c.x?f.xMin:c.x,f.xMax=f.xMax>c.x?f.xMax:c.x,f.yMin=f.yMin<c.y?f.yMin:c.y,f.yMax=f.yMax>c.y?f.yMax:c.y);return f}function z(a,b,f,g){var h,j,k,l,m,n,o,p,q,r,s,t,u,v=function(a,b){return{x:(a.x+b.x)/2,y:(a.y+b.y)/2}},w=v(a,b),x=v(f,g),y=c(a,b,.75),z=c(g,f,.75),A=(g.x-a.x)/16,B=(g.y-a.y)/16;return m=v(y,z),y.offCurve=!0,z.offCurve=!0,n=[a,y,m],o=[m,z,g],p=[a,w,y,m],q=[m,z,x,g],h=c(a,b,3/8),j=c(y,z,3/8),j.x-=A,j.y-=B,k=c(z,y,3/8),k.x+=A,k.y+=B,l=c(g,f,3/8),h.offCurve=!0,j.offCurve=!0,k.offCurve=!0,l.offCurve=!0,r=i(e(p,.5),d(n,.5))<10?[y,m]:[h,j,m],s=i(e(q,.5),d(o,.5))<10?[z,g]:[k,l,g],t=r.length-1,u=s.length-1,i(v(r[t-1],s[0]),r[t])<1&&r.splice(t),r.concat(s)}function A(a,b){var c=[],d={x:b[0],y:b[1]},e={x:b[2],y:b[3]};return c[4]=b[2],c[5]=b[3],c[0]=a.x+2/3*(d.x-a.x),c[1]=a.y+2/3*(d.y-a.y),c[2]=e.x+2/3*(d.x-e.x),c[3]=e.y+2/3*(d.y-e.y),c}function B(a){var b,c,d,e,g,h,i,j,k={x:0,y:0};for(a=a.slice(0),g=a.length,d=0;g>d;d+=1)c=a[d].cmd,b=a[d].args,"M"===c||"L"===c?k={x:b[0],y:b[1]}:"Z"===c&&(k={x:0,y:0}),"C"===c?(h={x:b[2],y:b[3]},k={x:b[4],y:b[5]}):"S"===c?(j=k,h&&(j=f(h,j)),h={x:b[0],y:b[1]},a[d].args=[j.x,j.y,b[0],b[1],b[2],b[3]],a[d].cmd="C",k={x:b[2],y:b[3]}):h=!1,"Q"===c?(i={x:b[0],y:b[1]},a[d].args=A(k,b),a[d].cmd="C",k={x:b[2],y:b[3]}):"T"===c?(j=k,i&&(j=f(i,j)),i=j,a[d].args=A(k,[j.x,j.y,b[0],b[1]]),a[d].cmd="C",k={x:b[0],y:b[1]}):i=!1;for(k={x:0,y:0},d=0;g>d;d+=1)for(b=a[d].args,e=0;e<b.length;e+=2)b[e]-=k.x,b[e+1]-=k.y,k.x+=Math.round(b[e]),k.y+=Math.round(b[e+1]);return a}function C(a){function b(){p.length>2&&o.push(p),p=[]}var c,d,e,g,h,i,j,k,l,m,n={x:0,y:0},o=[],p=[],q=a.length;for(e=0;q>e;e+=1)d=a[e].cmd,c=a[e].args,g="M"===d,g||"L"===d?(g&&b(),p.push({x:c[0],y:c[1]}),n={x:c[0],y:c[1]}):"Z"===d?(n={x:0,y:0},b()):h=n,"C"===d?(i={x:c[0],y:c[1]},j={x:c[2],y:c[3]},n={x:c[4],y:c[5]},k=n,p=p.concat(z(h,i,j,k)),l=j):"S"===d?(i=l?f(l,h):h,j={x:c[0],y:c[1]},n={x:c[2],y:c[3]},k=n,p=p.concat(z(h,i,j,k)),l=j):l=!1,"Q"===d?(i={x:c[0],y:c[1],offCurve:!0},n={x:c[2],y:c[3]},j=n,p.push(i),p.push(j),m=i):"T"===d?(m?(i=f(m,h),i.offCurve=!0):i=h,n={x:c[0],y:c[1]},j=n,p.push(i),p.push(j),m=i):m=!1;return p.length>2&&o.push(p),o}function D(a){function b(a,b){var c;for(a=a.slice(0),c=0;c<a.length;c+=2)a[c]-=b.x,a[c+1]-=b.y;p.push(a)}var c,d,e,g,h,i,j,k,l,m,n={x:0,y:0},o={x:0,y:0},p=[],q=a.length,r=[];for(e=0;q>e;e+=1)d=a[e].cmd,c=a[e].args,g="M"===d,g||"L"===d?(g?(p.push([c[0],c[1]]),o={x:c[0],y:c[1]}):b(c,n),n={x:c[0],y:c[1]}):"Z"===d?(n=o,r.push(p),p=[]):h=n,"C"===d?(b(c,n),l={x:c[2],y:c[3]},n={x:c[4],y:c[5]}):"S"===d?(i=l?f(l,h):h,j={x:c[0],y:c[1]},k={x:c[2],y:c[3]},b([i.x,i.y,j.x,j.y,k.x,k.y],n),l=j,n=k):l=!1,"Q"===d?(i={x:c[0],y:c[1],offCurve:!0},j={x:c[2],y:c[3]},b(A(n,c),n),m=i,n=j):"T"===d?(m?(i=f(m,h),i.offCurve=!0):i=h,j={x:c[0],y:c[1]},b(A(n,[i.x,i.y,j.x,j.y]),n),n=j,m=i):m=!1;return p.length&&(r.push(p),p=[]),r}function E(a){var b,c,d,e,g,h,i,j,l,m,n,o,p=[],q={x:0,y:0},r={},s=.001,t=[];for(j=a.length,g=0;j>g;g+=1){i=a[g];try{c=i.args.slice(0)}catch(u){c=[]}if(e=i.cmd.toLowerCase(),l=c?c.length:0,l>1){if(r.x=c[l-2],r.y=c[l-1],"c"===e?(m&&(o=f(m,q),Math.abs(o.x-c[0])<s&&Math.abs(o.y-c[1])<s?(e="s",c=c.slice(2),m=o):m=!1),m||(m={x:c[2],y:c[3]}),n=!1):"q"===e?(n&&(o=f(n,q),Math.abs(o.x-c[0])<s&&Math.abs(o.y-c[1])<s?(e="t",c=c.slice(2),n=o):n=!1),n||(n={x:c[0],y:c[1]}),m=!1):"s"===e?(m=m?f(m,q):!1,n=!1):"t"===e?(n=n?f(n,q):!1,m=!1):(m=!1,n=!1),"m"===e)e="M";else for(l=c.length,h=0;l>h;h+=2)c[h]-=q.x,c[h+1]-=q.y;"l"===e&&(0===c[0]?(e="v",c=[c[1]]):0===c[1]&&(e="h",c=[c[0]])),q.x=r.x,q.y=r.y}p.push({cmd:e,args:c})}for(d=[],g=0;j>g;g+=1){for(i=p[g],d.push(i),e=i.cmd,h=g+1;j>h&&p[h].cmd===e;)i.args=i.args.concat(p[h].args),h+=1;g=h-1}for(j=d.length,g=0;j>g;g+=1)for(i=d[g],t.push(i.cmd),l=i.args?i.args.length:0,h=0;l>h;h+=1)b=i.args[h],b=b>=0&&0!==h?" "+k(b):k(b),t.push(b);return t.join("")}function F(a){var b,c=a.length,d=[];for(b=0;c>b;b+=1)d.push(a[b].cmd),d.push(a[b].args.join(" "));return d.join("")}function G(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p={x:0,y:0},q=a.length,r=[],s=[],t=[];for(a=JSON.parse(JSON.stringify(a)),d=0;q>d;d+=1)c=a[d].cmd,b=a[d].args,"C"===c?(i={x:b[2],y:b[3]},p={x:b[4],y:b[5]}):"S"===c?(m=p,i&&(m=f(i,m)),i={x:b[0],y:b[1]},a[d].args=[m.x,m.y,b[0],b[1],b[2],b[3]],a[d].cmd="C",p={x:b[2],y:b[3]}):i=!1,"Q"===c?(j={x:b[0],y:b[1]},a[d].args=A(p,b),a[d].cmd="C",p={x:b[2],y:b[3]}):"T"===c?(m=p,j&&(m=f(j,m)),j=m,a[d].args=[m.x,m.y,b[0],b[1]],a[d].cmd="C",p={x:b[0],y:b[1]}):j=!1,t.push(a[d].cmd),t=t.concat(a[d].args);for(e=new RegExp("[MLCQZ]",""),d=0;d<t.length;d+=1){if(l=t[d],!e.test(l))return a;if("C"===l)h=3,k=2;else if("Q"===l)h=2,k=1;else if("L"===l)h=1,k=1;else{if("M"!==l){s.push("M");continue}h=1,k=0}for(h===k&&s.push(l),g=0;h>g;g+=1)g===k&&s.push(l),n=t[++d],o=t[++d],s.push(o),s.push(n)}for(d=s.length-1;d>-1;d-=1)"string"==typeof s[d]?r.push({cmd:s[d],args:[]}):r[r.length-1].args.push(s[d]);return r[r.length-1].cmd="Z",r}function H(b){function c(a){var b,c=[];for(b=0;b<a.length;b+=1)c=c.concat(a[b]);return c}function d(a,b){var c,d,e,f,g=0;for(c=a.getContext("2d").getImageData(0,0,a.width,a.height).data,d=b.getContext("2d").getImageData(0,0,b.width,b.height).data,e=0,f=c.length;f>e;e+=1)c[e]!==d[e]&&(g+=1);return g}var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=0,x=b.length,y=[],z=[];for(h=0;x>h;h+=1){for(e=b[h].args,i=0;i<e.length;i+=2)k="number"==typeof k?Math.max(k,e[i]):e[i],m="number"==typeof m?Math.min(m,e[i]):e[i],l="number"==typeof l?Math.max(l,e[i+1]):e[i+1],n="number"==typeof n?Math.min(n,e[i+1]):e[i+1];f=b[h].cmd,("Z"===f||"z"===f)&&(y.push(b.slice(w,h+1)),w=h+1)}for(v=k-m,j=l-n,s=a(['<svg width="{{width}}" height="{{height}}" viewBox="0 0 {{width}} {{height}}">','<g transform="scale({{scale}}) translate('+-m+" "+-n+')"><path d="{{paths}}" {{attrs}}/></g>',"</svg>"].join("")),q=document.createElement("canvas"),t=document.createElement("canvas"),r=50/j,v*=r,j*=r,q.width=t.width=v,q.height=t.height=j,canvg(q,s.fillup({paths:F(b),width:v,height:j,scale:r,attrs:'fill-rule="evenodd"'})),h=0;h<y.length;h+=1)z.push(G(y[h]));for(o=y.slice(0),canvg(t,s.fillup({paths:F(c(o)),attrs:""})),g=d(q,t),p=g+1;g&&p>g;)for(p=g,h=0;h<y.length;h+=1){if(o[h]=z[h],canvg(t,s.fillup({paths:F(c(o))})),u=d(q,t),0===u)return c(o);g>=u?g=u:o[h]=y[h]}return c(o)}function I(a){var b,c,d,e,f={},g={};d=a[0].getAttribute("viewBox"),d&&(d=d.trim().split(/\s*[\,\s]\s*/),f.x=Number(d[0]),f.y=Number(d[1]),f.w=Number(d[2]),f.h=Number(d[3]));try{e=2===a[0].width.baseVal.unitType?f.w*a[0].width.baseVal.valueInSpecifiedUnits/100:a[0].width.baseVal.valueInSpecifiedUnits||a[0].width.baseVal.value,c=2===a[0].height.baseVal.unitType?f.h*a[0].width.baseVal.valueInSpecifiedUnits/100:a[0].height.baseVal.valueInSpecifiedUnits||a[0].height.baseVal.value}catch(h){try{b=a[0].getBBox(),e=b.width,c=b.height}catch(i){return e=f.w,c=f.h,{viewBox:{x:0,y:0,width:e,height:c},transform:!1}}}if(!d)return{viewBox:{x:0,y:0,width:e,height:c},transform:!1};if(e=e||f.w,c=c||f.h,f.w<0||f.h<0)throw new Error("Invalid viewBox.");return e>=c&&f.w>=f.h||c>=e&&f.w>=f.h?(g.a=g.d=e/f.w,g.e=0):(c>=e&&f.w<=f.h||e>=c&&f.w<=f.h)&&(g.d=g.a=c/f.h),g.a&&(g.f=(c-g.d*f.h)/2,g.e=(e-g.a*f.w)/2,g.e-=f.x*g.a,g.f-=f.y*g.d),!isNaN(g.a)&&1!==g.a||g.e||g.f||(g=!1),{viewBox:{x:0,y:0,width:e,height:c},transform:g}}function J(a){function b(a){var b,c,d=a.attr("transform"),e=/(\w+)\s*\(([e\d\s\.\,\-]+)\)/gm,f=[],g=[];return d?(d.replace(e,function(a,d,e){var h,i;g=e.replace(/-/g," -").replace(/e\s*/g,"e").replace(/,/g," ").replace(/\s+/g," ").trim().split(/\s/),g.forEach(function(a,b){g[b]=Number(a)}),"matrix"===d&&6===g.length?f.push({a:g[0],b:g[1],c:g[2],d:g[3],e:g[4],f:g[5]}):"scale"===d?(h=g[0]||1,i=g[1]||h,f.push({a:h,b:0,c:0,d:i})):"translate"===d?(h=g[0]||0,i=g[1]||0,f.push({a:1,b:0,c:0,d:1,e:h,f:i})):"rotate"===d&&(h=g[0]/180*Math.PI,b=Math.cos(h),c=Math.sin(h),f.push({a:b,b:c,c:-c,d:b}))}),f.reverse()):[]}function c(a,b){var c,d;for(c=0,d=b.length;d>c;c+=1)a.transform(b[c])}function d(a){var b=window.getComputedStyle(a),c=["fill","stroke","display","opacity","visibility","fill-rule"],d=[];return c.forEach(function(a){d.push(a+":"+b[a])}),d.join(";")}function e(a,f,g){var h,i,j,l,n,o,p,q,r,s,t,u,v,w,x;if(m&&a.attr("style",d(a[0])),"0"!==a.css("opacity")&&0!==a.attr("opacity")&&(l=a.attr("display"),n=a.css("display"),o=a.attr("fill"),p=a.css("fill"),v=a.attr("visibility"),w=a.css("visibility"),u=a.attr("opacity"),t=a.css("opacity"),g=g||{},g=JSON.parse(JSON.stringify(g)),(o||p)&&(p=p||o,g.fill="none"===p||"transparent"===p||/rgba\(\d+,\s*\d+,\s*\d+,\s*0\)/.test(p),g.fill!==!0&&(g.fill=p||o,g.fill=g.fill.replace(/\s+/g,""),(/#000|#000000|rgb\(0,0,0\)|rgba\(0,0,0,1\)/.test(g.fill)||!g.fill)&&(g.fill="#000"))),g.opacity!==!0&&(u||t)&&(t=Number(t||u)*(Number(a.css("fill-opacity")||a.attr("fill-opacity"))||1),"number"!=typeof g.opacity&&(g.opacity=1),g.opacity*=t,0===g.opacity&&(g.opacity=!0)),"none"!==l&&"none"!==n)){if((v||w)&&(w=w||v,"hidden"===w&&(g.visibility=!0)),a.is("use")&&(x=a.attr("xlink:href").trim(),"#"===x[0]&&(x=k.querySelector(x),x&&(a.append(x),a.attr("transform",["translate(",a.attr("x")||0,",",a.attr("y")||0,") ",a.attr("transform")].join(""))))),a.is("g, use")||a.is("switch"))for(i=a.children(),q=a[0].style["fill-rule"]||a.attr("fill-rule"),x=K(),r=0,s=i.length;s>r;r+=1)j=L(i[r]),!q||j[0].style["fill-rule"]||j.attr("fill-rule")||j.attr("fill-rule",q),e(j,x,g);else{if(!a.is("polygon, polyline, path, circle, rect, ellipse"))return;h={};for(x in g)if(g.hasOwnProperty(x)){if(g[x]===!0)return;h[x]=g[x]}x=K(a[0]),x.setAttrs(h)}c(x,b(a)),f.append(x)}}var f,g,h,i,j,k,l,m=!1,n=K();for("string"==typeof a&&(a=L(a)),a.find("style")&&(m=!0,document.body.appendChild(a[0])),f=a.children(),h=a[0].style["fill-rule"]||a.attr("fill-rule"),k=a[0],i=0,j=f.length;j>i;i+=1)g=L(f[i]),m&&g.attr("style",d(g[0])),!h||g[0].style["fill-rule"]||g.attr("fill-rule")||g.attr("fill-rule",h),e(g,n);return l=I(a),m&&a.remove(),n.transform(l.transform),l.viewBox&&(n.viewBox=l.viewBox),n}function K(a){var c=[],d={};return d.append=function(a){var b,e,f,g,h,i,j=!1,k=[];if(c.forEach(function(a){k.push(JSON.stringify(a))}),!a)return this;if(M(a)){for(g=a.length,e=0;g>e;e+=1)d.append(a[e]);return this}if("string"!=typeof a&&a.length&&(a=a[0]),"string"==typeof a&&/<\/svg>/i.test(a)||a.tagName&&"svg"===a.tagName.toLowerCase()){for(a=J(L(a)),a.viewBox&&(d.viewBox=a.viewBox),a=a.getPathArray(),i=d.viewBox,i={xMin:i.x,xMax:i.x+i.width,yMin:i.y,yMax:i.y+i.height},h=[],f=0;f<a.length;f+=1)b=y(a[f]),b.xMin<i.xMax&&b.xMax>i.xMin&&b.yMin<i.yMax&&b.yMax>i.yMin&&h.push(a[f]);a=h,j=!0}else a.tagName||"string"==typeof a?a=u(a):a.getPathArray?(a=a.getPathArray(),j=!0):a=!1;return a&&-1===k.indexOf(JSON.stringify(a))&&(j?c=c.concat(a):c.push(a)),function(){var a,b=[],d=[];c.length>1&&(c.forEach(function(c){var e=JSON.stringify(c);a=b.indexOf(e),-1!==a?d.splice(a,1):b.push(e),d.push(c)}),c=d)}(),this},d.setPath=function(a){return c=[],d.append(a)},d.setAttrs=function(a,b){b=b||0,c[b]&&(c[b].attrs=a)},d.getAttrs=function(a){var d,e,f=c.length,g=[],h=!1;for(e=0;f>e;e+=1)g.push(c[e].attrs||{}),a&&(d=b(g[e].fill),"number"==typeof g[e].opacity&&1!==g[e]&&(d.a*=g[e].opacity),delete g[e].opacity,g[e].fill=d.toString(),e&&!h&&b(g[e].fill).distance(b(g[e-1].fill))>10&&(h=!0));if(a)if(h)for(e=0;f>e;e+=1)g[e]=g[e]||{},g[e].fill||(g[e].fill="#000");else for(e=0;f>e;e+=1)delete g[e].fill;return g},d.getPathData=function(a){var b,d,e=[];for(b=0;b<c.length;b+=1)d=E(c[b]),-1===e.indexOf(d)&&e.push(d);return a?e:e.join("")},d.transform=function(a,b){var e,f,h=0,i=c.length;for(!isNaN(b)&&b>=0&&i>b&&(h=b,i=b+1),h;i>h;h+=1)for(e=c[h],f=0;f<e.length;f+=1)g(e[f].args,a);return d.viewBox&&(a.a&&(d.viewBox.width=Math.abs(Math.round(a.a*d.viewBox.width))),a.d&&(d.viewBox.height=Math.abs(Math.round(a.d*d.viewBox.height)))),this},d.scale=function(a,b,c){return a=Number(a),b=Number(b),a&&1/0!==a?(d.transform({a:a,d:b||a},c),this):this},d.translate=function(a,b,c){return a=Number(a),b=Number(b),isNaN(a)?this:(isNaN(b)&&(b=a),d.transform({e:a,f:b},c),this)},d.rotate=function(a,b){var c,e;return a=Number(a)/180*Math.PI,isNaN(a)?this:(c=Math.cos(a),e=Math.sin(a),d.transform({a:c,b:e,c:-e,d:c},b),this)},d.deleteSubPath=function(a){return a>=0&&a<c.length&&c.splice(a,1),this},d.getTTFContours=function(){var a,b=[];for(a=0;a<c.length;a+=1)b=b.concat(C(c[a]));return b.length||(b=[[{x:0,y:0},{x:0,y:0},{x:0,y:0}]]),b},d.getCFFPath=function(){var a,b=[];for(a=0;a<c.length;a+=1)b=b.concat(c[a]);return b=B(b),b.length||(b=[{cmd:"Z",args:[]}]),b},d.getPDFSegments=function(){var a,b=[];for(a=0;a<c.length;a+=1)b.push(D(c[a]));return b},d.getPathArray=function(){return c.slice(0)},d.setPath(a),d}var L=angular.element2,M=function(a){return"[object Array]"===Object.prototype.toString.call(a)},N=function(a,b,d,e){var f={},g=function(a,b){var d,e,g,h,i,j,k=f.points[0],l=f.points[1],m=f.points[2],n=f.points[3];return d=c(k,l,a),e=c(l,m,a),g=c(m,n,a),h=c(d,e,a),i=c(e,g,a),j=c(h,i,a),b&&b.point?j:[N(k,d,h,j),N(j,i,g,n)]};return a.length?f.points=a.slice(0):(f.points=[],f.points[0]=a,f.points[1]=b,f.points[2]=d,f.points[3]=e),f.getPointAt=function(a){return g(a,{point:!0})},f.splitAt=g,f};return K}]).factory("glyphs",["svgPath","template",function(a,b){var c=angular.element2;return function(d){function e(a){return a=a.replace(/,[,\s]+/g,",").replace(/,$/,"").replace(/^,/,"").trim(),a.split(",")}function f(b,d,f){var g,h,i,j,k=parseInt(b.attr("horiz-adv-x"),10);return d=d||0,f||s.fillup({width:k||r.defaultAdvX}),g=b.attr("d"),!g||g.length<10||b.hasClass("hidden")?!1:(i=a(g),i.transform({a:1,d:-1,f:r.ascent-d}),f?(i.viewBox={x:0,y:0,width:k,height:r.unitsPerEm},j=b.attr("data-tags")||b.attr("glyph-name"),j&&(i.tags=e(j)),h=b.attr("unicode"),h&&(i.defaultCode=h.codePointAt(0)),i):c(s.fillup({d:i.getPathData()})))}var g,h,i,j,k,l,m,n,o,p,q=[],r={},s=b(['<svg viewBox="0 0 {{width}} {{height}}" width="{{width}}" height="{{height}}">','<path d="{{d}}"></path>',"</svg>"].join(""));if("string"==typeof d&&(d=c(d)),j=d.find("glyph"),l=j.length)for(i=d.children(),k=0;k<i.length;k+=1)i.eq(k).is("g, polygon, polyline, path, circle, rect, ellipse, use")&&(n=!0);if(!l||n)p=d.attr("data-tags"),d=a(d),p&&(d.tags=e(p)),q.push(d);else{for(r.defaultAdvX=parseInt(d.find("font").attr("horiz-adv-x"),10),p=d.find("font-face"),r.ascent=parseInt(p.attr("ascent"),10),r.descent=parseInt(p.attr("descent"),10),r.unitsPerEm=r.ascent-r.descent,s.fillup({height:r.unitsPerEm}),m=d.find("metadata"),m.length&&(m=m.find("json"),m.length&&(m=JSON.parse(m.text()),q.metadata={name:m.name||m.fontFamily,url:m.url||m.fontURL,designer:m.designer,designerURL:m.designerURL,license:m.license,licenseURL:m.licenseURL},m.grid&&(q.metadata.grid=m.grid))),h=angular.element(document.body),k=0;20>k;k+=1)if(p=f(c(j[k])),p&&(h.append(p),g=p[0].getBBox(),p.remove(),g.height===r.unitsPerEm)){if(o===g.y)break;
o=g.y}for(k=0;l>k;k+=1)p=f(c(j[k]),o,!0),p&&q.push(p)}return q}}]),function(){var a="http://www.w3.org/1999/xlink",b=angular.module("svg"),c={};angular.forEach([{miAttrName:"miXlinkHref",attrName:"xlink:href"},"d","fill","opacity","width","height","viewBox","x1","x2","y1","y2"],function(b){var d;"string"==typeof b?d="mi"+b.substr(0,1).toUpperCase()+b.substr(1):(d=b.miAttrName,b=b.attrName),c[d]=function(){return{priority:99,link:function(c,e,f){f.$observe(d,function(c){c&&(/:/.test(b)?e[0].setAttributeNS(a,b,c):e.attr(b,c))})}}}}),b.directive(c)}(),angular.module("font",["svg","tmpl"]).factory("font",["svgPath","template",function(a,b){function c(b){var c,l,n,p,r,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab="truetype"===b.outlines||"truetype"===b.woff,bb=h,cb={},db=[],eb=[],fb=0,gb=[0],hb=[{aw:h,lsb:0}],ib=0,jb=!0,kb={},lb={},mb=0,nb=0,ob={advXSum:0,advXCount:0},pb=0,qb={},rb=["CFF ","OS/2","cmap","gasp","glyf","head","hhea","hmtx","loca","maxp","name","post"];for(T=d.length,K=0;T>K;K+=1)for(Z=d[K].code,isNaN(Z)&&(Z=K+58880,d[K].code=Z),db.push(Z),Z=d[K].ligatures,N=N||{},P=Z?Z.length||0:0,!O&&Z&&(O=!0),L=0;P>L;L+=1)"string"==typeof Z[L]&&Z[L].length>1&&(N[Z[L]]=d[K].code);for(X in N)if(N.hasOwnProperty(X))for(K=0;K<X.length;K+=1)Z=X.charCodeAt(K),db.indexOf(Z)<0&&(d.push({code:Z,advX:0}),db.push(Z));d.sort(function(a,b){return a.code-b.code}),db.sort(function(a,b){return a-b});for(X in N)if(N.hasOwnProperty(X))for(N[X]=db.indexOf(N[X])+1,K=0;K<X.length;K+=1)lb[X.charAt(K)]=db.indexOf(X.charCodeAt(K))+1;for(T=d.length,K=0;T>K;K+=1)d[K].contours||(W=d[K].svgPath,W?(W.viewBox&&W.viewBox.height!==g&&(Z=g/W.viewBox.height,W.scale(Z)),d[K].d=W.transform({a:1,d:-1,f:e}).getPathData(),d[K].contours=W.getTTFContours()):(d[K].contours=[[{x:0,y:0},{x:0,y:0},{x:0,y:0}]],d[K].svgPath=a())),Z=t(d[K].contours),mb=k(mb,Z.pointsCount),nb=k(nb,Z.contourCount),eb.push(Z.buffer),!ib&&fb/2>65535&&(ib=1),gb.push(fb/2),fb+=Z.buffer.byteLength,Z=Z.bbox,120===d[K].code&&(ob.sxHeight=Z.yMax),72===d[K].code&&(ob.sCapHeight=Z.yMax),cb.xMin=j(cb.xMin,Z.xMin),cb.yMin=j(cb.yMin,Z.yMin),cb.xMax=k(cb.xMax,Z.xMax),cb.yMax=k(cb.yMax,Z.yMax),Q=Z.xMin,R=j(Q,R),c=d[K].advX,isNaN(c)&&d[K].svgPath&&(c=d[K].svgPath.viewBox,c&&(c=c.width,d[K].advX=c)),isNaN(c)||c===h?c=h:(jb&&T>1&&(jb=!1),bb=k(c,bb)),c&&(ob.advXSum+=c,ob.advXCount+=1),_=k(_,Q+Z.xMax-Z.xMin),Z=c-Z.xMax,S=j(S,Z),hb.push({aw:c,lsb:Q});if(T+=1,gb.push(fb/2),b.woff&&!ab&&(qb["CFF "]=J({psName:i.psName,fontFamily:i.fontFamily,fullName:i.fullName,ascent:e,descent:f,bbox:{xMin:cb.xMin<0?cb.xMin:0,yMin:j(f,cb.yMin),xMax:k(bb,cb.xMax),yMax:k(e,cb.yMax)},defaultAdvX:h,emSize:g,glyphs:d}),qb.maxp2=v({numGlyphs:T,maxPoints:mb,maxContours:nb,cff:!0})),(b.ttf||b.eot||ab)&&(qb.glyf=m(eb),qb.loca=C(gb,ib),qb.maxp=v({numGlyphs:T,maxPoints:mb,maxContours:nb})),qb.cmap=u(db),qb.gasp=E([65535,15]),qb.head=x({xMin:cb.xMin,yMin:cb.yMin,xMax:cb.xMax,yMax:cb.yMax,unitsPerEm:g,indexToLocFormat:ib,majorVersion:i.majorVersion,minorVersion:i.minorVersion}),qb.hhea=z({ascent:e,descent:f,advanceWidthMax:bb,numOfLongHorMetrics:hb.length,minRightSideBearing:S,minLeftSideBearing:R,xMaxExtent:_}),qb.hmtx=A(hb),qb.name=y(i),O&&(rb.splice(1,0,"GSUB"),qb.GSUB=F(N,lb)),n=db[0],n=n>65535?65535:n,M=db[db.length-1],ob={italicAngle:0,emSize:g,usFirstCharIndex:n,usLastCharIndex:M>65535?65535:M,ascent:e,descent:f,codes:db,xAvgCharWidth:Math.round(ob.advXSum/ob.advXCount),sxHeight:ob.sxHeight||0,sCapHeight:ob.sCapHeight||0},qb["OS/2"]=D(ob),qb.post=w({isFixedPitch:jb}),P=rb.length,b.ttf||b.eot||ab){for(U=P-1,p=[s(U)],Y=[],V=[],pb=p[0].byteLength+16*U,K=0;P>K;K+=1)"CFF "!==rb[K]&&("head"===rb[K]&&(L=V.length),Z=qb[rb[K]],Z={buffer:Z,origLength:Z.byteLength},Z.buffer=m([Z.buffer],4),V.push(Z.buffer),Y.push(B({tag:o(rb[K]),checksum:q(Z.buffer),offset:pb,length:Z.origLength}).buffer),pb+=Z.buffer.byteLength);p=p.concat(Y),Z=q(m(p.concat(V))),Z=2981146554-Z,new DataView(V[L]).setUint32(8,Z),p=m(p.concat(V))}if(!ab){for(U=P-2,r=[s(U,!0)],Y=[],V=[],pb=r[0].byteLength+16*U,K=0;P>K;K+=1)Z=rb[K],"glyf"!==Z&&"loca"!==Z&&("maxp"===Z?Z="maxp2":"head"===Z&&(L=V.length),Z=qb[Z],Z={buffer:Z,origLength:Z.byteLength},Z.buffer=m([Z.buffer],4),V.push(Z.buffer),Y.push(B({tag:o(rb[K]),checksum:q(Z.buffer),offset:pb,length:Z.origLength}).buffer),pb+=Z.buffer.byteLength);r=r.concat(Y),Z=q(m(r.concat(V))),Z=2981146554-Z,new DataView(V[L]).setUint32(8,Z),r=m(r.concat(V))}return b.ttf&&(kb.ttf=p),b.eot&&(l=H({ttf:p,checkSumAdjustment:Z,name:i,os2:ob}),kb.eot=l),b.woff&&($=G({tableDirectory:Y,subTables:V,sfntSize:ab?p.byteLength:r.byteLength,majorVersion:i.majorVersion,minorVersion:i.minorVersion,truetype:ab}),kb.woff=$),b.svg&&(kb.svg=I()),kb}var d,e,f,g,h,i,j=function(a,b){return isNaN(a)?b:isNaN(b)?a:b>a?a:b},k=function(a,b){return isNaN(a)?b:isNaN(b)?a:a>b?a:b},l=function(a,b){var c,d,e,f=a.length;for(f=f>b.length?f:b.length,e=0;f>e;e+=1)if(c=a.charCodeAt(e),d=b.charCodeAt(e),c!==d)return isNaN(c)?-1:isNaN(d)?1:c-d;return 0},m=function(a,b){var c,d,e=a.length,f=0,g=0,h=0;for(c=0;e>c;c+=1)f+=a[c].byteLength;if(!isNaN(b)&&b>0)for(;f>g;)g+=b;for(d=new Uint8Array(g||f),c=0;e>c;c+=1)d.set(new Uint8Array(a[c]),h),h+=a[c].byteLength;return d.buffer},n=function(a,b,c){var d,e,f,g,h=a.length;for(1===b?f="setUint8":(f="setUint16",b=2),d=new ArrayBuffer(h*b),e=new DataView(d),g=0;h>g;g+=1)e[f](g*b,a.charCodeAt(g),c);return d},o=function(a){var b,c=a.length,d="";for(b=0;c>b;b+=1)d+=a[b].charCodeAt(0).toString(16);return parseInt(d,16)},p=function(a){for(var b=0;a>=2;)a/=2,b+=1;return b},q=function(a){var b,c=new DataView(a),d=a.byteLength,e=0;for(b=0;d>b;b+=4)e+=c.getUint32(b),e>4294967295&&(e=parseInt(e.toString(16).match(/.{8}$/)[0],16));return e},r=function(a){var b,c,d=[{bit:0,range:[0,127]},{bit:1,range:[128,255]},{bit:2,range:[256,383]},{bit:3,range:[384,591]},{bit:4,range:[592,687]},{bit:4,range:[7424,7551]},{bit:4,range:[7552,7615]},{bit:5,range:[688,767]},{bit:5,range:[42752,42783]},{bit:6,range:[768,879]},{bit:6,range:[7616,7679]},{bit:7,range:[880,1023]},{bit:8,range:[11392,11519]},{bit:9,range:[1024,1279]},{bit:9,range:[1280,1327]},{bit:9,range:[11744,11775]},{bit:9,range:[42560,42655]},{bit:10,range:[1328,1423]},{bit:11,range:[1424,1535]},{bit:12,range:[42240,42559]},{bit:13,range:[1536,1791]},{bit:13,range:[1872,1919]},{bit:14,range:[1984,2047]},{bit:15,range:[2304,2431]},{bit:16,range:[2432,2559]},{bit:17,range:[2560,2687]},{bit:18,range:[2688,2815]},{bit:19,range:[2816,2943]},{bit:20,range:[2944,3071]},{bit:21,range:[3072,3199]},{bit:22,range:[3200,3327]},{bit:23,range:[3328,3455]},{bit:24,range:[3584,3711]},{bit:25,range:[3712,3839]},{bit:26,range:[4256,4351]},{bit:26,range:[11520,11567]},{bit:27,range:[6912,7039]},{bit:28,range:[4352,4607]},{bit:29,range:[7680,7935]},{bit:29,range:[11360,11391]},{bit:29,range:[42784,43007]},{bit:30,range:[7936,8191]},{bit:31,range:[8192,8303]},{bit:31,range:[11776,11903]},{bit:32,range:[8304,8351]},{bit:33,range:[8352,8399]},{bit:34,range:[8400,8447]},{bit:35,range:[8448,8527]},{bit:36,range:[8528,8591]},{bit:37,range:[8592,8703]},{bit:37,range:[10224,10239]},{bit:37,range:[10496,10623]},{bit:37,range:[11008,11263]},{bit:38,range:[8704,8959]},{bit:38,range:[10752,11007]},{bit:38,range:[10176,10223]},{bit:38,range:[10624,10751]},{bit:39,range:[8960,9215]},{bit:40,range:[9216,9279]},{bit:41,range:[9280,9311]},{bit:42,range:[9312,9471]},{bit:43,range:[9472,9599]},{bit:44,range:[9600,9631]},{bit:45,range:[9632,9727]},{bit:46,range:[9728,9983]},{bit:47,range:[9984,10175]},{bit:48,range:[12288,12351]},{bit:49,range:[12352,12447]},{bit:50,range:[12448,12543]},{bit:50,range:[12784,12799]},{bit:51,range:[12544,12591]},{bit:51,range:[12704,12735]},{bit:52,range:[12592,12687]},{bit:53,range:[43072,43135]},{bit:54,range:[12800,13055]},{bit:55,range:[13056,13311]},{bit:56,range:[44032,55215]},{bit:57,range:[55296,57343]},{bit:58,range:[67840,67871]},{bit:59,range:[19968,40959]},{bit:59,range:[11904,12031]},{bit:59,range:[12032,12255]},{bit:59,range:[12272,12287]},{bit:59,range:[13312,19903]},{bit:59,range:[131072,173791]},{bit:59,range:[12688,12703]},{bit:60,range:[57344,63743]},{bit:61,range:[12736,12783]},{bit:61,range:[63744,64255]},{bit:61,range:[194560,195103]},{bit:62,range:[64256,64335]},{bit:63,range:[64336,65023]},{bit:64,range:[65056,65071]},{bit:65,range:[65040,65055]},{bit:65,range:[65072,65103]},{bit:66,range:[65104,65135]},{bit:67,range:[65136,65279]},{bit:68,range:[65280,65519]},{bit:69,range:[65520,65535]},{bit:70,range:[3840,4095]},{bit:71,range:[1792,1871]},{bit:72,range:[1920,1983]},{bit:73,range:[3456,3583]},{bit:74,range:[4096,4255]},{bit:75,range:[4608,4991]},{bit:75,range:[4992,5023]},{bit:75,range:[11648,11743]},{bit:76,range:[5024,5119]},{bit:77,range:[5120,5759]},{bit:78,range:[5760,5791]},{bit:79,range:[5792,5887]},{bit:80,range:[6016,6143]},{bit:80,range:[6624,6655]},{bit:81,range:[6144,6319]},{bit:82,range:[10240,10495]},{bit:83,range:[40960,42127]},{bit:83,range:[42128,42191]},{bit:84,range:[5888,5919]},{bit:84,range:[5920,5951]},{bit:84,range:[5952,5983]},{bit:84,range:[5984,6015]},{bit:85,range:[66304,66351]},{bit:86,range:[66352,66383]},{bit:87,range:[66560,66639]},{bit:88,range:[118784,119039]},{bit:88,range:[119040,119295]},{bit:88,range:[119296,119375]},{bit:89,range:[119808,120831]},{bit:90,range:[1044480,1048573]},{bit:90,range:[1048576,1114109]},{bit:91,range:[65024,65039]},{bit:91,range:[917760,917999]},{bit:92,range:[917504,917631]},{bit:93,range:[6400,6479]},{bit:94,range:[6480,6527]},{bit:95,range:[6528,6623]},{bit:96,range:[6656,6687]},{bit:97,range:[11264,11359]},{bit:98,range:[11568,11647]},{bit:99,range:[19904,19967]},{bit:100,range:[43008,43055]},{bit:101,range:[65536,65663]},{bit:101,range:[65664,65791]},{bit:101,range:[65792,65855]},{bit:102,range:[65856,65935]},{bit:103,range:[66432,66463]},{bit:104,range:[66464,66527]},{bit:105,range:[66640,66687]},{bit:106,range:[66688,66735]},{bit:107,range:[67584,67647]},{bit:108,range:[68096,68191]},{bit:109,range:[119552,119647]},{bit:110,range:[73728,74751]},{bit:110,range:[74752,74879]},{bit:111,range:[119648,119679]},{bit:112,range:[7040,7103]},{bit:113,range:[7168,7247]},{bit:114,range:[7248,7295]},{bit:115,range:[43136,43231]},{bit:116,range:[43264,43311]},{bit:117,range:[43312,43359]},{bit:118,range:[43520,43615]},{bit:119,range:[65936,65999]},{bit:120,range:[66e3,66047]},{bit:121,range:[66208,66271]},{bit:121,range:[66176,66207]},{bit:121,range:[67872,67903]},{bit:122,range:[127024,127135]},{bit:122,range:[126976,127023]}];for(b=0,c=d.length;c>b;b+=1)if(a>=d[b].range[0]&&a<=d[b].range[1])return d[b].bit;return 0},s=function(a,b){for(var c,d=new ArrayBuffer(12),e=1,f=0,g=new DataView(d);a>e;)f+=1,e*=2;return e/=2,f-=1,c=16*e,g.setUint32(0,b?o("OTTO"):65536),g.setUint16(4,a),g.setUint16(6,c),g.setUint16(8,f),g.setUint16(10,16*a-c),d},t=function(a){var b,c,d,e,f,g,h,i,l,n,o=[],p=[],q=[],r=[],s={},t=0,u=function(a,b,c,d){var e,f,g,h=1,i=4;"y"===a&&(h+=1,i+=1),d?(e=d.roundedVal,isNaN(e)&&(e=d.val)):e=0,c.relVal=c.val-e,g=Math.round(c.relVal),c.relVal=c.relVal>0&&.5===c.relVal%1?g-1:g,c.roundedVal=Math.round(e+c.relVal),f=d&&0===c.relVal,!f&&c.relVal<256&&c.relVal>-256?(b[h]=1,c.relVal<0?(b[i]=0,c.relVal=-c.relVal):b[i]=1,c.byteLength=1):(b[h]=0,f?(b[i]=1,c.byteLength=0):(b[i]=0,c.byteLength=2))},v=function(a,b){var c,d,e,f,g=b.length,h=new ArrayBuffer(2*g),i=new DataView(h),j=0;for(c=0;g>c;c+=1)d=b[c],e=d[a].byteLength,e&&(f=d[a].relVal,1===e?i.setUint8(j,f):2===e&&i.setUint16(j,f),j+=e);return h.slice(0,j)};for(a=Object.create(a),f=a.length,e=0;f>e;e+=1){for(b=a[e],i=[],g=b.length,t+=g,d=0;g>d;d+=1)i[d]=[],i[d][3]=0,h=b[d],h.offCurve?i[d][0]=0:(i[d][0]=1,b.xMin=j(b.xMin,h.x),b.yMin=j(b.yMin,h.y),b.xMax=k(b.xMax,h.x),b.yMax=k(b.yMax,h.y)),h.x={val:h.x},h.y={val:h.y},0===d?a[e-1]?(l=a[e-1].length,l=a[e-1][l-1]):l=!1:l=b[d-1],u("x",i[d],h.x,l?l.x:!1),u("y",i[d],h.y,l?l.y:!1);for(g=i.length,c=0;g>c;c+=1){for(d=0,l=i[c].join("");256>d&&i[c+d+1]&&l===i[c+d+1].join("");)d+=1;d&&(i[c][3]=1,i[c+1]=d,i.splice(c+2,d-1),g=i.length,c+=1)}b.flags=i,b.xBuffer=v("x",b),b.yBuffer=v("y",b)}for(i=[],c=0,f=a.length;f>c;c+=1){for(b=a[c],s.xMin=Math.round(j(s.xMin,b.xMin)),s.yMin=Math.round(j(s.yMin,b.yMin)),s.xMax=Math.round(k(s.xMax,b.xMax)),s.yMax=Math.round(k(s.yMax,b.yMax)),p.push(b.length+(p[c-1]||-1)),d=0,g=b.flags.length;g>d;d+=1)b.flags[d].length&&(b.flags[d]=parseInt(b.flags[d].reverse().join(""),2));i.push(new Uint8Array(b.flags).buffer),q.push(b.xBuffer),r.push(b.yBuffer)}for(i=m(i),l=new ArrayBuffer(2*p.length+2),n=new DataView(l),c=0,f=p.length;f>c;c+=1)n.setInt16(2*c,p[c]);return l=[l],q=m(q),r=m(r),l.push(i),l.push(q),l.push(r),o=m(l),l=new ArrayBuffer(10),n=new DataView(l),n.setUint16(0,a.length),n.setUint16(2,s.xMin),n.setUint16(4,s.yMin),n.setUint16(6,s.xMax),n.setUint16(8,s.yMax),l=[l],l.push(o),{buffer:m(l,4),bbox:s,contourCount:a.length,pointsCount:t}},u=function(a){function b(a,b){var c,d,e=[],f=a.length;for(d=0,a.sort(function(a,b){return a.code-b.code}),c=1;f>c;c+=1)(a[c].code!==a[c-1].code+1||b&&a[c].idx!==a[c-1].idx+1)&&(e.push(a.slice(d,c)),d=c);return e.push(a.slice(d,f)),e}function c(a,b,c){var d,f;e||(e=new ArrayBuffer(8*v)),f=e.lastOffset||0,d=new DataView(e),d.setUint16(f,a),f+=2,d.setUint16(f,b),f+=2,d.setUint32(f,c),f+=4,e.lastOffset=f}var d,e,f,g,h,i,j,k,l,n,o,q,r,s=[],t=[],u=[],v=3;for(k=a.length,j=0;k>j;j+=1)r=a[j],65535>=r?t.push({idx:j+1,code:r}):u.push({idx:j+1,code:r});if(i=u.length>0,h=t.length>0,i&&h&&(v=6),i&&(u=u.concat(t)),r=new ArrayBuffer(4),d=new DataView(r),d.setUint16(0,0),d.setUint16(2,v),s.push(r),h){for(t.indexOf(65535)<0&&t.push({idx:0,code:65535}),t.indexOf(65534)<0&&t.indexOf(65533)<0&&t.push({idx:0,code:65533}),n=b(t),q=n.length,g=new ArrayBuffer(2*(8+4*q)),d=new DataView(g),d.setUint16(0,4),d.setUint16(2,g.byteLength),d.setUint16(4,0),d.setUint16(6,2*q),r=2*Math.pow(2,p(q)),d.setUint16(8,r),d.setUint16(10,p(r/2)),d.setUint16(12,2*q-r),l=14,j=0;q>j;j+=1)d.setUint16(l,n[j][n[j].length-1].code),l+=2;for(d.setUint16(l,0),l+=2,j=0;q>j;j+=1)d.setUint16(l,n[j][0].code),l+=2;for(j=0;q>j;j+=1)d.setInt16(l,n[j][0].idx-n[j][0].code),l+=2;for(j=0;q>j;j+=1)d.setUint16(l,0),l+=2}if(l=4+8*v,r=g?g.byteLength:0,r+=l,h&&c(0,3,l),i&&c(0,4,r),h&&c(1,3,l),i&&c(1,4,r),h&&c(3,1,l),i&&c(3,10,r),s.push(e),h&&s.push(g),i){for(o=b(u,!0),q=o.length,f=new ArrayBuffer(16+12*q),d=new DataView(f),d.setUint32(0,786432),d.setUint32(4,f.byteLength),d.setUint32(8,0),d.setUint32(12,q),l=16,j=0;q>j;j+=1)r=o[j],d.setUint32(l,r[0].code),l+=4,d.setUint32(l,r[r.length-1].code),l+=4,d.setUint32(l,r[0].idx),l+=4;s.push(f)}return m(s,4)},v=function(a){var b=new ArrayBuffer(a.cff?6:32),c=new DataView(b);return c.setUint32(0,a.cff?20480:65536),c.setUint16(4,a.numGlyphs||0),a.cff||(c.setUint16(6,a.maxPoints||0),c.setUint16(8,a.maxContours||0),c.setUint16(10,a.maxComponentPoints||0),c.setUint16(12,a.maxComponentContours||0),c.setUint16(14,2),c.setUint16(16,a.maxTwilightPoints||0),c.setUint16(18,a.maxStorage||0),c.setUint16(20,a.maxFunctionDefs||0),c.setUint16(22,a.maxInstructionDefs||0),c.setUint16(24,a.maxStackElements||0),c.setUint16(26,a.maxSizeOfInstructions||0),c.setUint16(28,a.maxComponentElements||0),c.setUint16(30,a.maxComponentDepth||0)),b},w=function(a){var b=new ArrayBuffer(32),c=new DataView(b);return c.setInt32(0,196608),c.setUint32(12,a.isFixedPitch?1:0),b},x=function(a){var b=new ArrayBuffer(54),c=new DataView(b),d={val:Math.round((new Date).getTime()/1e3)+2082844800};return d.msb=Math.floor(d.val/4294967295),d.lsb=Math.floor(d.val%4294967295),c.setInt32(0,65536),c.setUint32(4,Math.round(65536*Number(a.majorVersion+"."+a.minorVersion))),c.setUint32(12,1594834165),c.setUint8(16,0),c.setUint8(17,11),c.setUint16(18,a.unitsPerEm||0),c.setUint32(20,d.msb),c.setUint32(24,d.lsb),c.setUint32(28,d.msb),c.setUint32(32,d.lsb),c.setInt16(36,a.xMin||0),c.setInt16(38,a.yMin||0),c.setInt16(40,a.xMax||0),c.setInt16(42,a.yMax||0),c.setUint16(44,0),c.setUint16(46,a.lowestRecPPEM||8),c.setInt16(48,2),c.setInt16(50,a.indexToLocFormat||0),b},y=function(a){function b(a){var b=new ArrayBuffer(12),c=new DataView(b);return c.setUint16(0,a.pid),c.setUint16(2,a.sid),c.setUint16(4,a.languageID||0),c.setUint16(6,a.nameID),c.setUint16(8,a.byteLength),c.setUint16(10,a.offset),b}var c,d,e,f,g,h,i,j,k=[],l=[],o=[],p=0,q=[],r={copyright:0,fontFamily:1,subFamily:2,fontId:3,fullName:4,version:5,psName:6,trademark:7,manufacturer:8,designer:9,description:10,fontURL:11,designerURL:12,license:13,licenseURL:14};for(g in a)i=a[g],f=r[g],!isNaN(f)&&i&&(q.push(n(i,1)),h=i.length,l.push({pid:1,sid:0,nameID:f,offset:p,byteLength:h}),p+=h,h*=2,q.push(n(i)),o.push({pid:3,sid:1,languageID:1033,nameID:f,offset:p,byteLength:h}),p+=h);for(j=function(a,b){return a.nameID-b.nameID},l.sort(j),o.sort(j),l=l.concat(o),e=0,h=l.length;h>e;e+=1)l[e]=b(l[e]);return h?(c=new ArrayBuffer(6),d=new DataView(c),d.setUint16(2,h),k.push(c),l=m(l),k.push(l),q=m(q),k.push(q),c=m(k),d=new DataView(c),d.setUint16(4,l.byteLength+6),c):void 0},z=function(a){var b=new ArrayBuffer(36),c=new DataView(b);return c.setUint32(0,65536),c.setInt16(4,a.ascent||0),c.setInt16(6,a.descent||0),c.setInt16(8,a.lineGap||0),c.setUint16(10,a.advanceWidthMax||0),c.setInt16(12,a.minLeftSideBearing||0),c.setInt16(14,a.minRightSideBearing||0),c.setInt16(16,a.xMaxExtent||0),c.setInt16(18,1),c.setUint16(34,a.numOfLongHorMetrics),b},A=function(a){var b,c,d,e=0,f=a.length;for(b=new ArrayBuffer(4*f),c=new DataView(b),d=0;f>d;d+=1)c.setUint16(e,a[d].aw),c.setInt16(e+2,a[d].lsb),e+=4;return b},B=function(a){var b=new ArrayBuffer(16),c=new DataView(b),d={tag:0,checksum:4,offset:8,length:12},e=function(a){var b,e;for(b in a)a.hasOwnProperty(b)&&(e=d[b],isNaN(e)||c.setUint32(e,a[b]))};return e(a),{buffer:b,set:e}},C=function(a,b){var c,d,e,f=b?4:2,g=a.length,h=b?"setUint32":"setUint16";for(c=new ArrayBuffer(g*f),d=new DataView(c),e=0;g>e;e+=1)d[h](e*f,a[e]*(b?2:1));return c},D=function(a){var b,c=new ArrayBuffer(96),d=new DataView(c),e=a.emSize,f=Math.sin(a.italicAngle*Math.PI/180),g=.7*e,h=.65*e,i=.14*e,j=.48*e;for(d.setUint16(0,3),d.setInt16(2,a.xAvgCharWidth||e||0),a.usWeightClass=a.usWeightClass||400,d.setUint16(4,a.usWeightClass),d.setUint16(6,a.usWidthClass||5),a.fsType=a.fsType||0,d.setUint16(8,a.fsType),d.setInt16(10,h||0),d.setInt16(12,g||0),d.setInt16(14,-f*i),d.setInt16(16,i),d.setInt16(18,h),d.setInt16(20,g),d.setInt16(22,f*j),d.setInt16(24,j),d.setInt16(26,102*e/2048),d.setInt16(28,530*e/2048),d.setInt16(30,0),a.panose=[],a.unicodeRanges=[],b=0;128>b;b+=1)a.unicodeRanges[b]=0;return a.codes&&a.codes.forEach(function(b){a.unicodeRanges[r(b)]=1}),d.setUint32(42,parseInt(a.unicodeRanges.slice(0,32).reverse().join(""),2)),d.setUint32(46,parseInt(a.unicodeRanges.slice(32,64).reverse().join(""),2)),d.setUint32(50,parseInt(a.unicodeRanges.slice(64,96).reverse().join(""),2)),d.setUint32(54,parseInt(a.unicodeRanges.slice(96,128).reverse().join(""),2)),d.setUint16(62,64),a.italic=0,d.setUint16(64,a.usFirstCharIndex||0),d.setUint16(66,a.usLastCharIndex||0),d.setInt16(68,a.sTypoAscender||a.ascent||0),d.setInt16(70,a.sTypoDescender||a.descent||0),d.setInt16(72,a.sTypoLineGap||Math.abs(a.descent)||0),d.setUint16(74,a.usWinAscent||a.ascent||0),d.setUint16(76,a.usWinDescent||-a.descent||0),d.setUint32(78,1),a.codePageRange1=1,a.codePageRange2=0,d.setInt16(86,a.sxHeight||0),d.setInt16(88,a.sCapHeight||0),d.setUint16(92,32),d.setUint16(94,a.usMaxContext||0),a.panose=0,c},E=function(a){var b,c,d=new ArrayBuffer(4+2*a.length),e=new DataView(d),f=a.length;for(e.setUint16(0,1),e.setUint16(2,f/2),c=4,b=0;f>b;b+=2)e.setUint16(c,a[b]),e.setUint16(c+2,a[b+1]),c+=2;return d},F=function(a,b){function c(a){var c,d,e=a.str.length,f=new ArrayBuffer(2*(e-1)+4),g=new DataView(f);for(g.setUint16(0,a.id),g.setUint16(2,e),d=4,c=1;e>c;c+=1)g.setUint16(d,b[a.str.charAt(c)]),d+=2;return f}function d(a){var b,d,e,f=[],g=a.length,h=2+2*g,i=new ArrayBuffer(h),j=new DataView(i);for(a.sort(function(a,b){return l(b.str,a.str)}),j.setUint16(0,g),e=2,b=0;g>b;b+=1)j.setUint16(e,h),e+=2,d=c(a[b]),f[b+1]=d,h+=d.byteLength;return f[0]=i,m(f)}var e,f,g,h,i,j,k,n,p,q=new ArrayBuffer(20),r=new ArrayBuffer(14),s=new ArrayBuffer(14),t={},u=[],v=[],w=0;for(k in a)a.hasOwnProperty(k)&&!isNaN(a[k])&&(p=k.charAt(0),t[p]||(t[p]=[],w+=1),t[p].push({id:a[k],str:k}));for(k in t)t.hasOwnProperty(k)&&u.push({key:k,set:t[k]});for(u.sort(function(a,b){return l(a.key,b.key)}),g=new DataView(q),g.setUint16(0,1),g.setUint32(2,o("latn")),g.setUint16(6,8),g.setUint16(8,4),g.setUint16(10,0),g.setUint16(12,0),g.setUint16(14,0),g.setUint16(16,1),g.setUint16(18,0),g=new DataView(r),g.setUint16(0,1),g.setUint32(2,o("liga")),g.setUint16(6,8),g.setUint16(8,0),g.setUint16(10,1),g.setUint16(12,0),g=new DataView(s),g.setUint16(0,1),g.setUint16(2,4),g.setUint16(4,4),g.setUint16(8,1),g.setUint16(10,10),g.setUint16(12,0),p=6+2*w,e=new ArrayBuffer(p),g=new DataView(e),g.setUint16(0,1),g.setUint16(2,p),g.setUint16(4,w),f=new ArrayBuffer(4+2*w),g=new DataView(f),g.setUint16(0,1),g.setUint16(2,w),p=4,i=0;w>i;i+=1)g.setUint16(p,b[u[i].key]||0),p+=2;for(j=f.byteLength+e.byteLength,n=6,g=new DataView(e),i=0;w>i;i+=1)p=d(t[u[i].key]),v.push(p),g.setUint16(n,j),n+=2,j+=p.byteLength;return h=new ArrayBuffer(10),n=10,g=new DataView(h),g.setUint32(0,65536),g.setUint16(4,n),n+=q.byteLength,g.setUint16(6,n),n+=r.byteLength,g.setUint16(8,n),m([h,q,r,s,e,f].concat(v))},G=function(a){var b,c,d,e,f,g,h,i,j=a.tableDirectory.length,k=[];for(f=new ArrayBuffer(44),d=new DataView(f),d.setUint32(0,2001684038),a.truetype?d.setUint32(4,65536):d.setUint32(4,o("OTTO")),d.setUint16(12,j),d.setUint32(16,a.sfntSize),d.setUint16(20,a.majorVersion||0),d.setUint16(22,a.minorVersion||0),g=44+20*j,e=0;j>e;e+=1)b=new ArrayBuffer(20),c=new DataView(b),h=new DataView(a.tableDirectory[e]),c.setUint32(0,h.getUint32(0)),c.setUint32(4,g),g+=a.subTables[e].byteLength,i=h.getUint32(12),c.setUint32(8,i),c.setUint32(12,i),c.setUint32(16,h.getUint32(4)),k.push(b);return k=m(k),i=m(a.subTables),d.setUint32(8,f.byteLength+k.byteLength+i.byteLength),m([f,k,i])},H=function(a){function b(a){var b=new ArrayBuffer(4),c=[],d=new DataView(b);return d.setUint16(2,2*a.length,!0),c.push(b),c.push(n(a,2,!0)),m(c)}var c,d,e,f,g,h=!0;for(c=new ArrayBuffer(80),d=new DataView(c),d.setUint32(4,a.ttf.byteLength,h),d.setUint32(8,131073,h),f=16,g=a.os2.panose,e=0;e<g.length;e+=1)d.setUint8(f,g[e],h),f+=4;return d.setUint8(26,1,h),d.setUint8(27,a.os2.italic,h),d.setUint32(28,a.os2.usWeightClass,h),d.setUint16(32,a.os2.fsType,h),d.setUint16(34,20556,h),d.setUint32(36,a.os2.unicodeRange1,h),d.setUint32(40,a.os2.unicodeRange2,h),d.setUint32(44,a.os2.unicodeRange3,h),d.setUint32(48,a.os2.unicodeRange4,h),d.setUint32(52,a.os2.codePageRange1,h),d.setUint32(56,a.os2.codePageRange2,h),d.setUint32(60,a.checkSumAdjustment,h),c=m([c,b(a.name.fontFamily),b(a.name.subFamily),b(a.name.version),b(a.name.fullName),new ArrayBuffer(4),a.ttf]),d=new DataView(c),d.setUint32(0,c.byteLength,h),c},I=function(){var a,c,j,k,m,n,o,p,q,r,s=[],t=[];for(c=b(' horiz-adv-x="{{advX}}"'),r=b(' data-tags="{{tags}}"'),j=b('<glyph unicode="{{code}}" d="{{d}}"{{advX}}{{tags}} />'),p=b(['<?xml version="1.0" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" >','<svg xmlns="http://www.w3.org/2000/svg">',"<metadata>","<json>","{{metadata}}","</json>","</metadata>","<defs>",'<font id="{{fontId}}" horiz-adv-x="{{defaultAdvX}}">','<font-face units-per-em="{{unitsPerEm}}" ascent="{{ascent}}" descent="{{descent}}" />','<missing-glyph horiz-adv-x="{{defaultAdvX}}" />',"{{glyphs}}","</font></defs></svg>"].join("\n")),n=d.length,k=0;n>k;k+=1)if(a=d[k].advX,a=isNaN(a)||a===h?"":c.fillup({advX:a}),q=d[k].tags,q=q&&q.length?r.fillup({tags:q.join(", ")}):"",(d[k].d||32===d[k].code)&&(t.push(j.fillup({code:"&#x"+d[k].code.toString(16)+";",d:d[k].d,advX:a,tags:q})),d[k].ligatures))for(m=0,o=d[k].ligatures.length;o>m;m+=1)s.push({d:d[k].d,liga:d[k].ligatures[m],advX:a,tags:q});for(s.sort(function(a,b){return l(b.liga,a.liga)}),m=0,o=s.length;o>m;m+=1)s[m]=j.fillup({code:s[m].liga,d:s[m].d,advX:s[m].advX,tags:s[m].tags});return t=t.concat(s),t=t.join("\n"),p.fillup({metadata:JSON.stringify(i,null,"	"),fontId:i.fontId,defaultAdvX:h,unitsPerEm:g,ascent:e,descent:f,glyphs:t})},J=function(a){function b(a,b){var c,d;return a=Math.round(a),a>=-107&&107>=a&&(!b||1===b)?(c=new Uint8Array(1),a+=139,c[0]=a,c.buffer):a>=108&&1131>=a&&(!b||2===b)?(c=new Uint8Array(2),a-=108,c[0]=Math.floor(a/256)+247,c[1]=Math.floor(a%256),c.buffer):a>=-1131&&-108>=a&&(!b||2===b)?(c=new Uint8Array(2),a+=108,c[0]=Math.floor(-a/256)+251,c[1]=Math.floor(-a%256),c.buffer):a>=-32768&&32767>=a&&(!b||3===b)?(c=new ArrayBuffer(3),d=new DataView(c),d.setUint8(0,28),d.setInt16(1,a),c):(c=new ArrayBuffer(5),d=new DataView(c),d.setUint8(0,29),d.setInt32(1,a),c)}function c(a){var b,c,d,e,f=[1,14];for(a=a.toFixed(6).replace(/\.0+$/,"").replace(/(\.[^0]+)0+$/,"$1").toUpperCase(),d=0;d<a.length;d+=1)e=a[d],"."===e?f.push(10):"E"===e?"-"===a[d+1]?(f.push(12),d+=1):(f.push(11),"+"===a[d+1]&&(d+=1)):"-"===e?f.push(14):f.push(parseInt(e,10));for(f.push(15),f.length%2&&f.push(15),b=new ArrayBuffer(f.length/2),c=new DataView(b),d=0;d<f.length;d+=2)c.setUint8(d/2,16*f[d]+f[d+1]);return b}function e(a){return a%1?c(a):b(a)}function f(a){var b,c,d,e,f,g,h=a.length,i=[1];for(d=new ArrayBuffer(2),b=new DataView(d),b.setUint16(0,h),c=0;h>c;c+=1)i.push(i[c]+a[c].byteLength);for(h=i.length,f=i[h-1],256>f?(e="setUint8",f=1):65536>f?(e="setUint16",f=2):(e="setUint32",f=4),g=new ArrayBuffer(h*f),b=new DataView(g),c=0;h>c;c+=1)b[e](c*f,i[c]);return d=m([d,new Uint8Array([f]).buffer,g,m(a)])}var g,h,i,j,k,l,o,p=new ArrayBuffer(2),q=new ArrayBuffer(4),r=new ArrayBuffer(5),s=391,t=new ArrayBuffer(7);for(i=new DataView(q),i.setUint8(0,1),i.setUint8(2,4),i.setUint8(3,4),i=new DataView(r),i.setUint16(0,1),i.setUint8(2,1),i.setUint8(3,1),i.setUint8(4,a.psName.length+1),r=m([r,n(a.psName,1)]),i=new DataView(t),i.setUint16(0,1),i.setUint8(2,2),i.setUint16(3,1),o=1/a.emSize,t=m([t,b(s+1),new Uint8Array([2]).buffer,b(s),new Uint8Array([3]).buffer,b(388),new Uint8Array([4]).buffer,e(o),new Uint8Array([139,139]).buffer,e(o),new Uint8Array([139,139]).buffer,new Uint8Array([12,7]).buffer,e(a.bbox.xMin),e(a.bbox.yMin),e(a.bbox.xMax),e(a.bbox.yMax),new Uint8Array([5]).buffer]),l=[n(a.fontFamily,1),n(a.fullName,1)],j=0;j<d.length;j+=1)l.push(n("u"+d[j].code.toString(16).toUpperCase(),1));return l=f(l),h=new ArrayBuffer(5),i=new DataView(h),i.setUint8(0,2),i.setUint16(1,s+2),i.setUint16(3,a.glyphs.length-1),function(){var c,d,e,h,i,j,k,l=0,n=[m([b(-a.defaultAdvX),new Uint8Array([14]).buffer])];for(h=a.glyphs,i=0;i<h.length;i+=1){for(d=[],j=h[i].svgPath.getCFFPath(),h[i].advX!==a.defaultAdvX&&d.push(b(h[i].advX-a.defaultAdvX)),k=0;k<j.length;k+=1)e=j[k].cmd,c=j[k].args,"M"===e?(d.push(b(c[0])),d.push(b(c[1])),d.push(new Uint8Array([21]))):"L"===e?(d.push(b(c[0])),d.push(b(c[1])),l+=2,(l>47||k+1<j.length&&"L"!==j[k+1].cmd)&&(d.push(new Uint8Array([5])),l=0)):"C"===e&&(d=d.concat([b(c[0]),b(c[1]),b(c[2]),b(c[3]),b(c[4]),b(c[5])]),l+=6,(l>47||k+1<j.length&&"C"!==j[k+1].cmd)&&(d.push(new Uint8Array([8])),l=0));d.push(new Uint8Array([14])),n.push(m(d))}g=f(n)}(),k=m([b(a.defaultAdvX),new Uint8Array([20]).buffer,b(a.defaultAdvX),new Uint8Array([21]).buffer,b(0),new Uint8Array([12,10]).buffer]),function(){var a,c,d=m([q,r,t,l,p,h]);a=d.byteLength+20+3,c=d.byteLength+g.byteLength+20+3,t=m([t,b(d.byteLength-h.byteLength+23,5),new Uint8Array([15]).buffer,b(a,5),new Uint8Array([17]).buffer,b(k.byteLength,5),b(c,5),new Uint8Array([18]).buffer])}(),i=new DataView(t),i.setUint16(5,t.byteLength-6),m([q,r,t,l,p,h,g,k])},K=function(){var a="Font generated by IcoMoon.";i||(i={}),isNaN(i.majorVersion)||isNaN(i.minorVersion)||(i.version=i.majorVersion+"."+i.minorVersion),i.version=i.version?i.version.match(/\d{1,5}\.\d{1,5}/)||"1.0":"1.0",isNaN(i.majorVersion)&&(i.majorVersion=Number(i.version.match(/(\d+)\./)[1])),isNaN(i.minorVersion)&&(i.majorVersion=Number(i.version.match(/\.(\d+)/)[1])),i.version="Version "+i.version,i.fontFamily=i.fontFamily||"icomoon",i.fontId=i.fontId||i.fontFamily,i.psName=i.psName||i.fontFamily,i.subFamily=i.subFamily||"Regular",i.fullName=i.fontFamily,/regular/i.test(i.subFamily)||(i.fullName+=" "+i.subFamily),i.description?-1===i.description.indexOf(a)&&(i.description=i.description+"\n"+a):i.description=a};return function(a){var b={};return b.set=function(a){return d=a.glyphs,e=a.ascent,f=a.descent,g=a.unitsPerEm,h=a.defaultAdvX,i=a.metadata?JSON.parse(JSON.stringify(a.metadata)):{},K(),this},b.generate=function(a){return a||(a={woff:!0,ttf:!0,eot:!0,svg:!0}),c(a)},a&&b.set(a),b}}]),angular.module("file",["scriptLoader"]).factory("fileSaver",["scriptLoader","$q","$http",function(a,b,c){function d(a,b){g?i.then(function(){var c=new Blob([b]);c.encoding="base64",saveAs(c,a)}):c.post("https://icomoon.io/fileMirror/mirror2.php",{file:"string"==typeof b?b:b.toString(!0),ext:a.match(/\.(\w+)$/)[1]},{transformResponse:!1}).then(function(a){location.href=a.data})}var e=function(a,b){this.files={},this.root="",a&&this.load(a,b)};e.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},e.defaults={base64:!1,binary:!1,dir:!1,date:null,compression:null},e.prototype=function(){var a=function(a,b,c){this.name=a,this.data=b,this.options=c};a.prototype={asText:function(){var a=this.data;return null===a||"undefined"==typeof a?"":(this.options.base64&&(a=f.decode(a)),this.options.binary&&(a=e.prototype.utf8decode(a)),a)},asBinary:function(){var a=this.data;return null===a||"undefined"==typeof a?"":(this.options.base64&&(a=f.decode(a)),this.options.binary||(a=e.prototype.utf8encode(a)),a)},asUint8Array:function(){return e.utils.string2Uint8Array(this.asBinary())},asArrayBuffer:function(){return e.utils.string2Uint8Array(this.asBinary()).buffer}};var b=function(a,b){var c,d="";for(c=0;b>c;c++)d+=String.fromCharCode(255&a),a>>>=8;return d},c=function(){var a,b,c={};for(a=0;a<arguments.length;a++)for(b in arguments[a])arguments[a].hasOwnProperty(b)&&"undefined"==typeof c[b]&&(c[b]=arguments[a][b]);return c},d=function(a){return a=a||{},a.base64===!0&&null==a.binary&&(a.binary=!0),a=c(a,e.defaults),a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),a},g=function(b,c,f){var g=h(b);if(g&&i.call(this,g),f=d(f),f.dir||null===c||"undefined"==typeof c)f.base64=!1,f.binary=!1,c=null;else if(e.support.uint8array&&c instanceof Uint8Array)f.base64=!1,f.binary=!0,c=e.utils.uint8Array2String(c);else if(e.support.arraybuffer&&c instanceof ArrayBuffer){f.base64=!1,f.binary=!0;var j=new Uint8Array(c);c=e.utils.uint8Array2String(j)}else f.binary&&!f.base64&&(f.optimizedBinaryString!==!0&&(c=e.utils.string2binary(c)),delete f.optimizedBinaryString);return this.files[b]=new a(b,c,f)},h=function(a){"/"==a.slice(-1)&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf("/");return b>0?a.substring(0,b):""},i=function(a){if("/"!=a.slice(-1)&&(a+="/"),!this.files[a]){var b=h(a);b&&i.call(this,b),g.call(this,a,null,{dir:!0})}return this.files[a]},j=function(a,c,d){var f,g,h=c!==a.name,i=a.asBinary(),j=a.options;f=j.date.getHours(),f<<=6,f|=j.date.getMinutes(),f<<=5,f|=j.date.getSeconds()/2,g=j.date.getFullYear()-1980,g<<=4,g|=j.date.getMonth()+1,g<<=5,g|=j.date.getDate();var k=null!==i&&0!==i.length;if(d=j.compression||d,!e.compressions[d])throw d+" is not a valid compression method !";var l=e.compressions[d],m=k?l.compress(i):"",n="";return n+="\n\x00",n+=h?"\x00\b":"\x00\x00",n+=k?l.magic:e.compressions.STORE.magic,n+=b(f,2),n+=b(g,2),n+=k?b(this.crc32(i),4):"\x00\x00\x00\x00",n+=k?b(m.length,4):"\x00\x00\x00\x00",n+=k?b(i.length,4):"\x00\x00\x00\x00",n+=b(c.length,2),n+="\x00\x00",{header:n,compressedData:m}};return{filter:function(b){var d,e,f,g,h=[];for(d in this.files)this.files.hasOwnProperty(d)&&(f=this.files[d],g=new a(f.name,f.data,c(f.options)),e=d.slice(this.root.length,d.length),d.slice(0,this.root.length)===this.root&&b(e,g)&&h.push(g));
return h},file:function(a,b,c){if(1===arguments.length){if(a instanceof RegExp){var d=a;return this.filter(function(a,b){return!b.options.dir&&d.test(a)})}return this.filter(function(b,c){return!c.options.dir&&b===a})[0]||null}return a=this.root+a,g.call(this,a,b,c),this},folder:function(a){if(!a)return this;if(a instanceof RegExp)return this.filter(function(b,c){return c.options.dir&&a.test(b)});var b=this.root+a,c=i.call(this,b),d=this.clone();return d.root=c.name,d},remove:function(a){a=this.root+a;var b=this.files[a];if(b||("/"!=a.slice(-1)&&(a+="/"),b=this.files[a]),b)if(b.options.dir)for(var c=this.filter(function(b,c){return c.name.slice(0,a.length)===a}),d=0;d<c.length;d++)delete this.files[c[d].name];else delete this.files[a];return this},generate:function(a){a=c(a||{},{base64:!0,compression:"STORE",type:"base64"});var d=a.compression.toUpperCase();if(!e.compressions[d])throw d+" is not a valid compression method !";var g=[],h=[],i=0;for(var k in this.files)if(this.files.hasOwnProperty(k)){var l=this.files[k],m=this.utf8encode(l.name),n="",o="",p=j.call(this,l,m,d);n=e.signature.LOCAL_FILE_HEADER+p.header+m+p.compressedData,o=e.signature.CENTRAL_FILE_HEADER+"\x00"+p.header+"\x00\x00"+"\x00\x00"+"\x00\x00"+(this.files[k].options.dir===!0?"\x00\x00\x00":"\x00\x00\x00\x00")+b(i,4)+m,i+=n.length,h.push(n),g.push(o)}var q=h.join(""),r=g.join(""),s="";s=e.signature.CENTRAL_DIRECTORY_END+"\x00\x00"+"\x00\x00"+b(h.length,2)+b(h.length,2)+b(r.length,4)+b(q.length,4)+"\x00\x00";var t=q+r+s;switch(a.type.toLowerCase()){case"uint8array":return e.utils.string2Uint8Array(t);case"arraybuffer":return e.utils.string2Uint8Array(t).buffer;case"blob":return e.utils.string2Blob(t);case"base64":return a.base64?f.encode(t):t;default:return t}},crc32:function(a,b){if(""===a||"undefined"==typeof a)return 0;var c=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"==typeof b&&(b=0);var d=0,e=0;b=-1^b;for(var f=0,g=a.length;g>f;f++)e=255&(b^a.charCodeAt(f)),d=c[e],b=b>>>8^d;return-1^b},clone:function(){var a=new e;for(var b in this)"function"!=typeof this[b]&&(a[b]=this[b]);return a},utf8encode:function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(192|d>>6),b+=String.fromCharCode(128|63&d)):(b+=String.fromCharCode(224|d>>12),b+=String.fromCharCode(128|63&d>>6),b+=String.fromCharCode(128|63&d))}return b},utf8decode:function(a){for(var b="",c=0,d=0,e=0,f=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3);return b}}}(),e.compressions={STORE:{magic:"\x00\x00",compress:function(a){return a},uncompress:function(a){return a}}},e.support={arraybuffer:function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array}(),uint8array:function(){return"undefined"!=typeof Uint8Array}(),blob:function(){if("undefined"==typeof ArrayBuffer)return!1;var a=new ArrayBuffer(0);try{return 0===new Blob([a],{type:"application/zip"}).size}catch(b){}try{var c=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return c.append(a),0===c.getBlob("application/zip").size}catch(b){}return!1}()},e.utils={string2binary:function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(255&a.charCodeAt(c));return b},string2Uint8Array:function(a){if(!e.support.uint8array)throw new Error("Uint8Array is not supported by this browser");for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d<a.length;d++)c[d]=a.charCodeAt(d);return c},uint8Array2String:function(a){if(!e.support.uint8array)throw new Error("Uint8Array is not supported by this browser");for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},string2Blob:function(a){if(!e.support.blob)throw new Error("Blob is not supported by this browser");var b=e.utils.string2Uint8Array(a).buffer;try{return new Blob([b],{type:"application/zip"})}catch(c){}try{var d=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return d.append(b),d.getBlob("application/zip")}catch(c){}throw new Error("Bug : can't construct the Blob.")}};var f=function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(b){for(var c,d,e,f,g,h,i,j="",k=0;k<b.length;)c=b.charCodeAt(k++),d=b.charCodeAt(k++),e=b.charCodeAt(k++),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+a.charAt(f)+a.charAt(g)+a.charAt(h)+a.charAt(i);return j},decode:function(b){var c,d,e,f,g,h,i,j="",k=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<b.length;)f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),h=a.indexOf(b.charAt(k++)),i=a.indexOf(b.charAt(k++)),c=f<<2|g>>4,d=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(c),64!=h&&(j+=String.fromCharCode(d)),64!=i&&(j+=String.fromCharCode(e));return j}}}(),g=Blob&&Blob.constructor&&"download"in document.createElement("a"),h=b.defer(),i=h.promise;return g&&(window.saveAs?h.resolve():i=a.load("bower_components/FileSaver/FileSaver.min.js")),function(){var a=new e;return{add:function(b,c,d){return a.file(b,c,d),this},get:function(b){return a.file(b).data},save:function(a,b){b?d(a,b):d(a,this.getArrayBuffer())},getArrayBuffer:function(){return a.generate({type:"arraybuffer"})}}}}]),!function(a){"use strict";"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=a():"undefined"!=typeof Package?Sortable=a():window.Sortable=a()}(function(){"use strict";function a(a,b){this.el=a,this.options=b=b||{};var d={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1};for(var e in d)!(e in b)&&(b[e]=d[e]);var g=b.group;g&&"object"==typeof g||(g=b.group={name:g}),["pull","put"].forEach(function(a){a in g||(g[a]=!0)}),M.forEach(function(d){b[d]=c(this,b[d]||N),f(a,d.substr(2).toLowerCase(),b[d])},this),b.groups=" "+g.name+(g.put.join?" "+g.put.join(" "):"")+" ",a[F]=b;for(var h in this)"_"===h.charAt(0)&&(this[h]=c(this,this[h]));f(a,"mousedown",this._onTapStart),f(a,"touchstart",this._onTapStart),f(a,"dragover",this),f(a,"dragenter",this),Q.push(this._onDragOver),b.store&&this.sort(b.store.get(this))}function b(a){s&&s.state!==a&&(i(s,"display",a?"none":""),!a&&s.state&&t.insertBefore(s,q),s.state=a)}function c(a,b){var c=P.call(arguments,2);return b.bind?b.bind.apply(b,[a].concat(c)):function(){return b.apply(a,c.concat(P.call(arguments)))}}function d(a,b,c){if(a){c=c||H,b=b.split(".");var d=b.shift().toUpperCase(),e=new RegExp("\\s("+b.join("|")+")\\s","g");do if(">*"===d&&a.parentNode===c||(""===d||a.nodeName.toUpperCase()==d)&&(!b.length||((" "+a.className+" ").match(e)||[]).length==b.length))return a;while(a!==c&&(a=a.parentNode))}return null}function e(a){a.dataTransfer.dropEffect="move",a.preventDefault()}function f(a,b,c){a.addEventListener(b,c,!1)}function g(a,b,c){a.removeEventListener(b,c,!1)}function h(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(/\s+/g," ").replace(" "+b+" ","");a.className=d+(c?" "+b:"")}}function i(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return H.defaultView&&H.defaultView.getComputedStyle?c=H.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b),d[b]=c+("string"==typeof c?"":"px")}}function j(a,b,c){if(a){var d=a.getElementsByTagName(b),e=0,f=d.length;if(c)for(;f>e;e++)c(d[e],e);return d}return[]}function k(a){a.draggable=!1}function l(){K=!1}function m(a,b){var c=a.lastElementChild,d=c.getBoundingClientRect();return b.clientY-(d.top+d.height)>5&&c}function n(a){for(var b=a.tagName+a.className+a.src+a.href+a.textContent,c=b.length,d=0;c--;)d+=b.charCodeAt(c);return d.toString(36)}function o(a){for(var b=0;a&&(a=a.previousElementSibling);)"TEMPLATE"!==a.nodeName.toUpperCase()&&b++;return b}function p(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c),c=void 0},b))}}var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E={},F="Sortable"+(new Date).getTime(),G=window,H=G.document,I=G.parseInt,J=!!("draggable"in H.createElement("div")),K=!1,L=function(a,b,c,d,e,f){var g=H.createEvent("Event");g.initEvent(b,!0,!0),g.item=c||a,g.from=d||a,g.clone=s,g.oldIndex=e,g.newIndex=f,a.dispatchEvent(g)},M="onAdd onUpdate onRemove onStart onEnd onFilter onSort".split(" "),N=function(){},O=Math.abs,P=[].slice,Q=[],R=p(function(a,b,c){if(c&&b.scroll){var d,e,f,g,h=b.scrollSensitivity,i=b.scrollSpeed,j=a.clientX,k=a.clientY,l=window.innerWidth,m=window.innerHeight;if(w!==c&&(v=b.scroll,w=c,v===!0)){v=c;do if(v.offsetWidth<v.scrollWidth||v.offsetHeight<v.scrollHeight)break;while(v=v.parentNode)}v&&(d=v,e=v.getBoundingClientRect(),f=(O(e.right-j)<=h)-(O(e.left-j)<=h),g=(O(e.bottom-k)<=h)-(O(e.top-k)<=h)),f||g||(f=(h>=l-j)-(h>=j),g=(h>=m-k)-(h>=k),(f||g)&&(d=G)),(E.vx!==f||E.vy!==g||E.el!==d)&&(E.el=d,E.vx=f,E.vy=g,clearInterval(E.pid),d&&(E.pid=setInterval(function(){d===G?G.scrollTo(G.scrollX+f*i,G.scrollY+g*i):(g&&(d.scrollTop+=g*i),f&&(d.scrollLeft+=f*i))},24)))}},30);return a.prototype={constructor:a,_dragStarted:function(){t&&q&&(h(q,this.options.ghostClass,!0),a.active=this,L(t,"start",q,t,z))},_onTapStart:function(a){var b=a.type,c=a.touches&&a.touches[0],e=(c||a).target,g=e,h=this.options,i=this.el,l=h.filter;if(!("mousedown"===b&&0!==a.button||h.disabled)&&(e=d(e,h.draggable,i))){if(z=o(e),"function"==typeof l){if(l.call(this,a,e,this))return L(g,"filter",e,i,z),void a.preventDefault()}else if(l&&(l=l.split(",").some(function(a){return a=d(g,a.trim(),i),a?(L(a,"filter",e,i,z),!0):void 0})))return void a.preventDefault();if((!h.handle||d(g,h.handle,i))&&e&&!q&&e.parentNode===i){C=a,t=this.el,q=e,u=q.nextSibling,B=this.options.group,q.draggable=!0,h.ignore.split(",").forEach(function(a){j(e,a.trim(),k)}),c&&(C={target:e,clientX:c.clientX,clientY:c.clientY},this._onDragStart(C,"touch"),a.preventDefault()),f(H,"mouseup",this._onDrop),f(H,"touchend",this._onDrop),f(H,"touchcancel",this._onDrop),f(q,"dragend",this),f(t,"dragstart",this._onDragStart),J||this._onDragStart(C,!0);try{H.selection?H.selection.empty():window.getSelection().removeAllRanges()}catch(m){}}}},_emulateDragOver:function(){if(D){i(r,"display","none");var a=H.elementFromPoint(D.clientX,D.clientY),b=a,c=" "+this.options.group.name,d=Q.length;if(b)do{if(b[F]&&b[F].groups.indexOf(c)>-1){for(;d--;)Q[d]({clientX:D.clientX,clientY:D.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode);i(r,"display","")}},_onTouchMove:function(a){if(C){var b=a.touches?a.touches[0]:a,c=b.clientX-C.clientX,d=b.clientY-C.clientY,e=a.touches?"translate3d("+c+"px,"+d+"px,0)":"translate("+c+"px,"+d+"px)";D=b,i(r,"webkitTransform",e),i(r,"mozTransform",e),i(r,"msTransform",e),i(r,"transform",e),a.preventDefault()}},_onDragStart:function(a,b){var c=a.dataTransfer,d=this.options;if(this._offUpEvents(),"clone"==B.pull&&(s=q.cloneNode(!0),i(s,"display","none"),t.insertBefore(s,q)),b){var e,g=q.getBoundingClientRect(),h=i(q);r=q.cloneNode(!0),i(r,"top",g.top-I(h.marginTop,10)),i(r,"left",g.left-I(h.marginLeft,10)),i(r,"width",g.width),i(r,"height",g.height),i(r,"opacity","0.8"),i(r,"position","fixed"),i(r,"zIndex","100000"),t.appendChild(r),e=r.getBoundingClientRect(),i(r,"width",2*g.width-e.width),i(r,"height",2*g.height-e.height),"touch"===b?(f(H,"touchmove",this._onTouchMove),f(H,"touchend",this._onDrop),f(H,"touchcancel",this._onDrop)):(f(H,"mousemove",this._onTouchMove),f(H,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,150)}else c&&(c.effectAllowed="move",d.setData&&d.setData.call(this,c,q)),f(H,"drop",this);setTimeout(this._dragStarted,0)},_onDragOver:function(a){var c,e,f,g=this.el,h=this.options,j=h.group,k=j.put,n=B===j,o=h.sort;if(q&&(void 0!==a.preventDefault&&(a.preventDefault(),!h.dragoverBubble&&a.stopPropagation()),B&&!h.disabled&&(n?o||(f=!t.contains(q)):B.pull&&k&&(B.name===j.name||k.indexOf&&~k.indexOf(B.name)))&&(void 0===a.rootEl||a.rootEl===this.el))){if(R(a,h,this.el),K)return;if(c=d(a.target,h.draggable,g),e=q.getBoundingClientRect(),f)return b(!0),void(s||u?t.insertBefore(q,s||u):o||t.appendChild(q));if(0===g.children.length||g.children[0]===r||g===a.target&&(c=m(g,a))){if(c){if(c.animated)return;v=c.getBoundingClientRect()}b(n),g.appendChild(q),this._animate(e,q),c&&this._animate(v,c)}else if(c&&!c.animated&&c!==q&&void 0!==c.parentNode[F]){x!==c&&(x=c,y=i(c));var p,v=c.getBoundingClientRect(),w=v.right-v.left,z=v.bottom-v.top,A=/left|right|inline/.test(y.cssFloat+y.display),C=c.offsetWidth>q.offsetWidth,D=c.offsetHeight>q.offsetHeight,E=(A?(a.clientX-v.left)/w:(a.clientY-v.top)/z)>.5,G=c.nextElementSibling;K=!0,setTimeout(l,30),b(n),p=A?c.previousElementSibling===q&&!C||E&&C:G!==q&&!D||E&&D,p&&!G?g.appendChild(q):c.parentNode.insertBefore(q,p?G:c),this._animate(e,q),this._animate(v,c)}}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();i(b,"transition","none"),i(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)"),b.offsetWidth,i(b,"transition","all "+c+"ms"),i(b,"transform","translate3d(0,0,0)"),clearTimeout(b.animated),b.animated=setTimeout(function(){i(b,"transition",""),i(b,"transform",""),b.animated=!1},c)}},_offUpEvents:function(){g(H,"mouseup",this._onDrop),g(H,"touchmove",this._onTouchMove),g(H,"touchend",this._onDrop),g(H,"touchcancel",this._onDrop)},_onDrop:function(b){var c=this.el,d=this.options;clearInterval(this._loopId),clearInterval(E.pid),g(H,"drop",this),g(H,"mousemove",this._onTouchMove),g(c,"dragstart",this._onDragStart),this._offUpEvents(),b&&(b.preventDefault(),!d.dropBubble&&b.stopPropagation(),r&&r.parentNode.removeChild(r),q&&(g(q,"dragend",this),k(q),h(q,this.options.ghostClass,!1),t!==q.parentNode?(A=o(q),L(q.parentNode,"sort",q,t,z,A),L(t,"sort",q,t,z,A),L(q,"add",q,t,z,A),L(t,"remove",q,t,z,A)):(s&&s.parentNode.removeChild(s),q.nextSibling!==u&&(A=o(q),L(t,"update",q,t,z,A),L(t,"sort",q,t,z,A))),a.active&&L(t,"end",q,t,z,A)),t=q=r=u=s=v=w=C=D=x=y=B=a.active=null,this.save())},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?(this._onDragOver(a),e(a)):("drop"===b||"dragend"===b)&&this._onDrop(a)},toArray:function(){for(var a,b=[],c=this.el.children,e=0,f=c.length;f>e;e++)a=c[e],d(a,this.options.draggable,this.el)&&b.push(a.getAttribute("data-id")||n(a));return b},sort:function(a){var b={},c=this.el;this.toArray().forEach(function(a,e){var f=c.children[e];d(f,this.options.draggable,c)&&(b[a]=f)},this),a.forEach(function(a){b[a]&&(c.removeChild(b[a]),c.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return d(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;return void 0===b?c[a]:void(c[a]=b)},destroy:function(){var a=this.el,b=this.options;M.forEach(function(c){g(a,c.substr(2).toLowerCase(),b[c])}),g(a,"mousedown",this._onTapStart),g(a,"touchstart",this._onTapStart),g(a,"dragover",this),g(a,"dragenter",this),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),Q.splice(Q.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},a.utils={on:f,off:g,css:i,find:j,bind:c,is:function(a,b){return!!d(a,b,a)},throttle:p,closest:d,toggleClass:h,dispatchEvent:L,index:o},a.version="1.1.1",a.create=function(b,c){return new a(b,c)},a}),angular.module("moonui",["color"]).filter("zpad",function(){return function(a,b){var c=/\-/.test(a);if(b=parseInt(b,10),isNaN(b))return a;a=String(a);var d,e=a.replace(/\.|\-/g,"").length;for(d=0;b-e>d;d+=1)a="0"+a;return c&&(a="-"+a.replace(/\-/g,"")),a}}).directive("miEditable",function(){return{priority:50,require:"ngModel",link:function(a,b,c,d){b.attr("contenteditable",!0),b.bind("blur",function(){a.$apply(function(){b.html(b.text()),d.$setViewValue(b.text())})}),a.$watch(function(){return d.$viewValue},function(){b.html(d.$viewValue)})}}}).directive("miPopup",function(){return{restrict:"A",require:"^?miAbsorbClicks",link:function(a,b,c,d){var e,f,g=angular.element(b[0]).next(),h=function(){g.attr("style","opacity: 0"),setTimeout(function(){g.addClass("hidden"),g.removeAttr("style")},500)},i=function(){g.removeClass("hidden"),e=!0},j=function(){clearTimeout(f),f=setTimeout(function(){e||h(),e=!1},10)};d&&d.addCallback&&d.addCallback(j),angular.element(document).bind("click",j),h(),g.bind("click",function(a){var b=a.target.tagName.toUpperCase();a.stopPropagation(),("A"===b||"BUTTON"===b||"I"===b)&&(h(),"A"!==a.target.tagName.toUpperCase()&&a.preventDefault())}),"focus"===c.miPopup?!function(){var a,c,d,f;a=b.find("input"),a.length||(a=b),a.bind("focus",i),a.bind("click",function(){e||(g.toggleClass("hidden"),e=!0)}),a.bind("blur",function(a){var b,i,j=a.relatedTarget;if(!j)return e&&h(),void 0;if(f||!function(){var a,b,c,d,e=[];for(f=g.find("button"),d=f.length,b=0;d>b;b+=1)e[b]=f[b];for(a=g.find("a"),d+=a.length,b=f.length,c=0;d>b;b+=1,c+=1)e[b]=a[c];f=e}(),i=f.length,c||(c=f[0]),d||(d=f[i-1],angular.element(d).bind("blur",function(a){var b=a.relatedTarget;b!==f[i-2]&&b!==c&&h()})),f){for(b=0;i>b;b+=1)if(j===f[b])return;b===i&&h()}})}():b.bind("click",function(){g.toggleClass("hidden"),e=!0}),b.bind("keydown",function(a){13===a.which?(g.toggleClass("hidden"),e=!0):27===a.which&&h()})}}}).directive("miNumber",["$filter",function(a){return{restrict:"E",scope:{radix:"&",min:"&",max:"&",def:"&",zpad:"&",validator:"&",modelVal:"=model"},template:'<input type="text" ng-model="viewVal" />',link:function(b,c,d){var e,f,g,h=a("zpad"),i=Number(b.radix())||10,j=Number(b.min()),k=Number(b.max()),l=Number(b.zpad())||0,m=!1,n=Number(b.def())||0,o=c.children("input"),p=10===i,q=d.invalidClass,r=b.validator&&b.validator();2>i&&(i=2);var s=function(a,c,g){var m=!1,s=b.viewVal;if(p)try{s=b.$eval(b.viewVal)}catch(t){s=n}else s=parseInt(s,i);isNaN(s)&&(g?(m=!0,s=b.viewVal):s=n),m||isNaN(a)||(s+=parseInt(a,10)),!isNaN(k)&&s>k?g?m=!0:s=k:!isNaN(j)&&j>s&&(g?m=!0:s=j),!m&&r&&(r(s,n)||(g?m=!0:s=n)),m&&q?(o.addClass(q),o[0].setCustomValidity("invalid")):q&&(o.removeClass(q),o[0].setCustomValidity("")),b.$apply(function(){b.viewVal=h(s.toString(i),l),d.charInput&&!m&&f.val(String.fromCodePoint(s))}),g||(isNaN(c)?b.$apply(function(){b.modelVal=n=s,e=setTimeout(function(){b.modelVal!==s&&b.$apply(function(){b.modelVal=n=s})},300)}):(clearTimeout(e),e=setTimeout(function(){b.$apply(function(){b.modelVal=n=s})},c)))};o.bind("keydown",function(a){var b;40===a.which?(b=-1,a.preventDefault()):38===a.which&&(b=1,a.preventDefault()),a.shiftKey&&(b*=i),b&&s(b,0,q)}).bind("change",function(){s()}).bind("focus",function(){m=!0}).bind("blur",function(){m=!1,q&&s()}).bind("mousewheel",function(a){if(a.stopPropagation(),m){var b=a.wheelDeltaY>0?1:-1;a.shiftKey&&(b*=i),a.preventDefault(),s(b,500,q)}}).bind("input",function(){q&&s(0/0,0,q)}),isNaN(b.modelVal)||(n=b.modelVal),b.modelVal=n,b.viewVal=h(n,l),b.$watch("modelVal",function(a){isNaN(a)||(b.viewVal=h(a.toString(i),l),d.charInput&&f.val(String.fromCodePoint(a)),n=a)}),d.charInput&&(f=angular.element('<input type="text" maxlength="1" />'),f.val(String.fromCodePoint(n)),g=function(a){r(a,n)&&(b.$apply(function(){n=b.modelVal=a,b.viewVal=h(a.toString(i),l)}),f[0].setCustomValidity(""),q&&f.removeClass(q))},f.bind("input",function(){var a;a=f.val().codePointAt(0),document.activeElement===f[0]&&r&&(a&&r(a,n)?g(a):(f[0].setCustomValidity("invalid"),q&&f.addClass(q)))}).bind("change",function(){var a=f.val();return a&&f[0].validity.valid?(a=a.codePointAt(0),n!==a&&g(a),void 0):(f.val(String.fromCodePoint(b.modelVal)),f[0].setCustomValidity(""),q&&f.removeClass(q),void 0)}).bind("click",function(){f[0].select()}),c.parent().after(angular.element('<label class="'+d.charInput+'"></label>').append(f)))}}}]).directive("miSelectAll",function(){return{link:function(a,b){b.bind("focus",function(){setTimeout(function(){b[0].select()})})}}}).directive("miPresets",function(){return{restrict:"E",transclude:!0,template:'<label mi-popup="focus"><mi-number min="min" max="max" def="def" zpad="zpad" model="val"></mi-number><span ng-transclude></span></label><ul><li ng-repeat="p in presets"><button type="button" ng-click="update(p)" value="{{p}}">{{p}}</button></li></ul>',scope:{val:"=model",min:"=",max:"=",def:"=",zpad:"=",getPresets:"&presets"},link:function(a,b){a.update=function(b){a.val=b};var c=function(){var b,c=a.getPresets();for(a.presets=[],b=0;b<c.length;b+=1)c[b]>=a.min&&c[b]<=a.max&&a.presets.push(c[b]);a.$apply()};b.bind("click",c),b.find("input").bind("focus",c)}}}).directive("miStyle",function(){return{restrict:"E",link:function(a,b){var c,d=function(){return c=b.html()},e=angular.element("<style></style>");b.after(e),e=e[0],b.css("display","none"),a.$watch(d,function(){e.stylesheet?e.stylesheet.cssText=c:e.innerHTML=c})}}}).directive("miLink",function(){return{restrict:"E",replace:!0,transclude:!0,template:'<span><span ng-show="!href" ng-transclude></span><a ng-show="href" href="{{href}}" ng-transclude></a></span>',scope:{href:"@"}}}).directive("miColorPicker",["color","$timeout",function(a,b){var c=0;return{restrict:"E",replace:!0,templateUrl:"views/colorpicker.html",scope:{num:"=color",resultId:"@"},link:function(d,e){function f(){n[0].setAttribute("stop-color","hsl("+q.h+", 0%, "+q.l+"%)"),n[1].setAttribute("stop-color","hsl("+q.h+", 100%, "+q.l+"%)"),l[0].setAttribute("stop-color","hsl("+q.h+", "+q.s+"%, 0%)"),l[1].setAttribute("stop-color","hsl("+q.h+", "+q.s+"%, 50%)"),l[2].setAttribute("stop-color","hsl("+q.h+", "+q.s+"%, 100%)"),m||(m=document.getElementById(d.resultId)),m&&m.setAttribute("style","background-color: hsl("+q.h+", "+q.s+"%, "+q.l+"%)")}function g(){var b=a(d.num).toHSL();(b.h!==q.h||b.s!==q.s||b.l!==q.l)&&(d.num=a(q).toNumber())}function h(){d.hsl={h:q.h,s:q.s,l:q.l}}function i(){var a,b,c=e.find("input");if(c.length)for(a=0;a<c.length;a+=1)b=c[a].getAttribute("id"),/hue/.test(b)?c[a].value=q.h:/saturation/.test(b)?c[a].value=q.s:/lightness/.test(b)&&(c[a].value=q.l)}function j(a){clearTimeout(p),p=setTimeout(function(){var c=a.target.getAttribute("id");if(c==="hue"+d.id)q.h=a.target.value;else if(c==="saturation"+d.id)q.s=a.target.value;else{if(c!=="lightness"+d.id)return;q.l=a.target.value}f(),b.cancel(o),o=b(function(){g(),h()},128)},16)}var k,l,m,n,o,p,q={h:0,s:0,l:0};d.id=c,c+=1,function(){var a,b=e.find("linearGradient");for(k=0;k<b.length;k+=1)a=angular.element(b[k]),"satGrad"===a.attr("class")?n=a.children():"litGrad"===a.attr("class")&&(l=a.children());f()}(),q=a(d.num).toHSL(),h(),i(),e[0].addEventListener("input",j,!1),e[0].addEventListener("change",j,!1),d.$watch("num",function(){b.cancel(o),o=b(function(){var b=a(d.num).toHSL();0===b.h&&360===q.h&&(b.h=q.h),(100===q.l||0===q.l)&&(b.s=q.s),q=b,h(),f(),i()},256)}),d.$watch("hsl",function(){b.cancel(o),o=b(function(){q.h=d.hsl.h,q.s=d.hsl.s,q.l=d.hsl.l,g(),f(),i()},256)},!0)}}}]).directive("miFileOver",function(){return function(a,b){var c,d,e,f=!1;b.on("dragover",function(a){a.stopPropagation(),a.preventDefault();try{if(e=a.dataTransfer.types,e.indexOf)f=-1!==e.indexOf("Files");else for(c=0;c<e.length;c+=1)"Files"===a.dataTransfer.types[c]&&(f=!0);f?(b.addClass("miFileOver"),clearTimeout(d),d=setTimeout(function(){b.removeClass("miFileOver")},1e3)):b.removeClass("miFileOver")}catch(a){}}),b.on("drop",function(a){a.stopPropagation(),b.removeClass("miFileOver")})}}).directive("miFileZone",function(){return{scope:{onOpen:"&"},link:function(a,b,c){var d=c.dragClass||"dragged",e=c.arrayBufferIf?new RegExp(c.arrayBufferIf):!1,f=new RegExp(c.typeRegex);b.on("dragover",function(a){b.addClass(d),a.dataTransfer.dropEffect="copy"}),b.on("dragleave",function(){b.removeClass(d)}),b.on("drop",function(b){var c,d,g=0,h=new FileReader,i=[],j=function(b){d=c[g].type||c[g].name,f.test(d)&&i.push({file:b.target.result,type:d,name:c[g].name}),g+=1,g===c.length?a.$apply(function(){a.onOpen({files:i.reverse()})}):(h=new FileReader,h.onload=j,e&&e.test(d)?h.readAsArrayBuffer(c[g]):h.readAsText(c[g]))};b.preventDefault(),c=b.dataTransfer.files,h.onload=j,d=c[g].type||c[g].name,e&&e.test(d)?h.readAsArrayBuffer(c[g]):h.readAsText(c[g])})}}}).directive("miFile",function(){return{restrict:"E",scope:{onOpen:"&",focused:"="},template:'<input type="file" multiple />',link:function(a,b,c){var d=b.children("input"),e=c.arrayBufferIf?new RegExp(c.arrayBufferIf):!1,f=new RegExp(c.typeRegex);d[0].addEventListener("change",function(b){var c,g=b.target.files,h=0,i=new FileReader,j=[],k=function(b){c=g[h].type||g[h].name,f.test(c)&&j.push({file:b.target.result,type:c,name:g[h].name}),h+=1,h===g.length?(a.$apply(function(){a.onOpen({files:j.reverse()})}),d[0].value=""):(i=new FileReader,i.onload=k,e&&e.test(c)?i.readAsArrayBuffer(g[h]):i.readAsText(g[h]))};i.onload=k,c=g[h].type||g[h].name,e&&e.test(c)?i.readAsArrayBuffer(g[h]):i.readAsText(g[h])},!1),c.focused&&d.bind("focus",function(){a.$apply(function(){a.focused=!0})}).bind("blur",function(){a.$apply(function(){a.focused=!1})})}}}).directive("miBoxSelector",function(){return{restrict:"E",scope:{map:"=",mode:"@",onApply:"&"},transclude:!0,template:"<div ng-transclude></div>",link:function(a,b,c){function d(){try{g.destroy()}catch(c){}"move"===a.mode&&(g=new Sortable(b.children()[0],{ghostClass:o,onUpdate:function(a){var b,c;b=parseInt(angular.element(a.item)[0].getAttribute("data-idx"),10);try{c=parseInt(angular.element(a.item).next()[0].getAttribute("data-idx"),10)}catch(a){c=0/0}c>b&&(c-=1),r=[b,c],clearTimeout(h),h=setTimeout(function(){u("move")},300)}}))}var e,f,g,h,i=[],j=!1,k=!1,l={},m={},n=0/0,o=c.boxClass||"mi-boxed",p={},q=c.selectedClass||"mi-selected",r=[],s=[],t=0,u=function(b){a.$apply(function(){a.onApply({selection:r,mode:b}),r=[]})},v=function(a){return a.offsetLeft<=p.x2&&a.offsetLeft+a.offsetWidth>=p.x1&&a.offsetTop<=p.y2&&a.offsetTop+a.offsetHeight>=p.y1?!0:a.offsetTop>p.y2||p.y1>a.offsetHeight+a.offsetTop?0/0:!1},w=function(){var a,c,d,e=b.find("mi-box"),f=e.length,g=[],h=1;if(!f)return g;for(a=0;f>a;a+=1)e[a].offsetHeight&&g.push({el:e[a],idx:a});for(e=g,g=[],f=e.length,c=e[0].offsestTop,p.x1=Math.min(l.x,m.x),p.x2=Math.max(l.x,m.x),p.y1=Math.min(l.y,m.y),p.y2=Math.max(l.y,m.y),a=n||0;f>a;a+=1)if(t+=1,1===h&&e[a].el.offsetTop>c&&(h=a),d=v(e[a].el))isNaN(n)&&(n=a),g.push({index:e[a].idx,element:angular.element(e[a].el)});else{if(isNaN(d)&&!isNaN(n))break;a+=h-1}for(a=n-1||-1;a>-1;a-=1)if(d=v(e[a].el))g.push({index:e[a].idx,element:angular.element(e[a].el)});else if(isNaN(d))break;return g},x=function(){var c,e,f,g,h=a.map,i=b.find("mi-box"),j=i.length,k=[];if(!j||!h||j!==h.length)return 500>t&&(t+=1,setTimeout(x,0)),void 0;if(d(),t=0,f=JSON.stringify(h),JSON.stringify(s)!==f){for(c=0;j>c;c+=1)JSON.stringify(s[c])!==JSON.stringify(h[c])&&k.push(c);for(j=k.length,c=0;j>c;c+=1){if(e=k[c],g=angular.element(i[e]),h[e].id+""!==g.attr("data-id"))return setTimeout(x,300),void 0;h[e].order?g.addClass(q):g.removeClass(q)}s=JSON.parse(f)}};b.bind("mousedown",function(b){return"move"!==a.mode?(n=0/0,j=!0,l.x=b.pageX,l.y=b.pageY,b.preventDefault(),!1):void 0}),document.body.addEventListener("mouseup",function(b){var c,d,g,l,m,p=a.mode;if(k=!1,j=!1,n=0/0,"move"!==a.mode){if(i.length){for(d=0,l=i.length;l>d;d+=1)c=i[d],c.element.removeClass(o),"delete"===p?c.element.removeClass(q).remove():"select"===p&&c.element.toggleClass(q),m=c.index,g=r.indexOf(m),g>0?r.splice(g,1):r.push(c.index);i=[],clearTimeout(h),h=setTimeout(function(){u(p)},300)}for(e={x:b.pageX,y:b.pageY},f=angular.element(b.target),d=0;!f.is("mi-box")&&6>d;)f=f.parent(),d+=1;try{f=f[0]}catch(b){f=!1}}},!1),b.bind("mouseup",function(c){var d,g,j,k,p,s,t;if(!i.length&&"move"!==a.mode){for(p=a.mode,g="delete"===p,m.x=c.pageX,m.y=c.pageY,d=w(),n=0/0,j=d.length,1===j&&e&&c.shiftKey&&(l=e,d=w(),j=d.length),b.find("mi-box").removeClass(o),k=0;j>k;k+=1)(g||2>j||d[k].element&&d[k].element[0]!==f)&&(g&&!c.shiftKey?d[k].element.removeClass(q).remove():"select"===p&&d[k].element.toggleClass(q),s=d[k].index,t=r.indexOf(s),t>0?r.splice(t,1):r.push(d[k].index+(g&&!c.shiftKey?r.length:0)));clearTimeout(h),h=setTimeout(function(){u(p)},300)}}),b.bind("mousemove",function(c){if("move"!==a.mode){var d;if(!j)return;for(k=!0,clearTimeout(h),m.x=c.pageX,m.y=c.pageY,i=w(),b.find("mi-box").removeClass(o),d=0;d<i.length;d+=1)i[d].element.addClass(o)}}),window.addEventListener("scroll",function(){clearTimeout(h);var b=a.mode;r.length&&(h=setTimeout(function(){u(b)},300))},!1),a.$watch("map",function(){x()},!0),a.$watch("mode",function(){try{g.destroy()}catch(b){}"move"===a.mode&&d()}),x()}}}).directive("miTags",function(){return{priority:2,require:"ngModel",link:function(a,b,c,d){function e(){b.val(d.$modelValue),f&&b.html(d.$modelValue)}var f=b.is("span");d.$parsers.push(function(a){var b=[],c=a;return c?(c=c.replace(/\s*,\s*/g,",").replace(/,+/g,", ").trim().replace(/^,+|,+$/,""),c=c.split(", "),c.forEach(function(a){a&&-1===b.indexOf(a)&&b.push(a)
}),b.join(", ")):""}),f=b.is("span"),d.$render=e,b.bind("change, blur",function(){d.$setViewValue(f?b.html():b.val()),e()})}}}).directive("miUnique",function(){return{priority:5,require:"ngModel",link:function(a,b,c,d){var e=a[c.miUnique]||{},f=!b[0].hasAttribute("contenteditable"),g="string"==typeof c.miTags;d.$parsers.push(function(h){var i,j,k,l,m,n,o=[];if(h=angular.element("<div></div>").html(h).text(),g){for(n in e)e.hasOwnProperty(n)&&(o=o.concat(e[n]));for(m=h.split(/,\s*/),n=e[a.$id]||[],k=m.length,i=0;k>i;i+=1)if(-1!==o.indexOf(m[i])&&-1===n.indexOf(m[i])){j=!1;break}i===k&&(j=!0)}else{for(n in e)n!==a.$id&&e.hasOwnProperty(n)&&o.push(e[n]);l=h.replace(/\s*/g,""),j=-1===o.indexOf(l)}return j?(d.$setValidity("unique",!0),c.miInvalidClass&&b.removeClass(c.miInvalidClass),h):(document.activeElement===b[0]?(d.$setValidity("unique",!1),c.miInvalidClass&&b.addClass(c.miInvalidClass)):f?b.val(d.$modelValue):b.html(d.$modelValue),d.$modelValue)}),b.bind("change, blur",function(){d.$setViewValue(f?b.val():b.text()),d.$setValidity("unique",!0),b.removeClass(c.miInvalidClass)}),a.$watch(function(){return d.$modelValue},function(b){b?e[a.$id]=g?b.split(/,\s*/):b.replace(/\s*/g,""):delete e[a.$id]})}}}).directive("miTooltip",["$parse",function(a){var b,c=600,d=c;return{link:function(e,f,g){var h,i=f[0],j=a(g.miTooltip)();f.bind("mouseenter",function(){var a=function(){var a,b,c,e;a=i.getBoundingClientRect(),h=angular.element("<div></div>"),h.addClass(j.class||"tooltip"),h.text(j.text),angular.element(document.body).append(h),c=h[0].getBoundingClientRect(),e=j.hasOwnProperty("marginTop")?a.top+a.height+(Number(j.marginTop)||0):a.top-a.height-(Number(j.marginBottom)||0),b=j.hasOwnProperty("marginRight")?a.left+a.width-c.width-Number(j.marginRight):a.left+a.width/2-c.width/2,h.css({left:b+"px",top:e+"px"}),d=0};clearTimeout(b),d?b=setTimeout(a,d):a()}).bind("mouseleave",function(a){var e;clearTimeout(b),h&&h.remove(),e=a.toElement,e&&(0===d&&e.hasAttribute("mi-tooltip")||(d=c))}).bind("click",function(){clearTimeout(b),d=c,h&&h.remove()})}}}]).directive("miAbsorbClicks",function(){return{controller:["$scope",function(a){a.callbacks=[],this.addCallback=function(b){a.callbacks.push(b)}}],link:function(a,b){var c,d;b.bind("click",function(b){for(b.stopPropagation(),d=a.callbacks.length,c=0;d>c;c+=1)a.callbacks[c]()})}}}).directive("miFocusWhen",function(){return{scope:!0,link:function(a,b,c){var d;a.$watch(function(){return c.miFocusWhen},function(){clearTimeout(d),d=setTimeout(function(){try{"true"===c.miFocusWhen&&(b.is("input, button")?b[0].focus():(b=b.find("input"),b.length&&b[0].focus()))}catch(a){}},100)})}}}).directive("miGrid",["template",function(a){return{restrict:"E",scope:{left:"@",top:"@",width:"@",height:"@",gridSize:"@"},link:function(b,c){function d(a,b,c,d,h){var i,j=[],k=c/d*h,l=[];if(0===c||0===d)return"";for(i=0;k>i;i+=1)l.push(g.fillup({x:Math.round(i/k*c)}));for(l.push(g.fillup({x:Math.round(c)})),i=0;h>i;i+=1)j.push(f.fillup({y:Math.round(i/h*d)}));return j.push(f.fillup({y:Math.round(d)})),e.fillup({left:a,top:b,width:c,height:d,hLines:j.join(""),vLines:l.join("")})}var e=a('<div class="miGrid" style="left: {{left}}px; top: {{top}}px; width: {{width}}px; height: {{height}}px;">{{hLines}}{{vLines}}</div>'),f=a('<div class="hLine" style="top: {{y}}px"></div>'),g=a('<div class="vLine" style="left: {{x}}px"></div>');b.$watch(function(){return b.left+b.top+b.width+b.height+b.gridSize},function(){c.html(d(Number(b.left),Number(b.top),Number(b.width),Number(b.height),Number(b.gridSize))||"")})}}}]).directive("miVisibleBox",function(){return{link:function(a,b,c){function d(){var b=a[c.miVisibleBox];b&&(b.processing=!0),50>g?(setTimeout(function(){e()},300),g+=1):g=0}function e(){var b,e,f;try{if(b=h.getBoundingClientRect(),!b.width||!b.height)return;e=h.offsetLeft,isNaN(e)&&(f=h.parentElement||h.parentNode,e=(f.offsetWidth-b.width)/2),a[c.miVisibleBox]={width:Math.round(b.width),height:Math.round(b.height),left:Math.round(e),top:0,processing:!1},setTimeout(function(){a.$apply()},100)}catch(g){return d(),void 0}}var f,g=0,h=b[0];a.$watch(function(){return b.attr("viewBox")+b.attr("style")+c.miVisibleBoxWatch},function(){e()}),window.addEventListener("resize",function(){clearTimeout(f),f=setTimeout(function(){e(),a.$apply()},500)},!1)}}}).directive("miTrack",["$parse",function(a){return{link:function(b,c,d){var e=["_trackEvent"],f=a(d.miTrack)();f&&window._gaq&&"string"==typeof f.event&&c.bind(f.event,function(){f.hasOwnProperty("category")&&e.push(f.category),f.hasOwnProperty("action")&&e.push(f.action),f.hasOwnProperty("label")&&e.push(f.label),f.hasOwnProperty("value")&&e.push(f.value),f.hasOwnProperty("noninteraction")&&e.push(f.noninteraction),e.length>1&&window._gaq.push(e)})}}}]),"#library"===location.hash&&(location.hash="#/select/library"),angular.module("icomoonApp",["ui.router","storage","svg","font","tmpl","color","swatch","file","moonui","cloud","search"]).config(["$stateProvider","$urlRouterProvider","$compileProvider",function(a,b,c){b.otherwise("/select"),c.debugInfoEnabled(!1),c.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|chrome-extension):|data:image\//),a.state("select",{url:"/select",templateUrl:"views/main.html",controller:"MainCtrl",resolve:{project:["session","$q","storage","message",function(a,b,c,d){var e,f=b.defer(),g=a("icomoon"),h=function(a){a.totalSize!==a.loaded&&d.setMessage(a.loaded/a.totalSize)};return c.load("currentProject",function(b){b||(b=-1),g.load("icomoon-lib/presets.json").then(function(d){function i(a){f.resolve(a)}var j,k;for(0>b&&!isNaN(d.currentProject)&&(b=d.currentProject),d.projects||(d={currentProject:-1,projects:[]}),j=0;j<d.projects.length;j+=1)if(d.projects[j].created===b)return e=a(b),e.downloadProgressHandler=e.downloadProgressHandler||h,e.load(d.projects[j].uri).then(i,function(a){return"no such project"===a?(location.hash="#/projects",void 0):void 0}),f.promise;j===d.projects.length&&(d.projects[b]||(b=0),b<d.projects.length&&b>-1&&d.projects[b].iconSets?(k=(new Date).getTime(),d.projects[b].metadata.created=k,a(k).quickSave(d.projects[b]).then(function(a){d.projects.splice(b,1,a.metadata),b=k,d.time+=1,f.resolve(a),f.promise.then(function(){g.quickSave(d)})})):j>0?(b=d.projects[b].created,e=a(b),e.downloadProgressHandler=e.downloadProgressHandler||h,e.load().then(i)):(b=(new Date).getTime(),d.projects=[{created:b,name:"Untitled Project 1",lastOpened:0}],g.quickSave(d),k={metadata:d.projects[0],iconSets:[]},a(b).quickSave(k).then(function(){f.resolve(k)}))),c.save("currentProject",b)})}),f.promise}]}}).state("select.font",{url:"/font",templateUrl:"views/font.html",controller:"FontCtrl"}).state("select.image",{url:"/image",templateUrl:"views/image.html",controller:"ImageCtrl"}).state("select.library",{url:"/library",templateUrl:"views/lib.html",controller:"LibCtrl",resolve:{iconSets:["$q","$http",function(a,b){var c=a.defer();return b.get("icomoon-lib/library.json").then(function(a){c.resolve(a.data)}),c.promise}]}}).state("projects",{url:"/projects",templateUrl:"views/projects.html",controller:"ProjectsCtrl",resolve:{}})}]),angular.module("icomoonApp").controller("MsgCtrl",["$scope","message",function(a,b){a.message=b,b.$apply=function(){try{a.$apply()}catch(b){}}}]),angular.module("icomoonApp").factory("session",["$q","$http","$rootScope","$timeout","storage","cloud","scriptLoader","message",function(a,b,c,d,e,f,g){function h(){l=!1,e.clear(function(){location.reload()})}var i,j={},k={},l={},m=0;return f.hasCloudAccess().then(function(){i=g.load("components/jsondiffpatch/jsondiffpatch.min.js"),m=3e3,i.then(function(){jsondiffpatch.config.objectHash=function(a){return a.id||0}})}),function(g){function n(b){function c(){(l[g]===!0||"pending"===l[g])&&800>e?(setTimeout(c,300),e+=1):d()}function d(){l[g]=!0,f.hasCloudAccess(!0,g).then(function(a){var c=a.time||-1;b&&(b.time=b.time||q&&q.time||0),!b||c>b.time||!isNaN(b.uid)&&b.uid!==a.uid?f.getSession({id:g,progress:v.downloadProgressHandler}).then(function(c){c&&(c.uid=a.uid),c||(b?(b.uid=a.uid,i.resolve()):"icomoon"!==g&&(i.reject("no such project"),l[g]=!1)),i.resolve(c)},function(){b.uid=a.uid,i.resolve()}):c!==b.time?(b.uid=a.uid,i.resolve()):(b.uid=a.uid,i.resolve(b))},function(a){a.noAccess&&b&&b.premium&&(l[g]=!1,h()),a&&b&&(b.uid=a.uid),i.resolve()})}var e=0,i=a.defer();return c(),i.promise.then(function(){l[g]=!1,k[g]=!1}),i.promise}var o,p,q,r,s,t,u,v={};return j[g]?j[g]:(j[g]=v,v.load=function(d){function h(a){n(a).then(function(c){c||a?(p=c||a,c?(q=JSON.parse(JSON.stringify(c)),i.resolve(c)):i.resolve(a)):b.get(d).then(function(a){p=a.data,i.resolve(p)}),i.promise.then(function(a){f.hasCloudAccess().then(function(){a.premium=!0,v.quickSave(a)})})},function(a){"no such project"===a&&i.reject(a)})}var i=a.defer();return p?h(p):e.load(g,function(a){h(a),c.$apply()}),i.promise},v.save=function(b,c){var j;return c=c||m,r||(r=a.defer()),o?r.resolve():(d.cancel(s),s=d(function(){function a(a){d.cancel(u),u=d(function(){m()},a||1e3)}function m(){f.hasCloudAccess().then(function(){return i}).then(function(){return"offline"===l[g]&&(l[g]=!1),l[g]&&"failed"!==l[g]&&"pending"!==l[g]?(a(),void 0):(d.cancel(t),t=d(function(){function b(){p.time=j,n=p.time,f.storeSession({session:m,id:g}).then(c,function(){l[g]="failed",k[g]="failed",a()})}function c(a){var c;a.error?(/Unauthed/.test(a.error)&&(l[g]=!1,h()),c=!0):n!==a.time&&(c=!0),c?b():(q=JSON.parse(m),l[g]=!1,k[g]=!1)}var d,i,m,n,o,r=!1;if(l[g]=!0,!q)return p.time=j,m=JSON.stringify(p),b(),void 0;d=jsondiffpatch.diff(q,p);for(o in d)if(d.hasOwnProperty(o)&&"time"!==o){r=!0,j=j||f.getTime(),p.time=j,d.time=[q.time,j];break}return r?d=JSON.stringify(d):(d=!1,p.time=q.time),m=JSON.stringify(p),n=p.time,d?(i=JSON.stringify(d),i.length<m.length?f.storeSession({diff:JSON.stringify(d),id:g}).then(c,function(){l[g]="failed",k[g]="failed",a()}):b(),void 0):(q=JSON.parse(m),e.save(g,p),l[g]=!1,k[g]=!1,void 0)},c/3),void 0)}),b.time=b.time||f.getTime(),e.save(g,b,function(){r&&r.resolve(b),r=!1})}b=b||p,p=b,f.hasCloudAccess(!0,g).then(function(a){p.uid&&-1!==p.uid&&p.uid!==a.uid||q&&q.time&&q.time<a.time||"failed"===l[g]?(o=!0,l[g]=!1,k[g]=!1,r&&r.resolve(),p.uid!==a.uid?h():location.reload()):(j=b.time=f.getTime(),p.uid=a.uid)},function(a){a.noAccess&&p.premium?(o=!0,h()):(p.uid=a.uid,l[g]="offline")}).finally(function(){o||m()})},c),o||(l[g]="pending"),r.promise)},v.quickSave=function(a){return v.save(a,300)},v.isSyncing=function(){var a;for(a in k)if(k.hasOwnProperty(a)&&k[a])return k[a];for(a in l)if(l.hasOwnProperty(a)&&l[a])return l[a];return!1},window.onbeforeunload||f.hasCloudAccess().then(function(){window.onbeforeunload=function(){return v.isSyncing()?"IcoMoon has not finished syncing your data to the cloud.":void 0}}),v)}}]),angular.module("icomoonApp").factory("message",["$q","$sce",function(a,b){var c,d;return{show:function(b,e,f){return"string"==typeof b?d=b:(d=b.message,e=b.firstButton,f=b.secondButton),this.visible=!0,c=a.defer(),this.firstButton=e&&e.caption?{caption:e.caption,focused:e.focused}:!1,this.secondButton=f&&f.caption?{caption:f.caption,focused:f.focused}:!1,c.promise},setMessage:function(a){d=a,"function"==typeof this.$apply&&this.$apply()},getRawMessage:function(){return d},getMessage:function(){return b.trustAsHtml(String(d))},hide:function(a){this.visible=!1,c.resolve(a)}}}]),angular.module("icomoonApp").factory("hotkeys",function(){function a(a){var b;return a=a.toLowerCase(),1===a.length?/[0-9a-z]/.test(a)?a.toUpperCase().charCodeAt(0):-1:(b={cmd:91,command:91,shift:16,ctrl:17,control:17,alt:18,option:18,opt:18,left:37,up:38,right:39,down:40,esc:27},b[a]||-1)}function b(a,b){var c,d=a.length,e=b.length;if(d!==e)return!1;for(c=0;e>c;c+=1)if(-1===a.indexOf(b[c]))return!1;return!0}function c(a){var c,d,e,f,h=g.length;for(d=0;h>d;d+=1)for(c=g[d].keys,f=c.length,e=0;f>e;e+=1)if(b(c[e],a))return g[d];return!1}function d(a){return(224===a||93===a)&&(a=91),a}function e(a){var b=a.getAttribute("contenteditable");return"text"===a.type||"search"===a.type||b&&"true"===b.toLowerCase()?!0:!1}var f=[],g=[],h={};return document.addEventListener("keydown",function(a){var b,g,h,i;e(a.target)||(i=d(a.which),g=f.indexOf(i),-1===g&&(f.push(i),h=!0),a.metaKey||(g=f.indexOf(91),-1!==g&&f.splice(g,1)),b=c(f),!b||!b.down||!h&&b.waitForUp&&b.up||(b.scope?b.scope.$apply(b.down):b.down(),b.waitForUp=!0,a.preventDefault()))}),document.addEventListener("keyup",function(a){var b,g,h;return e(a.target)?(f=[],void 0):(h=d(a.which),b=f.indexOf(h),-1!==b?(g=c(f),f.splice(b,1),91===a.which&&(f=[]),g&&(g.waitForUp=!1,g.keys.forEach(function(a){var b=c(a);b&&(b.waitForUp=!1)}),g.up&&(g.scope?g.scope.$apply(g.up):g.up(),a.preventDefault()))):(g=c([h]),g&&g.up&&(g.scope?g.scope.$apply(g.up):g.up(),a.preventDefault())),void 0)},!1),h.clear=function(){g=[]},h.add=function(b){var c,d,e,f,h,i,j=b.arr.slice(0),k=[];for(b.id&&(g.forEach(function(a){b.id!==a.id&&k.push(a)}),g=k),c=0,f=j.length;f>c;c+=1){for(i=j[c].keys,"string"==typeof i&&(j[c].keys=i=[i]),d=0,h=i.length;h>d;d+=1)for(i[d]=i[d].trim().split(/\s+\+?\s*/),e=0;e<i[d].length;e+=1)i[d][e]=a(i[d][e]);b.scope&&(j[c].scope=b.scope),b.id&&(j[c].id=b.id)}g=g.concat(j)},h}),angular.module("cloud",[]).factory("cloud",["$http","$q",function(a,b){var c,d,e,f,g,h,i,j,k={},l={};return k.ping=function(){var c=b.defer();return navigator.onLine?a({method:"POST",url:"https://i.icomoon.io/authstat"}).then(function(){c.resolve()},function(){c.reject()}):c.reject(),c.promise},k.auth=function(){var c=b.defer();return i===!0?c.resolve():i===!1?c.reject():a({method:"POST",url:"https://i.icomoon.io/authstat",withCredentials:!0}).then(function(a){var b=a.data;b.auth?(k.uid=b.uid,c.resolve(),i=!0):(c.reject(),i=!1)},function(){c.reject()}),c.promise},k.hasCloudAccess=function(d,e){var i=b.defer();return e=e||"",!d&&c?i.resolve(c):g?i.reject(g):a({method:"POST",url:"https://i.icomoon.io/getsessiontime",withCredentials:!0,data:{id:e}}).then(function(a){var b=a.data;b.error?(g={uid:b.uid||j||-1,noAccess:!0},i.reject(g)):(j=b.uid,c={time:b.time,uid:b.uid},i.resolve(c)),b.refTime&&(h=1e3*b.refTime,f=(new Date).getTime())},function(){g={uid:j||-1},i.reject(g)}),i.promise},k.getTime=function(){return h?h+((new Date).getTime()-f):(new Date).getTime()},k.storeSession=function(c){var d=b.defer();return a({method:"POST",url:"https://i.icomoon.io/storesession",withCredentials:!0,data:c}).then(function(a){d.resolve(a.data)},function(){d.reject()}),d.promise},k.getWoff2=function(c){var d=b.defer();return a({method:"POST",url:"https://i.icomoon.io/woff2",withCredentials:!0,data:c}).then(function(a){var b=a.data;b.error?d.reject():b.data&&d.resolve(b.data)},function(){d.reject()}),d.promise},k.getSession=function(c){var d=b.defer(),e=0,f=c.progress,g=c.id||"";return a({method:"POST",url:"https://i.icomoon.io/getsession",withCredentials:!0,data:{id:g,onlyLength:!0}}).then(function(a){e=Number(a.data)}),a({method:"POST",url:"https://i.icomoon.io/getsession",withCredentials:!0,data:{id:g},progress:function(a){"function"==typeof f&&(a.total=a.total||a.totalSize,a.total?f(a):f({total:e,loaded:a.loaded}))}}).then(function(a){d.resolve(a.data)},function(){d.reject()}),d.promise},k.getPurchases=function(){var c=b.defer();return a({method:"POST",url:"https://i.icomoon.io/purchases/0",withCredentials:!0}).then(function(a){c.resolve(a.data)},function(){c.reject()}),c.promise},k.getExpTime=function(){var c=b.defer();return l.timestamp&&(new Date).getTime()-l.timestamp<10368e5?c.resolve(l.daysLeft):a({method:"POST",url:"https://i.icomoon.io/purchases/1",withCredentials:!0}).then(function(a){l.daysLeft=0/0,l.timestamp=(new Date).getTime(),a.data.length?(a.data.forEach(function(a){(isNaN(l.daysLeft)||a.daysLeft>l.daysLeft)&&(l.daysLeft=a.daysLeft)}),c.resolve(l.daysLeft)):c.resolve(0/0)}),c.promise},k.host=function(c){var f=b.defer(),g=c.hash;return g===d&&c.onlyDev===!0?(f.resolve(e),f.promise):(d=g,a({method:"POST",url:"https://i.icomoon.io/host",withCredentials:!0,data:c}).then(function(a){e=a.data,f.resolve(e)},function(){f.reject()}),f.promise)},k.contact=function(c){var d,e=b.defer(),f="security=2&submitted=IcoMoon";c.email||(c.email="support@icomoon.io",c.msg+="<br /><br />No email address was provided.");for(d in c)f+="&"+(d+"="+c[d]);return a({method:"POST",url:"https://icomoon.io/contact/m.php",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:f}).then(function(a){/error/.test(a.data)?e.reject():e.resolve()},function(){e.reject()}),e.promise},k}]),angular.module("search",[]).factory("search",["$http","$q",function(a,b){var c,d,e,f={},g={query:"",arr:[]},h=[],i=function(a,b,c){var d,e,f,g,h,j,k=0,l=0,m=-1;if(c=c||.75,b=b.replace(/\s*/,"").toLowerCase().trim(),!b.length)return!1;if(b=b.split("/"),a=a.replace(/\s*/,"").toLowerCase().trim(),1!==b.length){for(d=0;d<b.length;d+=1)if(i(a,b[d]))return!0;return!1}if(b=b[0],b===a)return!0;for(g=b.length,d=0;g>d;d+=1)f=b[d],h=a.indexOf(f,m+1),d&&h!==m+1&&(e=!0),-1!==h?(e||(m=h),k+=1):(j=a.indexOf(f),-1===j?l=a.length:l+=Math.abs(d-j));return k&&!l&&!e&&g/a.length>c||(k-l)/a.length>c},j=function(a){var b,c,d,e,f,g,j,k=[];if("string"==typeof a&&(a=[a]),f=h.length,!f)return a;for(b=0;b<a.length;b+=1){for(j=[],c=0;f>c;c+=1)for(g=h[c],d=0,e=g.length;e>d;d+=1)if(d||"number"!=typeof g[d]||(e=g[d],g=g.slice(1)),i(g[d],a[b])){j=j.concat(g);break}j.push(a[b]),k=k.concat(j)}return k};return f.match=function(c,d){var f,k,l,m,n,o,p;if(e||(e=b.defer(),a({method:"GET",url:"icomoon-lib/dict.json"}).then(function(a){h=a.data,e.resolve()})),!d||!c)return!1;if("string"==typeof c)c=c.replace(/[\s\-\,]+/g," ").replace(/_/g,""),c=c.split(" ");else if(c.slice){for(c=c.slice(0),p=[],k=0;k<c.length;k+=1)c[k]=c[k].replace(/[\s\-\,]+/g," ").replace(/_/g,""),c[k]=c[k].split(" "),p=p.concat(c[k]);c=p}if(g.query!==d){for(g.query=d,"string"==typeof d&&(d=d.replace(/\s+\/\s+/g,"/").replace(/[\s\-]+/g," ").replace(/,+/g,","),d=d.split(" ")),p=j(d),g.arr=[],o=[],k=0;k<p.length;k+=1)/\s/.test(p[k])?g.arr=g.arr.concat(p[k].split(/\s+/)):o.push(p[k]);for(o=o.join("/"),k=0;k<g.arr.length;k+=1)g.arr[k]=g.arr[k]+"/"+o;g.arr.length||(g.arr=[o])}for(d=g.arr,m=d.length,f=0,k=0;m>k;k+=1){for(d[k]=d[k].trim(),l=0,n=c.length;n>l;l+=1)if(i(c[l],d[k])){f+=1;break}if(l===n)return!1}return f&&f>=m},f.getExternalResults=function(e,g){var h,i,j=b.defer(),k=[],l=[];return g=g||[],d?d.resolve():(d=b.defer(),a.get("icomoon-lib/map.json").then(function(a){c=a.data,d.resolve()})),d.promise.then(function(){if(e){for(i=[],h=0;h<c.sets.length;h+=1)-1===g.indexOf(c.sets[h].metadata.name)&&i.push(h);g=i;for(var a in c.tags)c.tags.hasOwnProperty(a)&&f.match(a,e)&&(l=l.concat(c.tags[a]));for(i=JSON.parse(JSON.stringify(c.sets)),h=0;h<i.length;h+=1)i[h].dir=h,i[h].icons=[];for(h=0;h<l.length;h+=1)i[l[h][0]]&&-1===i[l[h][0]].icons.indexOf(l[h][1])&&i[l[h][0]].icons.push(l[h][1]);for(h=0;h<i.length;h+=1)-1!==g.indexOf(h)&&i[h].icons.length&&k.push(i[h]);k.dir=c.dir,j.resolve(k)}else j.resolve(k)}),j.promise},f}]),angular.module("icomoonApp").directive("miIcon",["template",function(a){var b=a(['<div class="icon{{wide}}">','<svg width="{{width}}" height="{{height}}" viewBox="0 0 {{width}} {{height}}" style="margin-left: calc(50% - {{offset}}em)">','<g transform="scale({{scale}} {{scale}})">{{paths}}</g>',"</svg>","</div>"].join("")),c=a('<path{{attrs}} d="{{d}}"></path>'),d=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(" "+b+'="'+a[b]+'"');return c.join("")};return{restrict:"E",scope:{icon:"=",height:"@",prevsize:"@"},link:function(a,e){a.$watch(function(){return{icon:a.icon,prevSize:a.prevsize}},function(){var f,g,h,i,j,k,l=[];for(j=a.icon.paths,i=j.length,f=a.icon.attrs||{},g=0;i>g;g+=1)l.push(c.fillup({d:j[g],attrs:f[g]?d(f[g]):""}));h=Number(a.height),k=a.icon.width,isNaN(k)&&(k=h),e.html(b.fillup({width:k,height:h,paths:l.join(""),wide:k>1.5*h?" icon-wide":"",offset:k/h/2,scale:Number(a.prevsize)/h}))},!0)}}}]),angular.module("icomoonApp").controller("MainCtrl",["$scope","$timeout","$state","$q","$http","search","cloud","template","color","swatch","fileSaver","message","hotkeys","glyphs","svgPath","session","project",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){g.getExpTime().then(function(b){var c=b+" day"+(1===b?"":"s");b>0&&10>b?(a.expiration=4>b?"error":"warning",a.expMessage="Subscription ends in "+c,a.expMessage2="subscription will end in "+c+"."):0>=b?(a.expiration="error",a.expMessage="Subscription Expired",a.expMessage2="subscription has expired."):a.expiration=!1})}function s(a){var b;setTimeout(function(){try{b=document.getElementById("setH"+a.id).offsetTop-16,b-=document.getElementById("toolbar").offsetHeight}catch(c){b=0}window.scrollTo(0,b)},500)}function t(a){var b,c,d;if(!a||!a.length)return 0;for(c=a.length,d=a[0].id||0,b=1;c>b;b+=1)d=a[b].id>d?a[b].id:d;return d+1}function u(a,b){var c;a.selection||(a.selection=[]),c=a.selection[b]||{id:t(a.selection)},a.selection[b]=c,c.order=0}function v(a){var b,c;for(c=a.icons.length,b=0;c>b;b+=1)u(a,b),isNaN(a.icons[b].id)&&(a.icons[b].id=t(a.icons))}function w(a){var b,c,d,e,f=0,g="",h=[],i=0;for(a&&!isNaN(a.setIdx)?(f=a.setIdx,b=f+1):b=E.length,f;b>f;f+=1)for(c=E[f].selection.length,a&&a.selectionHash&&(g+=E[f].id),d=0;c>d;d+=1)E[f].selection[d].order?a&&a.selectionHash?g+=JSON.stringify(E[f].icons[d]):a&&a.onlyCount?i+=1:(e=E[f].selection[d],e.prevSize=e.prevSize||E[f].prevSize,h.push({icon:E[f].icons[d],attrs:E[f].icons[d].attrs,properties:e,setIdx:f,setId:E[f].id,iconIdx:d})):(E[f].selection[d].order=0,isNaN(E[f].selection[d].id)&&(E[f].selection[d].id=t(E[f].selection)));return a&&a.selectionHash?g:a&&a.onlyCount?i:(b=h.length,h)}function x(){var b,c={};for(E=q.iconSets,b=0;b<E.length;b+=1)c[E[b].id]=[];a.searchResults=c,a.project=q,a.pref=q.preferences,a.externalSets=[],a.fontPref=q.preferences.fontPref,a.imagePref=q.preferences.imagePref,a.edit&&a.edit.refresh&&a.edit.refresh(),a.set=E[a.setIdx]}function y(a){var b,c,d,e=a.length;if(!e)return!1;for(c=[a[0].fill+" "+a[0].opacity],b=1;e>b;b+=1){if(d=a[b].fill+" "+a[b].opacity,c.indexOf(d)<0)return!0;c.push(d)}return!1}function z(a,b,c,d){var e,f={id:b};return a.paths?(c!==J?(e=o(a.paths),e.viewBox={width:a.width||c,height:c},e=e.scale(J/c),f.width=e.viewBox.width,f.paths=e.getPathData(!0)):(f.paths=a.paths,a.width&&(f.width=a.width)),f.attrs=a.attrs||[],f.isMulticolor=a.isMulticolor||!1):(c=c||a.viewBox.height,c!==J&&a.scale(J/c),f.paths=a.getPathData(!0),f.attrs=a.getAttrs(!0),f.isMulticolor=y(f.attrs),isNaN(a.viewBox.width)||a.viewBox.width===J||(f.width=a.viewBox.width)),a.colorPermutations&&(f.colorPermutations=a.colorPermutations),a.tags&&(f.tags=a.tags),a.defaultCode&&(f.defaultCode=a.defaultCode),f.grid=d||0,f}function A(a){var b,c,d,e,f,g,h={selection:[]};if("string"==typeof a){for(e=E.length,b=0;e>b;b+=1)if(E[b].metadata.name===a)return E[b];return A({metadata:{name:a}})}if(a=a||{},h.id=t(E),h.metadata=a.metadata||{},delete h.metadata.iconsHash,!h.metadata.name){for(f=[],b=0,e=E.length;e>b;b+=1)f.push(E[b].metadata.name);if(g="Untitled Set",-1!==f.indexOf(g)){for(d=2;-1!==f.indexOf(g+" "+d);)d+=1;g=g+" "+d}h.metadata.name=g}h.height=J,c=a.icons||[],e=c.length;try{h.prevSize=a.prevSize&&a.prevSize<=128?a.prevSize:a.selection[0].prevSize||32}catch(i){h.prevSize=32}for(g=t(h.icons),b=0;e>b;b+=1)c[b]=z(c[b],g+b,a.height,c[b].grid||h.metadata.grid);return h.icons=c,a.selection?h.selection=a.selection:v(h),E.unshift(h),h}function B(a){return a=a.slice(0),a.forEach(function(b,c){a[c]=parseInt(b.join(""),10)}),a.sort().join("")}function C(b,c){var d,e,f,g,h;c.colorThemes&&c.colorThemes[0]||a.extractColorTheme(c),c.colorThemes&&c.colorThemes[0]&&(e=c.colorThemes[c.colorThemeIdx].slice(0),g=B(e),b.forEach(function(a){if(!a.colorPermutations||!a.colorPermutations[g]){for(e.forEach(function(a,b){e[b]=i(a).toString()}),d=[],f=0;f<a.attrs.length;f+=1){if(!a.attrs[f].fill)return;h=e.indexOf(i(a.attrs[f].fill).toString()),-1===h?h=0:d[f]=h}a.colorPermutations=a.colorPermutations||{},a.colorPermutations[g]=d}}))}function D(b){b=b||a.set,a.currentTheme=b.colorThemes[b.colorThemeIdx].slice(0),a.currentTheme.forEach(function(b,c){a.currentTheme[c]={hex:i(b).toNumber()}}),a.currentTheme.idx=a.currentTheme.idx||0}var E,F,G,H,I,J=1024;a.externalSets=[],g.auth().then(function(){a.signedIn=!0},function(){a.signedIn=!1}),p=p(q.metadata.created),a.isSyncing=p.isSyncing,g.hasCloudAccess().then(function(){a.cloudAccess=!0},function(){a.cloudAccess=!1}),a.scrollPositions={},a.$on("$stateChangeSuccess",function(){var b=c.current.name;a.tab=b,a.search="",setTimeout(function(){var c=a.scrollPositions[b]||0;window.scrollTo(0,c)},100)}),a.$on("$stateChangeStart",function(){a.scrollPositions[c.current.name]=window.scrollY}),r(),setInterval(r,10368e5),a.getNextId=t,a.getSetHash=function(a){var b,c=a.icons,d=c.length,e=[];for(b=0;d>b;b+=1)e.push(c[b].paths.join("")),c[b].tags&&e.push(c[b].tags.join(""));return e.join("").hashCode()},a.clearSelection=function(){var a,b=E.length;for(a=0;b>a;a+=1)v(E[a])},a.selectAllNone=function(a,b){var c,d,e,f=0,g="number"==typeof a?E[a]:a,h=g.selection,i=0;if(d=h.length,e=d/2,"undefined"==typeof b)for(c=0;d>c&&(h[c].order?i+=1:f+=1,!(i>e));c+=1)if(f>e){b=!0;break}h.forEach(function(a,c){b?(a.order=G,G+=1):u(g,c)})},a.getSelectedIcons=w,function(){var b=!1,c=!1;a.getSelectionCount=function(){return c===!1?(c=w({onlyCount:!0}),a.$parent.selectionCount=c,c):(b||(b=setTimeout(function(){c=!1,b=!1},750)),a.$parent.selectionCount=c,c)}}(),a.getSelectionHash=function(){return w({selectionHash:!0})},function(){var b,c,d,e,f,g,h,i,j,k,l,m=[];for(a.normSize=J,a.mode="select",a.edit={},a.visiblePanels={},F=[],F.idx=0,q.preferences=q.preferences||{},q.preferences.showGlyphs||(q.preferences.showGlyphs=!0),q.preferences.showQuickUse||(q.preferences.showQuickUse=!0),q.preferences.showQuickUse2||(q.preferences.showQuickUse2=!0),q.preferences.showSVGs||(q.preferences.showSVGs=!0),q.preferences.fontPref=q.preferences.fontPref||{prefix:"icon-",metadata:{},metrics:{emSize:1024,baseline:6.25,whitespace:50}},q.preferences.imagePref=q.preferences.imagePref||{prefix:"icon-",png:!0,useClassSelector:!0,color:4473924,bgColor:16777215},F.size=q.preferences.historySize||100,q.preferences.historySize=F.size,x(),g=E.length,j=[],d=0;g>d;d+=1){for((isNaN(E[d].id)||-1!==j.indexOf(E[d].id))&&(E[d].id=t(E)),j.push(E[d].id),E[d].prevSize=E[d].prevSize||32,b=E[d].icons,f=E[d].height,h=b.length,f!==J?(k=J/f,E[d].height=J):k=0,c=[],e=0;h>e;e+=1)b[e]&&((isNaN(b[e].id)||-1!==c.indexOf(b[e].id))&&(b[e].id=t(b)),c.push(b[e].id),b[e].grid=b[e].grid||0,k&&(i=o(b[e].paths),i.viewBox={width:b[e].width||f,height:f},i.scale(k),b[e].paths=i.getPathData(!0),b[e].width=i.viewBox.width,i.viewBox.width===J&&delete b[e].width,delete b[e].height),b[e].attrs||(b[e].attrs=[]));if(b=E,b[d].selection)for(h=b[d].selection.length,e=0;h>e;e+=1)l=b[d].selection[e],l&&l.order&&m.push(l);else v(b[d])}for(m.sort(function(a,b){return a.order-b.order}),G=1,d=0,g=m.length;g>d;d+=1)G=G>m[d].order?G:m[d].order;if(G+=1,G/g>2){for(d=0;g>d;d+=1)m[d].order=d+1;G=m.length+1||1}}(),a.changeIcons=function(b,c,d,e){var f,g,h,i,j,k,l=[],m=e?a.externalSets[c]:E[c],n="delete"===d,o="edit"===d,p=function(a){i[a]||(i[a]={}),j=i[a].order,j?u(m,a):(i[a].order=G,G+=1)},q=function(a){l.push(g[a])},r=function(a){i[a]=0,m.icons[a]=0},s=function(){var c,d,e;c=b[0],d=b[1],isNaN(d)&&(d=m.icons.length-1),e=m.icons.splice(c,1)[0],m.icons.splice(d,0,e),e=m.selection.splice(c,1)[0],m.selection.splice(d,0,e),a.search&&(e=a.searchResults[m.id].splice(c,1)[0],a.searchResults[m.id].splice(d,0,e))};if(m){if(i=m.selection,g=m.icons,n)k=r;else if(o)k=q;else{if("move"===d)return s(),void 0;k=p}for(f=0;f<b.length;f+=1)k(b[f]);if(n)k=function(a){return!!a},m.icons=g.filter(k),m.selection=i.filter(k);else if(o){if(h=a.edit,1!==l.length||b.noNavigation)h.icons=l,h.idx=0,h.properties=b.properties;else{if(a.search)for(h.icons=[],h.idx=0,f=0;f<m.icons.length;f+=1)a.searchResults[m.id][f]&&(h.icons.push(m.icons[f]),h.idx||b[0]!==f||(h.idx=h.icons.length-1));else h.icons=m.icons,h.idx=b[0];h.properties=!1}h.set=m,a.visiblePanels.edit=!0,h.refresh=function(){var e=h.idx;j=a.visiblePanels.edit,a.changeIcons(b,c,d),a.edit.idx=e,a.visiblePanels.edit=j}}}},function(){var c,d=0;a.$watch(function(){return d=q.time,delete q.time,JSON.stringify(q)},function(e,f){b.cancel(c),c=b(function(){I?I=!1:(F.idx>-1&&(F[F.idx]=f),a.history.ignore||F[F.idx]===e?a.history.ignore=!1:(F.idx+=1,F[F.idx]=e,F.splice(F.idx+1),F.length>F.size+1&&(F.shift(),F.idx-=1))),a.history.noUndo=F.idx<1,a.history.noRedo=F.idx>F.length-2,q.time=d,p.save(q)},500)})}(),a.history=function(b){F.idx+b>-1&&F.idx+b<F.length&&(JSON.stringify(F[F.idx+b])===JSON.stringify(q)?(F.splice(F.idx+b,1),0>b&&(F.idx-=1)):(F.idx+=b,q=JSON.parse(F[F.idx]),x(),I=!0)),a.history.noUndo=F.idx<1,a.history.noRedo=F.idx>F.length-2,a.history.idx=F.idx},a.history.noUndo=!0,a.history.noRedo=!0,a.isMulticolor=y,a.newSetFromSelection=function(a,b){var c,d,e,f=[],g=[],h={icons:f};for(c=!a,a=a||w(),d=0,e=a.length;e>d;d+=1)f[d]=a[d].icon,b&&(g[d]=JSON.parse(JSON.stringify(a[d].properties))),c&&(a[d].properties.order=0);b&&(h.selection=g),A(h),window.scrollTo(0,0)},a.removeSet=function(b,c){var d;c&&(d=w({setIdx:b})),E.splice(b,1),c&&d.length&&a.newSetFromSelection(d,!0)},function(){var b;a.import=function(c,e){function f(a){var b,c={};return a=a.replace(/\.[^\.]*$/,""),b=a.match(/U0x[0-9A-F]+/i),b&&(b=parseInt(b[0],16),c.defaultCode=b,a=a.replace(/U0x[0-9A-F]+/i,"")),/[^\d]/g.test(a)&&(a=a.replace(/^[\d]+/,"")),a=a.replace(/^[\-_\.\s]+|[\-_\.\s]+$/,""),c.name=a,c}function g(a){var b,c,d,e=a.path,f=a.name,g=a.importSize;if(!e)return D.reject(),D.promise;g&&(r&&"number"==typeof r.width&&r.width===r.height&&g.width!==g.height&&(d=Math.max(g.width,g.height),b=d-g.height,c=d-g.width,e.translate(0,b/2),e.viewBox.height=d,e.translate(c/2,0),e.viewBox.width=d),x.metadata.importSize=g,!x.prevSize&&"number"==typeof g.height&&g.height<=128&&(x.prevSize=g.height)),"number"!=typeof k&&(k=!1);var h=z(e,t(x.icons),!1,k);return!h.tags&&f&&(h.tags=[f]),isNaN(a.defaultCode)||(h.defaultCode=a.defaultCode),x.icons.unshift(h),x.selection=x.selection||[],x.selection.unshift({order:0,id:t(x.selection)}),h}var h,i,j,k,m,o,p,q,r,u,v,w,x,y,B,D=d.defer(),F=[],G=/^[\d\-_\.\s]+|\.[^\.]*$/g,H=d.defer(),I=/image.svg/;if(H.resolve(),!c)return D.reject(),D.promise;if(p=c.length,p||l.show("Please choose SVG images, SVG fonts or JSONs exported by IcoMoon."),"number"==typeof e)if(e>=0){for(x=E[e],i=[],m=0;m<x.selection.length;m+=1)i.push(x.selection[m].name||x.icons[m].tags[0]);for(H=d.defer(),m=0;p>m;m+=1)if(o=i.indexOf(f(c[m].name).name),-1!==o&&-1===i.indexOf(f(c[m].name).name,o+1)&&(1!==x.icons[o].tags.length||x.selection[o].name&&x.icons[o].tags[0]!==x.selection[o].name||!isNaN(x.icons[o].defaultCode)||!isNaN(x.selection[o].code)||x.selection[o].ligatures&&x.selection[o].ligatures.length)){l.show({message:"Replace existing icons?<br />By replacing, your settings (tags, ligatures, etc.) won't&nbsp;change.",firstButton:{caption:"Replace"},secondButton:{caption:"Reimport",focused:!0}}).then(function(a){H.resolve("Replace"===a)});break}m===p&&H.resolve()}else p>0&&(x=A());else e&&e.icons?x=e:w=!0;return H.promise.then(function(d){for(m=0;p>m;m+=1)if(I.test(c[m].type)){if(v=n(c[m].file),1===v.length&&!r)for(q=p,q>10&&(q=10),r={},o=0;q>o&&q>4;o+=1){B=n(c[o].file);try{B={width:Math.round(B[0].viewBox.width),height:Math.round(B[0].viewBox.height)},r.width&&r.height?(r.width=Math.max(r.width,B.width),r.height=Math.max(r.height,B.height)):r=B}catch(e){B=!1}}if(v.length>1)if(x)for(k=a.getGridSize(x),k=k&&k[0],o=0,q=v.length;q>o;o+=1)g({path:v[o]});else B=v.metadata||{},B.name||(B.name=c[m].name.replace(G,"")),A({icons:v,metadata:B});else{try{B={width:Math.round(v[0].viewBox.width),height:Math.round(v[0].viewBox.height)}}catch(e){B=!1}if(!x)if(E.length>0)try{for(j=[],b&&-1!==E.indexOf(b)&&j.push(b),o=0;o<E.length&&-1!==E[o].metadata.name.indexOf("Untitled Set");o+=1)j.push(E[o]);
for(o=0;o<j.length;o+=1)if((j[o].metadata.importSize||{}).height===B.height){x=j[o];break}x||(x=A({prevSize:B}))}catch(e){x=A()}else x=A();x.invisible=!1,b=x,"number"==typeof c[m].grid?k=c[m].grid:(k=a.getGridSize(x),k=k&&k[0]),u=f(c[m].name),o=-1,d&&(o=i.indexOf(u.name),-1!==o&&(B=z(v[0]),x.icons[o].paths=B.paths,x.icons[o].width=B.width,F.push(x.icons[o]))),-1===o&&(F.push(g({path:v[0],name:u.name,importSize:B,defaultCode:u.defaultCode})),i&&i.unshift(""))}}else B=JSON.parse(c[m].file),y=B.IcoMoonType,"icon-set"===y?h=A({icons:B.icons,height:B.height,metadata:B.metadata,prevSize:B.prevSize,selection:B.selection}):"selection"===y&&!function(){var b,c,d,e={};for(o=0,q=B.icons.length;q>o;o+=1)d=B.icons[o].icon,c=d.grid||"undefined",e.hasOwnProperty(c)?b=e[c]:(b=e[c]={},b.icons=[],b.selection=[],b.height=B.height),b.icons.push(d),b.selection.push(B.icons[o].properties);a.clearSelection();for(c in e)e.hasOwnProperty(c)&&A(e[c])}(),B.colorThemes&&h&&(h.colorThemes=B.colorThemes,h.colorThemeIdx=B.colorThemeIdx||0);x&&F.length&&(a.extractColorTheme(x),C(F,x)),w&&s(x),a.search="",D.resolve()}),D.promise}}(),a.showInfo=function(b){var c=E[b];a.setIdx=b,a.visiblePanels.info=!0,a.metadata=c.metadata,a.iconsCount=c.icons.length,a.set=c,a.colorTheme=a.extractColorTheme(c)},a.getGridSize=function(b){var c,d,e,f;if(b=b||a.set,b&&b.icons){for(f=b.icons.length,c=0;f>c;c+=1)if(d=b.icons[c],d.grid)if(e){if(-1===e.indexOf(d.grid)&&(e.push(d.grid),e.length>2))break}else e=[d.grid];if(e)return e.toString=function(){var a;return this.length?this.length>1?(a=this.slice(0),a.forEach(function(a){a=a||"unknown"}),"mixed ("+a.join(", ")+")"):1===this.length?this[0]||"unknown":void 0:"unknown"},e.sort()}},a.colorThemeKey=B,a.removeColorTheme=function(b,c){var d,e;c=c||a.set,b>=c.colorThemes.length||(b===c.colorThemeIdx&&a.selectColorTheme(0),b<c.colorThemeIdx&&(c.colorThemeIdx-=1),a.colorThemeIdx.value=c.colorThemeIdx,e=c.colorThemes.splice(b,1),d=B(e[0]),c.icons.forEach(function(a){delete a.colorPermutations[d]}),D(c))},a.downloadColorTheme=function(b,c){var d="icomoon_color_theme",e=k();c=c||a.set,b>=c.colorThemes.length||(e.add(d+".ase",j(c.colorThemes[b]).getASE({name:"IcoMoon Theme"})),e.add(d+".svg",j(c.colorThemes[b]).getSVG()),e.save(d+".zip"))},a.editColorTheme=function(b,c,d){var e,f,g,h,j,k,l;for(c=c||a.set,"number"!=typeof d&&(d=c.colorThemeIdx),e=c.colorThemes[d],k=B(e),b.forEach(function(a,b){e[b]=i(a.hex).toArray()}),j=B(e),f=0;f<c.icons.length;f+=1)if(g=c.icons[f],g.colorPermutations&&g.colorPermutations[k]||C([g],c),l=g.colorPermutations[j]=g.colorPermutations[k],delete g.colorPermutations[k],l)for(h=0;h<g.attrs.length;h+=1)g.attrs[h].fill=i(e[l[h]]).toString()},a.addColorPermutations=C,a.addColorTheme=function(b,c,d){var e,f,g,h,j=0;if(c=c||a.set,e=c.colorThemes,b=b.slice(0),b.forEach(function(a,c){a&&a.hex&&(a=a.hex),"string"!=typeof a&&a.length||(b[c]=i(a).toArray())}),e&&e[0]){for(e.forEach(function(a){var d=0;for(f=a.length!==b.length?B(a):!1;a.length<b.length;)d&&d+1>=a.length&&(d-=1),a.push(i(a[d]).average(i(a[d+1])).toArray()),d+=2;for(;a.length>b.length;)a.splice(a.length-1);f&&c.icons.forEach(function(a){try{delete a.colorPermutations[f]}catch(b){}})}),g=B(b),j=0;j<e.length&&(h=e[j],f=B(h),f!==g);j+=1);j===e.length&&e.push(b),C(c.icons,c)}else e=[b];return c.colorThemes=e,d&&a.selectColorTheme(j),j},a.importColorTheme=function(b){var c,d,e;if(e={},b.length&&(/ase/.test(b[0].type)?e.ase=b[0].file:/svg/.test(b[0].type)&&(e.svg=b[0].file),c=j(e).colors,c&&c.length)){for(a.newColorTheme=[],d=0;d<c.length;d+=1)a.newColorTheme.push({hex:i(c[d]).toNumber()});a.newColorTheme.idx=0}},a.getColorString=function(a){return i(a).toString()},a.selectColorTheme=function(b){var c,d,e,f,g,h,j,k,l,m,n,o=[],p=[],q=[],r=[],s=a.set;if(s.colorThemeIdx!==b){for(d=s.colorThemes[s.colorThemeIdx].slice(0),n=[],d.forEach(function(a,b){n[b]=i(a).toString()}),g=B(d),s.icons.forEach(function(a){var b;if(a.colorPermutations||(a.colorPermutations={}),!a.colorPermutations[g]||a.colorPermutations[g].length!==a.attrs.length)for(a.colorPermutations[g]=[],b=0;b<a.attrs.length;b+=1)a.colorPermutations[g][b]=n.indexOf(i(a.attrs[b].fill).toString()),-1===a.colorPermutations[g][b]&&(a.colorPermutations[g][b]=0)}),s.colorThemeIdx=b,j=s.colorThemes[b].slice(0),h=B(j),d.forEach(function(a,b){d[b]=i(a)}),j.forEach(function(a,b){j[b]=i(a)}),e=0;e<d.length;e+=1)for(f=0;f<j.length;f+=1)o.push({d:d[e].distance(j[f]),pair:[e,f]});for(o.sort(function(a,b){return a.d-b.d}),e=0;e<o.length;e+=1)l=o[e].pair[0],m=o[e].pair[1],-1===p.indexOf(l)&&-1===q.indexOf(m)&&(p.push(l),q.push(m),r[l]=m);j.forEach(function(a,b){j[b]=a.toString()}),s.icons.forEach(function(a){if(c=a.colorPermutations[g],!a.colorPermutations[h]||-1!==a.colorPermutations[h].indexOf(null))for(a.colorPermutations[h]=[],e=0;e<c.length;e+=1)a.colorPermutations[h][e]=r[c[e]];for(k=a.colorPermutations[h],e=0;e<a.attrs.length;e+=1)a.attrs[e].fill=j[k[e]||0]}),D()}},a.extractColorTheme=function(b){function c(a){delete a.colorPermutations}var d,e,f,g,h,i,j=[],k=b.icons.length;for(e=0;k>e;e+=1)if(g=b.icons[e],g.attrs)for(f=0;f<g.attrs.length;f+=1)if(d=g.attrs[f].fill,d&&-1===j.indexOf(d)&&(j.push(d),j.length>15))return b.icons.forEach(c),[];if(0===j.length)return[];for(b.colorThemeIdx=a.addColorTheme(j,b),a.colorThemeIdx={value:b.colorThemeIdx},a.newColorTheme=[],h=Math.round(192/j.length),e=0;e<j.length;e+=1)i=32+h*e,a.newColorTheme[e]={hex:i+256*i+65536*i};return D(b),a.newColorTheme.idx=0,j},a.editMetadata=function(b){b&&(a.metadata=b.metadata),a.visiblePanels.info=!1,a.visiblePanels.metadata=!0},a.showGridReset=function(){a.visiblePanels.info=!1,a.visiblePanels.gridReset=!0},a.resetGrids=function(b,c){c=c||a.set,b=b||0,c.icons.forEach(function(a){a.grid=b}),a.visiblePanels.gridReset=!1},a.getMultiples=function(a,b){var c,d,e,f,g,h=[];for("number"==typeof a&&(a=[a]),e=a.length,b=Math.floor((b||4)/e)||1,d=0;e>d;d+=1){if(f=a[d],!f||isNaN(f)){if(1===e)return[16,20,24,32];f=16}for(c=0;b>c&&(g=f*(c+1),!(g>100));c+=1)-1===h.indexOf(g)&&h.push(g)}return h.length<b&&(g=h[0]/2,0===h[0]%2&&g>=12&&h.unshift(g)),h},a.moveSet=function(a,b){var c,d=E.indexOf(a);c=d+b,-1!==d&&c>-1&&c<E.length&&(E.splice(d,1),E.splice(c,0,a))},a.downloadSet=function(b){var c;b=b||a.set,c=JSON.parse(JSON.stringify(b)),delete c.id,delete c.invisible,c.icons.forEach(function(a,b){try{a.defaultCode=a.defaultCode||c.selection[b].code}catch(d){}a.defaultCode||delete a.defaultCode,delete a.id,delete a.matchesSearch}),c.preferences=q.preferences,c.IcoMoonType="icon-set",c.metadata.iconsHash=a.getSetHash(b),k().save(c.metadata.name+".json",JSON.stringify(c,null,"	"))},a.copySelectionToSet=function(a){var b,c,d,e,f,g=[],h=[],i=E[a];if(i){for(e=w(),c=t(i.icons),i.selection=i.selection||[],d=t(i.selection),b=0;b<e.length;b+=1)f=JSON.parse(JSON.stringify(e[b].icon)),f.id=c+b,g.push(f),f=JSON.parse(JSON.stringify(e[b].properties)),f.id=d+b,h.push(f),e[b].properties.order=0;i.icons=g.concat(i.icons),i.selection=h.concat(i.selection)}},function(){var b,c,d=-1!==navigator.userAgent.indexOf("Mac OS X");m.clear(),m.add({arr:[{keys:"opt",down:function(){b=a.mode,a.mode="edit"},up:function(){a.mode=b||c||"select",b=!1}},{keys:["ctrl + alt","cmd + opt"],down:function(){c=b||a.mode||"select",a.mode="delete"},up:function(){a.mode=c}},{keys:["ctrl + z","cmd + z"],down:function(){a.history(-1)}},{keys:["ctrl + y","ctrl + shift + z","cmd + shift + z","cmd + y"],down:function(){a.history(1)}},{keys:"esc",up:function(){Object.keys(a.visiblePanels).forEach(function(b){a.visiblePanels[b]=!1})}}],scope:a}),a.tooltips=d?{delMode:"Remove (Cmd + Opt)",editMode:"Edit (Opt)",undo:"Undo (Cmd + Z)",redo:"Redo (Cmd + Shift + Z)"}:{delMode:"Remove (Ctrl + Alt)",editMode:"Edit (Alt)",undo:"Undo (ctrl + Z)",redo:"Redo (ctrl + Shift + Z)"},a.tooltips.selectMode="Select",a.tooltips.moveMode="Move"}(),a.vendorPrefix=function(){var a=window.getComputedStyle(document.documentElement,"");return(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1]}(),a.$watch("search",function(d){var e,h,i,j,k;if(d?a.history.ignore=!0:a.importExternalIcons(!0),!d)return a.externalSets=[],void 0;for(e=0,j=E.length;j>e;e+=1)for(i=0,k=E[e].icons.length;k>i;i+=1)h=E[e].icons[i],a.searchResults[E[e].id]=a.searchResults[E[e].id]||[],a.searchResults[E[e].id][i]=f.match(h.tags,d);"select"===c.current.name&&(b.cancel(H),H=b(function(){g.ping().then(function(){a.externalSets.status="Searching other packs...",a.externalSets.icon=!0;var b=0,c=[];E.forEach(function(a){c.push(a.metadata.name)}),g.getPurchases().then(function(e){var g,h,i=[];for(g=0,h=e.length;h>g;g+=1)i[g]=e[g].product;f.getExternalResults(d,c).then(function(c){c.forEach(function(a){var d=i.indexOf(a.productId);a.premium&&-1!==d?(a.premium=!1,a.purchased=!0,a.dir=e[d].svgslink):a.dir="https://icomoon.io/"+c.dir+"/"+a.dir+"/",a.selection=[];var f;for(f=0;f<a.icons.length;f+=1)a.selection.push({order:0,id:f});b+=a.icons.length}),a.externalSets=c,a.externalSets.icon=!1,a.externalSets.status=b+" results from other packs"})})},function(){a.externalSets.status="Connection Failed",a.externalSets.icon=!1})},50))}),a.importExternalIcons=function(b){function c(a,b,c){return function(d){a.files=a.files||[],a.files.push({type:"image/svg",file:d.data,name:p,grid:c}),b.resolve(a)}}var f,g,h,i,j,k,l,m,n,o,p=a.search;if(f=a.externalSets)for(i=0,k=f.length;k>i;i+=1){for(m=f[i].selection,n=!1,h=[],j=0,l=m.length;l>j;j+=1)m[j].order&&(n||(o=JSON.parse(JSON.stringify(f[i].metadata)),o.name+=" (subset)",n=A(o.name),n.metadata=o,n.prevSize=f[i].prevSize),g=d.defer(),h.push(g.promise),e({method:"GET",url:f[i].dir+f[i].icons[j]+".svg",withCredentials:f[i].purchased}).then(c(n,g,f[i].grid)),m[j].order=0);h.length&&d.all(h).then(function(c){var d=c[0],e=d.files;delete d.files,a.import(e,d).then(function(){var c,f=e.length;for(c=0;f>c;c+=1)b&&(d.selection[c].order=c+1);s(d),a.search=""})})}},a.hasExternalSelection=function(){var b,c,d,e=a.externalSets.length;for(b=0;e>b;b+=1)for(d=a.externalSets[b],c=0;c<d.selection.length;c+=1)if(d.selection[c].order)return!0;return!1},a.stringifyAttrs=function(a,b){var c,d=[];for(c in a)a.hasOwnProperty(c)&&("opacity"===c.toLowerCase()&&"1"===String(a[c])||"visibility"===c.toLowerCase()&&/false/i.test(String(a[c]))||(b&&b.css?d.push(("fill"===c?"color":c)+":"+a[c]+"; "):d.push(" "+c+'="'+a[c]+'"')));return d.join("")},a.premiumAlert=function(a){l.show({message:"<strong>"+a.metadata.name+"</strong> is a premium set. Would you like to purchase it?",firstButton:{caption:"Purchase"},secondButton:{caption:"Cancel",focused:!0}}).then(function(b){"Purchase"===b&&(window.location=a.metadata.url)})},a.sortByGrid=function(a){var b,c,d,e=[],f=0,g={};if(a){for(c=a.length,b=0;c>b;b+=1)d=a[b].icon.grid||0,g.hasOwnProperty(d)||(g[d]={idx:f,arr:[]},f+=1),g[d].arr.push(a[b]);for(d in g)g.hasOwnProperty(d)&&e.push(g[d]);for(e.sort(function(a,b){return a.idx-b.idx}),a=[],b=0,c=e.length;c>b;b+=1)a=a.concat(e[b].arr);return a}},a.fixed=function(a){return(a||0).toFixed(1).replace(/\.0+$/,"")},a.showWarning=function(b){b?l.show(b):l.show({message:"Your premium plan "+a.expMessage2,firstButton:{caption:"Extend",focused:!0},secondButton:{caption:"Cancel"}}).then(function(a){"Extend"===a&&(window.location="https://icomoon.io/#premium/r3f01")})},h().get("image.svg")}]),angular.module("icomoonApp").controller("EditCtrl",["$scope","glyphs","template","fileSaver","svgPath","hotkeys","message","color",function(a,b,c,d,e,f,g,h){function i(a){var b=s,c=a.width||s;a.translate(-c/2,-b/2)}function j(a){var b=s,c=a.width||s;a.translate(c/2,b/2)}function k(a){q.icons&&q.icons.forEach(function(b){b.grid=b.grid||a})}function l(a){i(p),a(),j(p),q.icons[q.idx].paths=p.getPathData(!0)}function m(){return s/(2*a.icon.grid||64)}var n,o,p,q=a.edit,r=!0,s=a.normSize;a.pref.gridSize=a.pref.prevSize||16,function(){var b;a.$watch(function(){return JSON.stringify([a.edit.idx,a.edit.icons[a.edit.idx],a.visiblePanels.edit])},function(){var c,d=a.edit,f=d.idx;if(a.visiblePanels.edit&&d.icons&&d.icons.length){c=d.icons[f],a.icon=c;try{a.currentTheme=d.set.colorThemes[d.set.colorThemeIdx].slice(0),o=a.colorThemeKey(a.currentTheme),a.currentTheme.forEach(function(b,c){a.currentTheme[c]=h(b).toString()})}catch(g){a.currentTheme=!1,o=!1}try{a.properties=d.properties||d.set.selection[f],!a.properties.name&&a.properties.hasOwnProperty("name")&&(a.properties.name="")}catch(g){}a.noNext=f>d.icons.length-2,a.noPrev=1>f,c.paths&&(p=e(c.paths),p.width=c.width||s),a.tags=c.tags?c.tags.join(", "):""}b!==f&&(b=f,a.pathIdx=0/0)})}(),a.$watch(function(){return a.icon&&a.icon.grid},function(a){n=a}),a.$on("$destroy",function(){n&&k(n)}),a.$watch("tags",function(b){b&&b.split&&(a.icon.tags=b.split(", "))}),a.ccw=function(){l(function(){p.rotate(-90,a.pathIdx)})},a.cw=function(){l(function(){p.rotate(90,a.pathIdx)})},a.flipHorizontal=function(){l(function(){p.transform({a:-1,d:1},a.pathIdx)})},a.flipVertical=function(){l(function(){p.transform({a:1,d:-1},a.pathIdx)})},a.scaleDown=function(){var b=m(),c=1-2*b/s;l(function(){p.scale(c,c,a.pathIdx)})},a.scaleUp=function(){var b=m(),c=1/(1-2*b/s);l(function(){p.scale(c,c,a.pathIdx)})},a.increaseWidth=function(){var a=m();isNaN(q.icons[q.idx].width)&&(q.icons[q.idx].width=s),q.icons[q.idx].width+=a},a.decreaseWidth=function(){var a=m();isNaN(q.icons[q.idx].width)&&(q.icons[q.idx].width=s),q.icons[q.idx].width-=a,q.icons[q.idx].width<0&&(q.icons[q.idx].width=0)},a.translate=function(b,c){var d=m();b=Number(b),b=b?b>0?1:-1:0,c=Number(c),c=c?c>0?1:-1:0,l(function(){p.translate(b*d,c*d,a.pathIdx)})},a.selectPath=function(b){a.pathIdx=isNaN(b)?0/0:b},a.next=function(){q.icons&&q.idx<q.icons.length-1&&(q.idx+=1),r&&(k(n),r=!1)},a.prev=function(){q.icons&&q.idx>0&&(q.idx-=1),r&&(k(n),r=!1)},a.replace=function(c){var d,e,f;return c&&c[0]?(d=c[0],f=b(d.file),1===f.length&&(e=f[0],a.normSize!==e.viewBox.height&&e.scale(a.normSize/e.viewBox.height),q.icons[q.idx].paths=f[0].getPathData(!0),q.icons[q.idx].attrs=e.getAttrs(!0),q.icons[q.idx].isMulticolor=a.isMulticolor(q.icons[q.idx].attrs),q.set&&(delete q.icons[q.idx].colorPermutations,a.addColorPermutations([q.icons[q.idx]],q.set))),void 0):(a.visiblePanels.edit=!1,g.show("Please select an SVG image.").then(function(){a.visiblePanels.edit=!0}),void 0)},a.makeCopy=function(b){var c=JSON.parse(JSON.stringify(b));c.id=a.getNextId(q.set.icons),q.set.selection.splice(q.idx,0,{order:0}),q.set.icons.splice(q.idx,0,c),a.visiblePanels.edit=!1},a.downloadIcon=function(b){var f,g,h,i,j,k,l,m,n,o=!1,p=c().get("image.svg");for(k=e(b.paths),k.viewBox={width:b.width||s,height:b.height||s},k.scale(32*(b.grid||32)/k.viewBox.height),l=k.getPathData(!0),g=0,i=l.length;i>g;g+=1)l[g]={d:l[g],strAttrs:b.attrs&&b.attrs[g]?a.stringifyAttrs(b.attrs[g]):""};if(j=b.tags,j&&(j=j[0]),j||(j="icomoon"),a.pref.showGrid&&b.grid){for(o=[],h=!0,n=k.viewBox.width,f=k.viewBox.height,m=Math.round(f/b.grid/2),g=m;n>g;g+=m)o.push({y1:0,y2:f,x1:g,x2:g,opacity:h?.3:1}),h=!h;for(h=!0,g=m;f>g;g+=m)o.push({y1:g,y2:g,x1:0,x2:n,opacity:h?.3:1}),h=!h}p.then(function(a){d().save(j+".svg",a.fillup({paths:l,width:k.viewBox.width,height:k.viewBox.height,lines:{lines:o}}))})},a.getWidth=function(){var b,c=a.icon;return c?(b=c.width,isNaN(b)&&(b=s),Math.round(60*(b/(c.height||s)))+"%"):0},a.updateColor=function(b){var c,d=a.icon,e=a.pathIdx;d.isMulticolor||(d.colorPermutations={},d.colorPermutations[o]={},d.isMulticolor=!0),c=a.currentTheme[b],d.colorPermutations[o]?(d.colorPermutations[o][e]=b,d.attrs&&d.attrs.length||(d.attrs=[],d.paths.forEach(function(a,e){d.attrs[e]={fill:c},d.colorPermutations[o][e]=b})),d.attrs[e].fill=c):(d.colorPermutations[o]=[],d.attrs=[],d.paths.forEach(function(a,e){d.attrs[e]={fill:c},d.colorPermutations[o][e]=b}))},a.deletePath=function(a){p.deleteSubPath(a);var b=q.icons[q.idx];b.paths=p.getPathData(!0),b.attrs.splice(a,1)},f.add({arr:[{keys:"left",down:a.prev},{keys:"right",down:a.next}],scope:a,id:"edit"})}]),angular.module("icomoonApp").controller("FontCtrl",["$scope","$state","$q","$timeout","svgPath","font","template","fileSaver","cloud","message",function(a,b,c,d,e,f,g,h,i){function j(a){var b,c,d,e;if("string"==typeof a)c=a?v.idx[a]:1;else{if("number"==typeof a)return-1===u.indexOf(a)?(u.push(a),a):j(a+1);c=1}for(e=v[c],d=e[1],b=e[0];d>b;b+=1)if(-1===u.indexOf(b))return u.push(b),b;return c+1<v.length&&j(c+1),0}function k(a){return a.split?a=a.split(/\s*,\s*/):a.slice&&(a=a.slice(0)),a.forEach(function(b,c){var d=2;if(-1!==s.indexOf(b)){for(;-1!==s.indexOf(b+d);)d+=1;b+=d}a[c]=b,s.push(b)}),a.join(", ")}function l(b){function c(a){n=e(a),n.viewBox={width:isNaN(h.width)?s:h.width,height:isNaN(h.height)?s:h.height},b&&o&&n.translate(0,o),r.push({svgPath:n,s:m})}var d,f,g,h,i,j,k,l,m,n,o,p=a.fontPref.metrics.baseline/100,q=a.fontPref.metrics,r=[],s=a.normSize,u={};for(q?(q=q.emSize,d=-p*q):(q=1024,d=-64),t=a.sortByGrid(t),j=t.length,g=0;j>g;g+=1)m=t[g],h=m.icon,b&&(f=h.grid||m.properties.prevSize||i||16,i=f,u[f]?o=u[f]:(k=Math.round(p*f),o=k*q/f-p*q,o/=q/s,u[f]=o)),h.isMulticolor?h.paths.slice(0).forEach(c):(l=e(h.paths.slice(0)),l.viewBox={width:isNaN(h.width)?s:h.width,height:isNaN(h.height)?s:h.height},b&&o&&l.translate(0,o),r.push({svgPath:l,s:m}));return{glyphs:r,emSize:q,ascent:q+d,descent:d,unitsPerEm:q,defaultAdvX:q}}function m(){var b,c;b=l(!0),b.glyphs.length?(c=f(b).generate({woff:w}).woff,d(function(){URL&&URL.createObjectURL&&Blob?(URL.revokeObjectURL(a.localFont),a.localFont=URL.createObjectURL(new Blob([c],{type:"application/font-woff"}))):a.localFont="data:application/font-woff;charset=utf-8;base64,"+c.toString(!0)},0)):a.localFont=""}function n(a){for(var b,c,d=0,e=a;e>1;)e/=2,d+=1;return b=Math.pow(2,d),c=Math.pow(2,d-1),Math.abs(a-c)<Math.abs(a-b)?c:b}function o(){t.length<500?p({woff:w}).woffReady.then(function(b){a.woffSize=b.byteLength+" bytes"}):a.woffSize="unknown"}function p(b){var d,e,g,h,j,k,m,n,o,p,q,r,s=c.defer(),t=a.fontPref,u=!1,v=t.metadata,x=a.pref.showLiga;for(v||(v={},t.metadata=v),j=l(!0),e=0,o=j.glyphs.length;o>e;e+=1)if(m=j.glyphs[e],g=m.s.icon,g.isMulticolor){for(h=0;h<g.attrs.length;h+=1)m=j.glyphs[e+h],m.code=m.s.properties.codes[h];e+=h-1}else m.code=m.s.properties.code,32===m.code&&(q=!0),t.includeMetadata&&(m.tags=g.tags),x&&(p=m.s.properties.ligatures,p&&p.length>1&&(m.ligatures=p.split(/,\s*/),u=!0),(!n||m.code>n.code)&&(n=m));return u&&(n.ligatures||(n.ligatures=[]),r=n.code+1,r>65535&&(r=65535),r=String.fromCharCode(r),r+=r,n.ligatures.push(r)),q||j.glyphs.push({code:32,advX:t.metrics.whitespace/100*(t.metrics.emSize||1024)}),j.glyphs.push({code:0,advX:0}),j.glyphs.push({code:1,advX:0}),t.includeMetadata||(v={fontFamily:v.fontFamily||"icomoon",majorVersion:v.majorVersion,minorVersion:v.minorVersion}),j.metadata=v,b=b||{woff:w,ttf:!0,svg:!0,eot:!0},k=f(j).generate(b),r={ready:s.promise},r.ready=s.promise,k.ttf&&(d=c.defer(),r.ttfReady=d.promise,d.resolve(k.ttf)),k.woff&&(d=c.defer(),r.woffReady=d.promise,d.resolve(k.woff)),k.eot&&(d=c.defer(),r.eotReady=d.promise,d.resolve(k.eot)),k.svg&&(d=c.defer(),r.svgReady=d.promise,d.resolve(k.svg)),b.woff&&b.ttf?i.hasCloudAccess().then(function(){i.getWoff2({ttf:k.ttf.toString(!0)}).then(function(a){d=c.defer(),r.woff2Ready=d.promise,d.resolve(a),s.resolve()},function(){s.resolve()})},function(){s.resolve()}):s.resolve(),r}function q(b){var d,e,f=p(),i=a.fontPref,j=i.metadata&&i.metadata.fontFamily||"icomoon",k=b?"":"fonts/",l=h(),m={},n=i.prefix||i.postfix,o=c.defer(),q=c.defer(),r=c.defer(),s=c.defer(),u=c.defer(),v=c.defer(),w=c.defer(),x=c.defer(),y=c.defer(),z=c.defer();return i.selector&&(n=i.classSelector||".icon",n=n.slice(1)),i.cssVars||s.resolve(),f.ttfReady&&f.ttfReady.then(function(a){l.add(k+j+".ttf",a)}),f.woffReady&&f.woffReady.then(function(a){l.add(k+j+".woff",a),m.woffSize=a.byteLength}),f.eotReady&&f.eotReady.then(function(a){l.add(k+j+".eot",a)}),f.svgReady&&f.svgReady.then(function(a){i.includeMetadata||(a=a.replace(/(<metadata>)[\s\S]*(<\/metadata>)/,"$1Generated by IcoMoon$2")),l.add(k+j+".svg",a)}),f.ready.then(function(){f.woff2Ready?f.woff2Ready.then(function(a){l.add(k+j+".woff2",a,{base64:!0}),z.resolve()},function(){z.resolve()}):z.resolve()}),d=JSON.stringify(t),e=JSON.parse(d),d=(d+JSON.stringify(i)+a.project.metadata.name).hashCode(),e.forEach(function(a){delete a.properties.tempChar,delete a.icon.id,delete a.icon.matchesSearch}),e={IcoMoonType:"selection",icons:e,height:a.normSize,metadata:{name:i.metadata.fontFamily,url:i.metadata.fontURL,designer:i.metadata.designer,designerURL:i.metadata.designerURL,license:i.metadata.license,licenseURL:i.metadata.licenseURL},preferences:a.pref},b||l.add("selection.json",JSON.stringify(e,null,"	")),g().get("demo.html").then(function(c){var e,h,p,z,A,B,C,D,E,F,G,H,I,J,K=-1,L=a.pref.showLiga?[]:!1,M=[],N=[],O=[],P=[],Q=[];for(L&&(h=function(a){a&&(M.push({tag:a,code:I.code}),Q.push(a))}),z=0,C=a.glyphSets.length;C>z;z+=1)I=a.glyphSets[z],N[z]={},N[z].tmpGlyphs=I,O[z]={idx:z+1,size:I[0].properties.prevSize},N[z].grid=I.grid||"Unknown";for(p={prefix:i.prefix,postfix:i.postfix,hiddenLiga:L?!1:!0,hiddenCodes:a.pref.showCodes?!1:!0,selector:"class"===i.selector?n+" ":"",element:"i"===i.selector?"i":"span"},p.prefix||p.postfix||(p.prefix=""),z=0;C>z;z+=1)for(N[z].glyphs=[],N[z].fontSizeIdx=z+1,K=0,D=N[z].tmpGlyphs.length;D>K;K+=1){if(G=N[z].tmpGlyphs[K],E=G.properties,A=G.icon,I=Object.create(p),I.glyphName=E.name.replace(/\s+/g," ").split(/\s*,\s*/),I.code=E.code.toString(16),I.char=E.code,I.liga=E.ligatures,I.paths=!1,A.isMulticolor){for(I.paths=[],I.glyphName.splice(1),I.single=!1,B=0;B<A.attrs.length;B+=1)I.paths[B]={},I.paths[B].name="path"+(B+1),I.paths[B].marginLeft=0!==G.marginLeft[B]?{value:G.marginLeft[B]}:!1,I.paths[B].color={value:A.attrs[B].fill},I.paths[B].glyphName=I.glyphName[0],I.paths[B].code=N[z].tmpGlyphs[K+B].properties.code.toString(16),I.paths[B].pathIdx=B+1,I.paths[B].pathClass=" .path"+(B+1),I.paths[B].prefix=p.prefix,I.paths[B].postfix=p.postfix;K+=B-1}else I.single={code:I.code,prefix:p.prefix,postfix:p.postfix,glyphName:I.glyphName};if(L&&I.liga&&I.liga.split(/,\s*/).forEach(h),I.fontSizeIdx=z+1,I.glyphName.length>1)for(e=I.glyphName,B=0;B<e.length;B+=1)J=Object.create(I),I.single?(J.single=Object.create(J.single),J.glyphName=J.single.glyphName=e[B]):J.glyphName=e[B],P.push(J),N[z].glyphs.push(J);else I.glyphName=I.glyphName[0],P.push(I),N[z].glyphs.push(I)}L=!!M.length,H="i"===i.selector?"icomoon-liga":n,b?(m.onlineEditor={},g().get("demo2.html").then(function(a){m.onlineEditor.html=a.fillup({sets:N}),y.resolve()}),g().get("demo2.css").then(function(a){m.onlineEditor.css=a.fillup({fontSizes:O}),x.resolve()}),o.resolve(),q.resolve()):(l.add("demo.html",c.fillup({fontName:j,glyphsCount:t.length,sets:N,ie7:i.ie7?[]:!1,liga:L,ligaClass:H,testDrive:Q.join(" ")})),y.resolve(),g().get("demo.js").then(function(a){l.add("demo-files/demo.js",a.fillup({})),o.resolve()}),g().get("demo.css").then(function(a){l.add("demo-files/demo.css",a.fillup({fontSizes:O})),x.resolve()}),g().get("readme.txt").then(function(a){l.add("Read Me.txt",a.fillup({})),q.resolve()})),F={fontsDir:k,fontFamily:j},g().get("style.css").then(function(a){var b=!1;f.ready.then(function(){f.woff2Ready&&(b=!0)}).finally(function(){var c={fontFamily:j,glyphs:P,fontFace:"",fontFaceB64:""};"i"===i.selector?(c.selector="i",L&&(c.selector+=", .icomoon-liga")):"class"===i.selector?c.selector=i.classSelector:(i.postfix&&(c.selector='[class$="'+i.postfix+'"], [class*="'+i.postfix+' "]'),(!c.selector||i.prefix)&&(c.selector='[class^="'+n+'"], [class*=" '+n+'"]')),i.embed?c.fontFaceB64=F:(c.fontFace=F,c.fontFace.hash=d.toString(36),c.fontFace.cacheBuster="?"+c.fontFace.hash),c.liga=L,i.embed?f.ttfReady.then(function(b){F.ttf=b.toString(!0),l.add("style.css",a.fillup(c)),r.resolve()}):(c.fontFace.woff2=b?c.fontFace:!1,l.add("style.css",a.fillup(c)),r.resolve())})}),i.cssVars&&g().get("variables.tmpl").then(function(a){var b,c,d,e,f,g=i.cssVarsFormat||"sass";"sass"===g?(e=": ",d="$",c="scss",b=";"):"stylus"===g?(e=" = ",d="",c="styl",b=""):"less"===g&&(e=": ",d="@",c="less",b=";"),f={separator:e,ending:b,indicator:d},a.fillup({glyphs:[{single:f,paths:[f]}]}),l.add("variables."+c,a.fillup({glyphs:P})),s.resolve()}),i.ie7?(g().get("ie7.css").then(function(a){l.add(b?"ie7.css":"ie7/ie7.css",a.fillup({glyphs:P})),v.resolve()}),g().get("ie7.js").then(function(a){l.add(b?"ie7.js":"ie7/ie7.js",a.fillup({glyphs:P,fontFamily:j,prefix:i.prefix})),u.resolve()})):(u.resolve(),v.resolve()),L?g().get("liga.js").then(function(a){l.add("liga.js",a.fillup({ligaTags:M,ligaClass:H})),w.resolve()}):w.resolve()}),m.hash=d,m.fontName=j,m.zip=l,m.promise=c.all([o.promise,q.promise,r.promise,u.promise,v.promise,w.promise,x.promise,y.promise,z.promise]),m}var r,s,t,u=[],v=[[33,126],[58880,65535],[983040,1048575]],w=a.fontPref.woffOutlines||"truetype";v.idx={bLatin:0,pua:1,spua:2},a.quickUsage={statusMessage:"Working"+String.fromCharCode(8230)},function(){a.pref.fontUrlS3&&(a.quickUsage.url2=a.pref.fontUrlS3),a.pref.fontUrlCF&&(a.quickUsage.url3=a.pref.fontUrlCF)}(),a.hostFont=function(b){var c,d=a.fontPref,e=b&&b.enable,f=b&&b.onlyDev&&a.pref.fontUploadTime,h=q(!0);(d.autoHost||e)&&(d.autoHost=!0,g().get("demo2.html.tmpl"),g().get("demo2.css.tmpl"),c=a.project.metadata.name.replace(/[^a-zA-Z\-\_0-9]/g,""),f=f&&a.pref.fontHostingName===c,a.pref.quickUsageToken&&a.pref.quickUsageToken[c]||(a.pref.quickUsageToken={}),a.onlineEditor={disabled:!0},h.promise.then(function(){var b,d={hash:h.hash,zip:h.zip.getArrayBuffer().toString(!0),name:c,token:a.pref.quickUsageToken[c],ssl:!0},e="";a.woffSize=h.woffSize+" bytes",a.history.ignore=!0,a.quickUsage.icon="sync fgc-warning",a.quickUsage.statusMessage="Uploading"+String.fromCharCode(8230),f?(d.onlyDev=!0,a.quickUsage.updateCaption="Update"):(a.quickUsage.updateCaption="Uploading"+String.fromCharCode(8230),a.quickUsage.hostingDisabled=!0),i.host(d).then(function(d){i.hasCloudAccess().then(null,function(){d.path2||d.path3||(e="\nIt will expire in 24 hours. ")}).finally(function(){var g=f?a.pref.fontUrlHash||0:h.hash.toString(36);e=e||"\nFor development purposes only. Do not use in Production.",a.quickUsage.url=d.path+"/style.css",a.quickUsage.url2=d.path2?d.path2+"/style.css?"+g:!1,a.quickUsage.url3=d.path3?d.path3+"/style-cf.css?"+g:!1,a.onlineEditor.data=JSON.stringify({html:"<!-- Add the following link to the <head> of your HTML."+e+' -->\n<link rel="stylesheet" href="'+a.quickUsage.url+'">\n'+h.onlineEditor.html,css:h.onlineEditor.css}),a.onlineEditor.disabled=!1,a.pref.quickUsageToken[c]=d.token,a.history.ignore=!0,a.quickUsage.icon="check fgc-success",a.quickUsage.statusMessage="Ready",!f&&d.path2&&(b=new Date,a.pref.fontUploadTime=b.toLocaleDateString()+", "+b.toLocaleTimeString(),a.pref.fontUrlS3=a.quickUsage.url2,a.pref.fontUrlCF=a.quickUsage.url3,a.pref.fontUrlHash=g,a.pref.fontHostingName=c),d.path2||(a.pref.fontHostingName=a.fontUploadTime=!1),f||(a.quickUsage.hostingDisabled=!1,a.quickUsage.updateCaption="Update")})},function(){a.quickUsage.icon="warning fgc-error",a.quickUsage.statusMessage="Upload Failed",f||(a.quickUsage.hostingDisabled=!1,a.quickUsage.updateCaption="Update")})}))},function(){var b,c,e=0,f=[],h=!0;a.$watch(function(){return t=a.getSelectedIcons(),JSON.stringify(t)+a.history.idx},function(){var g,i,l,n,p,q,v,w,x,y=0/0,z=a.fontPref,A=58880,B=a.normSize,C=t.length,D=a.getSelectionHash(),E=!1;if(u=[],s=[],a.glyphNames={empty:""},a.ligatures={},(C>e||C===e&&D!==b)&&(E=!0),!E)for(i=0;C>i;i+=1)if(w=t[i],!w.properties.tempChar||!r[i]){E=!0;break}for(E&&(e=C,r=[],a.glyphSets=[]),b=a.getSelectionHash(),a.ligaWarning=!1,a.numOfGlyphs=C,x=t.slice(0),x.sort(function(a,b){return a.properties.order-b.properties.order}),n=0,i=0;C>i;i+=1)if(w=x[i],q=w.icon,g=w.properties.code,isNaN(g)||(w.properties.code=j(g)),v=w.properties.name,v&&(w.properties.name=k(v)),q.isMulticolor&&q.paths.length<2&&(q.isMulticolor=!1,delete w.properties.codes),q.isMulticolor&&w.properties.codes)if(w.properties.code!==w.properties.codes[0])w.properties.codes=!1;else for(l=1;l<q.attrs.length;l+=1)w.properties.codes[l]=j(w.properties.codes[l]);for(t=a.sortByGrid(t),i=0;C>i;i+=1){if(w=t[i],q=w.icon,g=w.properties.code,isNaN(g)&&(g=q.defaultCode,isNaN(g)&&(g="pua"),g=j(g),w.properties.code=g),q.isMulticolor&&!w.properties.codes)for(w.properties.codes=[g],l=1;l<q.attrs.length;l+=1)w.properties.codes.push(j(g));if(v=w.properties.name,v||(!v&&q.tags&&(v=q.tags[0].replace(/[^\w\d\-\_]/g,""),z.prefix.trim()||(v=v.replace(/^\d+/,""))),v||(v="uni"+g.toString(16).toUpperCase()),/\s/.test(v)&&(v=v.replace(/\s/,"-")),v=k(v)),w.properties.name=v,E)if(w.properties.tempChar=String.fromCodePoint(A),A+=1,q.isMulticolor)for(w.properties.tempChar=[w.properties.tempChar],x=[],l=0;l<q.attrs.length;l+=1)l&&(w.properties.tempChar.push(String.fromCodePoint(A)),A+=1),r.push({grid:q.grid,properties:0===l?w.properties:{code:w.properties.codes[l]},icon:q,selectionIdx:i,hide:l>0,marginLeft:x,setId:w.setId,iconIdx:w.iconIdx}),x.push(l>0?-((isNaN(q.width)?B:q.width)/(isNaN(q.height)?B:q.height))+"em":0),n+=1;else r.push({grid:q.grid,properties:w.properties,icon:q,selectionIdx:i,setId:w.setId,iconIdx:w.iconIdx}),n+=1;else if(q.isMulticolor)for(l=0;l<q.attrs.length;l+=1)0===l?(r[n].properties=w.properties,x=[],r[n].marginLeft=x):r[n].properties={code:w.properties.codes[l]},r[n].icon=q,r[n].grid=q.grid,r[n].hide=l>0,x.push(l>0?-((isNaN(q.width)?B:q.width)/(isNaN(q.height)?B:q.height))+"em":0),r[n].selectionIdx=i,n+=1;else r[n].properties=w.properties,r[n].grid=q.grid,r[n].selectionIdx=i,r[n].icon=q,r[n].hide=!1,n+=1;p=w.properties.ligatures,q.isMulticolor&&"string"==typeof p&&(w.properties.ligatures="")}for(E&&!h&&m(),r.splice(n),l=-1,n=0,i=0;i<r.length;i+=1)r[i].grid!==y&&(y=r[i].grid,l+=1,f[l]=f[l]||[],f[l].grid=y,-1!==l&&f[l].splice(n),n=0),f[l][n]=r[i],f[l][n].properties.prevSize=f[l][0].properties.prevSize||y||32,n+=1;n&&-1!==l&&f[l].splice(n),f.splice(l+1),a.glyphSets=f,h=!1,d.cancel(c),c=d(function(){a.fontPref.autoHost?a.hostFont({onlyDev:!0}):o()},2e3)});var i;a.$watch(function(){return a.fontPref},function(b){var e=b.metrics,f=JSON.stringify(e);d.cancel(c),c=d(function(){a.fontPref.autoHost?a.hostFont({onlyDev:!0}):o()},2e3),b.prefix.trim()||b.prefix.trim()||b.selector||(b.prefix="icon-"),"class"===b.selector&&(b.classSelector=b.classSelector||"",b.classSelector="."+(b.classSelector.replace(/[^a-zA-Z\-\_0-9]/g,"").replace(/^[^a-zA-Z_\-]/,"").replace(/^-([^a-zA-Z_])/,"")||"icon")),b.prefix&&(b.prefix=b.prefix.replace(/\s+/,"-")),b.postfix&&(b.postfix=b.postfix.replace(/\s+/,"-"));try{b.metadata.fontFamily=b.metadata.fontFamily.trim().replace(/\s+/g,"-").replace(/[^a-zA-Z\-\_0-9]/g,"")}catch(h){b.metadata.fontFamily="icomoon"}"svgdefs"===b.metadata.fontFamily&&(b.metadata.fontFamily="icomoon"),e.emSize=n(e.emSize),i!==f&&(i=f,e&&!isNaN(e.baseline)&&m()),b.cssVars&&g().get("variables.tmpl"),b.ie7&&(g().get("ie7.js.tmpl"),g().get("ie7.css.tmpl"))},!0)}(),a.download=function(){a.downloading=!0;var b=q();b.promise.then(function(){b.zip.save(b.fontName+".zip"),a.downloading=!1})},a.validateCode=function(a,b){var c=u.indexOf(a);return 0>a?!1:-1===c||u[c]===b?!0:!1},a.showEncoding=function(b,c){var d,e=0;for(d=0;b>d;d+=1)e+=a.glyphSets[d].length;e+=c,a.firstGlyphName=r[e].properties.name,a.visiblePanels.encoding={firstGlyphIdx:e}},a.resetCodes=function(b,c){var d,e=r.length;for(b=b||0,c=a.fontPref.resetPoint||0,c>126&&161>c&&(c=161),u.splice(b),d=b;e>d;d+=1)c=j(c),r[d].properties.code=c,c+=1;a.visiblePanels.encoding=!1},a.showLiga=function(b,c){var d,e=0;for(a.fontPref.ligaReset||(a.fontPref.ligaReset="tags"),d=0;b>d;d+=1)e+=a.glyphSets[d].length;e+=c,a.firstGlyphName=r[e].properties.name,a.visiblePanels.liga={firstGlyphIdx:e}},a.resetLigatures=function(b){var c,d,e="tags"===a.fontPref.ligaReset,f=r.length;for(s=[],c=0;b>c;c+=1)r[c].properties.ligatures=k(r[c].properties.ligatures||"");
for(c=b;f>c;c+=1)d=r[c].icon,r[c].properties.ligatures=k((e?d.tags.slice(0,2):r[c].properties.name)||"");a.visiblePanels.liga=!1},a.removeGlyph=function(a){a.properties.order=0},a.editGlyph=function(b){t=a.sortByGrid(t);var c=t[b.selectionIdx],d=[c.iconIdx];d.properties=b.properties,d.noNavigation=!0,a.changeIcons(d,c.setIdx,"edit")},a.max=Math.max,a.$on("$stateChangeStart",function(){URL&&URL.createObjectURL&&Blob&&URL.revokeObjectURL(a.localFont)}),a.getEmbedCode=function(b){var c,d,e,f,g,h=b.properties.code.toString(16),i="",j=a.fontPref,k=b.icon,l=b.properties.ligatures,m=b.properties.name.trim().split(/\s*,+\s*/)[0];if(c="i"===j.selector?"i":"span",d=(j.prefix||"")+m+(j.postfix||""),"class"===j.selector&&(i=j.classSelector.slice(1)+" "),a.embedCodes={html:"<"+c+' class="'+i+d+'">',css:"."+d+':before {\n    content: "\\'+h+'";\n}',htmlEntity:"&#x"+h+";"},k.isMulticolor){for(a.embedCodes.css="",e=0;e<k.attrs.length;e+=1)h=b.properties.codes[e].toString(16),g="\n    color: "+k.attrs[e].fill+";",e>0&&(a.embedCodes.htmlEntity+="&#x"+h+";",g+="\n    margin-left: "+b.marginLeft[e]+";",a.embedCodes.css+="\n"),a.embedCodes.css+="."+d+" .path"+(e+1)+':before {\n    content: "\\'+h+'";'+g+"\n}",a.embedCodes.html+='<span class="path'+(e+1)+'"></span>';a.embedCodes.cssLines=a.embedCodes.css.match(/\n/g).length+1}a.embedCodes.html+="</"+c+">",a.pref.showLiga&&l&&(f="i"===c?"":' class="'+(i.trim()||j.prefix||j.postfix)+'"',a.embedCodes.htmlLiga="<"+c+f+">"+l.split(/\s*,\s*/)[0]+"</"+c+">"),a.visiblePanels.getcode=!0},g().get("demo.html.tmpl"),g().get("demo.css.tmpl"),g().get("demo.js.tmpl"),g().get("style.css.tmpl"),g().get("readme.txt")}]),angular.module("icomoonApp").controller("ImageCtrl",["$scope","$state","$q","$filter","$timeout","message","fileSaver","template","svgPath","cloud","scriptLoader","color",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){return a=a.split(/\s*,\s*/),a.forEach(function(b,c){var d=2;if(-1!==q.indexOf(b)){for(;-1!==q.indexOf(b+d);)d+=1;b+=d}a[c]=b,q.push(b)}),a.join(", ")}function n(a){var b,c,d,e,f,g,h,i=a.attrs,j=a.path;for(c=new jsPDF({unit:"pt"}),c.deletePage(0),c.addPage([a.width,a.height]),a.bgColor&&(b=l(a.bgColor).toArray(),c.setFillColor(b[0],b[1],b[2]),c.rect(0,0,a.width,a.height,"F")),h=j.getPDFSegments(),e=0;e<h.length;e+=1)for(d=l(i&&i[e].fill||a.defaultColor||0).toArray(),f=0;f<h[e].length;f+=1)g=h[e][f],c.setFillColor(d[0],d[1],d[2]),c.lines(g.slice(1),g[0][0],g[0][1],[1,1],f+1===h[e].length?"f":null,!0);return c.output("arraybuffer")}function o(b){var d,e,f,g,j,k,l,m,o,p,q,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=b.glyphSets||a.glyphSets,M=[],N=0,O=a.imagePref,P=O.margin,Q=O.overrideSize?O.height:0,R=a.normSize,S={},T=[],U={width:0,height:0},V=[],W=0,X=0;for(j=O.color||0,j=a.getHexColor(j),j="#"+j,k='fill="'+j+'"',O.addBgColor&&(f="#"+O.bgColor.toString(16)),g=O.prefix||"icon-",l=O.columns,B="IcoMoon - "+s.length+" Icons.zip",O.useClassSelector?F=O.classSelector||".icon":(O.postfix&&(F='[class$="'+O.postfix+'"], [class*="'+O.postfix+' "]'),(!F||O.prefix)&&(F='[class^="'+g+'"], [class*=" '+g+'"]')),w=0;w<L.length;w+=1){for(G=L[w],G.glyphs=[],t=Q||G[0].properties.prevSize||32,M.push({idx:w+1,size:t}),W=0,z=0;z<G.length;z+=1){if(J=JSON.parse(JSON.stringify(G[z])),J.lines=!1,J.height=t,J.width=Math.round(J.viewBox.width/J.viewBox.height*t),J.bg=f?{width:J.width,height:J.height,color:f}:!1,J.fontSizeIdx=w+1,J.viewBox="0 0 "+(J.viewBox.width||R)+" "+(J.viewBox.height||R),J.prefix=O.prefix,J.postfix=O.postfix,J.selector=O.useClassSelector?(O.classSelector||".icon").slice(1)+" ":"",J.attrs=!1,J.icon.paths&&J.icon.isMulticolor&&J.icon.paths.length>1)for(d=[],J.attrs=[],J.redundantAttrs=[],A=0;A<J.icon.paths.length;A+=1){e={fill:J.icon.attrs&&J.icon.attrs[A]?J.icon.attrs[A].fill||"currentcolor":"currentcolor",prefix:J.prefix||"",postfix:J.postfix||"",glyphName:J.glyphName,idx:A+1,opacity:!1},x="#"+e.prefix+e.glyphName+e.postfix;try{K=J.icon.attrs[A].opacity,"number"==typeof K&&1!==K&&(e.opacity={value:K})}catch(Y){}J.redundantAttrs.push(e),y=d.indexOf(e.opacity+e.fill),-1===y?(d.push(e.opacity+e.fill),e.selector=[{s:x+" .path"+(A+1)}],J.attrs.push(e)):J.attrs[y].selector.push({s:", "+x+" .path"+(A+1)})}for(A=0;A<J.paths.length;A+=1)J.paths[A].idx=A+1,J.icon.attrs&&J.icon.attrs[A]&&(K=Object.create(J.icon.attrs[A]),J.icon.isMulticolor||(K.fill=j),J.paths[A].strAttrs=a.stringifyAttrs(J.icon.attrs[A])),J.paths[A].strAttrs=J.paths[A].strAttrs||" "+k;b.sprite&&(J.x=W,J.y=X,J.position=(W?"-"+W+"px":"0")+" "+(X?"-"+X+"px":"0"),K=(J.width+P)/(J.height+P),K>1?(K=Math.round(K),N+=K-1):K=1,0===(z+1+N)%l?(U.width=Math.max(U.width,W+J.width),W=0,z+1<G.length&&(X+=J.height+P)):W+=(J.height+P)*K),V.push(J),G.glyphs.push(J)}b.sprite&&(U.height=X+J.height,U.width=Math.max(U.width,W+J.width),X+=J.height+P),T[w]={glyphs:G.glyphs,grid:G.grid}}return V=V.length>0?V:!1,T=T.length>0?T:!1,M=M.length>0?M:!1,(b.defs||b.html||b.html2)&&(p=c.defer(),S.defs=p.promise,h().get("defs.svg").then(function(a){o=a.fillup({symbols:V}),p.resolve(o)})),b.html&&(u=c.defer(),S.html=u.promise,p.promise.then(function(){h().get("demo-svg.html").then(function(a){u.resolve(a.fillup({defs:o,sets:T}))})})),b.html2&&(v=c.defer(),S.html2=v.promise,p.promise.then(function(){h().get("demo-svg2.html").then(function(a){v.resolve(a.fillup({sets:T}))})})),b.demoCss&&(q=c.defer(),S.demoCss=q.promise,h().get("demo-svg.css").then(function(a){q.resolve(a.fillup({fontSizes:M,color:j}))})),b.css&&(m=c.defer(),S.css=m.promise,h().get("style-svg.css").then(function(a){var b=[];T&&T.forEach(function(a){var c,d,e=[];for(d=0;d<a.glyphs.length;d+=1)c=a.glyphs[d],c.classSelector=!1,(c.attrs||1!==c.w2hratio)&&(1!==c.w2hratio&&(c.classSelector=[{w2h:c.w2hratio,prefix:c.prefix,postfix:c.postfix,glyphName:c.glyphName}]),e.push(c));e.length&&b.push({glyphs:e,grid:a.grid})}),m.resolve(a.fillup({color:j,selector:F,sets:b.length?b:!1,bgColor:f?{value:f}:!1,prefix:O.prefix,postfix:O.postfix}))})),(b.svgs||b.sprite||b.png)&&(E=[],b.html&&E.push(u.promise),b.defs&&E.push(p.promise),b.svgs&&(I=c.defer(),S.svgs=I.promise),b.png&&(D=c.defer(),S.pngs=D.promise),b.pdf&&(C=c.defer(),E.push(r),S.pdfs=C.promise),b.sprite&&(H=c.defer(),S.sprite=H.promise),c.all(E).then(function(){h().get("image.svg").then(function(a){var c,d,e,g,k,l,m,o,p={},q=[];for(b.png&&(o=[],c=document.createElement("canvas")),b.pdf&&(m=[]),d=0;d<V.length;d+=1){for(g=V[d].icon,k=i(g.paths),k.viewBox={width:g.width||R,height:g.height||R},t=V[d].height,k.scale(t/k.viewBox.height),l=k.getPathData(!0),e=0;e<l.length;e+=1)V[d].paths[e].d=l[e];K=a.fillup(V[d]),b.png&&(c.width=V[d].width,c.height=V[d].height,canvg(c,K),o.push({name:V[d].glyphName+".png",data:c.toDataURL().replace(/.*,/m,"")})),b.pdf&&m.push({name:V[d].glyphName+".pdf",data:n({attrs:V[d].redundantAttrs,bgColor:f,defaultColor:j,path:k,width:V[d].width,height:V[d].height})}),q.push({name:V[d].glyphName+".svg",data:K})}b.svgs&&I.resolve(q),b.png&&D.resolve(o),b.pdf&&C.resolve(m),b.sprite&&h().get("sprite.svg").then(function(a){return K=a.fillup({g:V,width:U.width,height:U.height}),b.png&&(c=document.createElement("canvas"),c.width=U.width,c.height=U.height,canvg(c,K),p.png=c.toDataURL().replace(/.*,/m,"")),p.svg=K,h().get("sprite.html")}).then(function(a){return K=a.fillup({sets:T,fontSizes:M}),p.html=K,h().get("sprite.css")}).then(function(a){K=a.fillup({selector:F,bgColor:f?{value:f}:!1,sets:T}),p.css=K,H.resolve(p)})})})),S}var p,q,r,s,t;a.$watch(function(){return a.imagePref},function(b){b.prefix&&b.prefix.trim()||(b.useClassSelector?b.useClassSelector=!0:b.prefix="icon-"),b.pdf&&!r&&(r=k.load("components/jspdf/jspdf.min.js")),b.useClassSelector&&(b.classSelector=b.classSelector||"",b.classSelector="."+(b.classSelector.replace(/[^a-zA-Z\-\_0-9]/g,"").replace(/^[^a-zA-Z_\-]/,"").replace(/^-([^a-zA-Z_])/,"")||"icon")),t=e(function(){a.imagePref.autoHost&&a.host({onlyDev:!0})},2e3)},!0),function(){var b=[];a.$watch(function(){return s=a.getSelectedIcons(),JSON.stringify(s)+a.history.idx},function(){var c,d,f,g,h,j,k,l,n=a.imagePref.color||0,r=0/0,u=a.normSize,v=s.length;for(q=[],a.glyphNames={empty:""},s=a.sortByGrid(s),p=[],a.glyphSets=[],c=0;v>c;c+=1){for(l=s[c],d=l.icon,h=l.properties.name,h?h=m(h):(!h&&d.tags&&(h=d.tags[0].replace(/[^\w\d\-\_]/g,"").replace(/^\d+/,"")),h||(h="untitled"),/\s/.test(h)&&(h=h.replace(/\s/,"-")),h=m(h)),l.properties.name=h,j=i(d.paths),j.viewBox={width:d.width||u,height:d.height||u},k=j.getPathData(!0),f=0;f<k.length;f+=1)k[f]={d:k[f]},d.attrs&&d.attrs[f]&&(k[f].attrs=d.attrs[f]),/fill/.test(k[f].attrs)||(k[f].fill=' fill="#'+n+'"');p[c]={grid:d.grid,properties:l.properties,icon:d,selectionIdx:c,paths:k,viewBox:j.viewBox,w2hratio:j.viewBox.width/j.viewBox.height,glyphName:h.replace(/\s+/g,"").split(/,/)[0],setId:l.setId,iconIdx:l.iconIdx}}for(a.glyphs=p,f=-1,c=0;v>c;c+=1)p[c].grid!==r&&(r=p[c].grid,f+=1,b[f]=b[f]||[],b[f].grid=r,-1!==f&&b[f].splice(g),g=0),b[f][g]=p[c],b[f][g].properties.prevSize=b[f][0].properties.prevSize||r||32,g+=1;g&&-1!==f&&b[f].splice(g),b.splice(f+1),a.glyphSets=b,o({defs:!0}).defs.then(function(b){var c=b.length;1e3>c?a.size="less than 1 KB":(c=Math.round(c/1e3),a.size=c+" KB")}),e.cancel(t),t=e(function(){a.imagePref.autoHost&&a.host({onlyDev:!0})},2e3)})}(),a.removeGlyph=function(a){a.properties.order=0},a.editGlyph=function(b){s=a.sortByGrid(s);var c=s[b.selectionIdx],d=[c.iconIdx];d.properties=b.properties,d.noNavigation=!0,a.changeIcons(d,c.setIdx,"edit")},a.download=function(){var b,d,e,f=a.imagePref,i={},j=g();a.downloading=!0,b=o({html:!0,defs:!0,css:!0,demoCss:!0,svgs:!0,png:f.png,pdf:f.pdf,sprite:f.sprite}),i.htmlAdded=c.defer(),i.readMeAdded=c.defer(),i.defsAdded=c.defer(),i.cssAdded=c.defer(),i.demoCssAdded=c.defer(),i.svgsAdded=c.defer(),i.spriteAdded=c.defer(),d=[i.htmlAdded.promise,i.readMeAdded.promise,i.defsAdded.promise,i.cssAdded.promise,i.demoCssAdded.promise,i.svgsAdded.promise],e=JSON.parse(JSON.stringify(s)),e.forEach(function(a){delete a.properties.tempChar,delete a.icon.id,delete a.icon.matchesSearch}),e={IcoMoonType:"selection",icons:e,height:a.normSize,preferences:a.pref},j.add("selection.json",JSON.stringify(e,null,"	")),h().get("readme-svg.txt").then(function(a){j.add("Read Me.txt",a.fillup({selector:f.useClassSelector?(f.classSelector||".icon").slice(1)+" ":"",prefix:f.prefix,postfix:f.postfix,glyphName:s[0]?s[0].properties.name:"home"})),i.readMeAdded.resolve()}),b.html.then(function(a){j.add("demo.html",a),i.htmlAdded.resolve()}),b.defs.then(function(a){j.add("svgdefs.svg",a),i.defsAdded.resolve()}),b.css.then(function(a){j.add("style.css",a),i.cssAdded.resolve()}),b.demoCss.then(function(a){j.add("demo-files/demo.css",a),i.demoCssAdded.resolve()}),b.svgs.then(function(a){a.forEach(function(a){j.add("SVG/"+a.name,a.data)}),i.svgsAdded.resolve()}),f.png&&(i.pngsAdded=c.defer(),d.push(i.pngsAdded.promise),b.pngs.then(function(a){a.forEach(function(a){j.add("PNG/"+a.name,a.data,{base64:!0})}),i.pngsAdded.resolve()})),f.pdf&&(i.pdfsAdded=c.defer(),d.push(i.pdfsAdded.promise),b.pdfs.then(function(a){a.forEach(function(a){j.add("PDF/"+a.name,a.data)}),i.pdfsAdded.resolve()})),f.sprite&&(i.spriteAdded=c.defer(),d.push(i.spriteAdded.promise),b.sprite.then(function(a){j.add("sprite/sprite.html",a.html),j.add("sprite/sprite.css",a.css),j.add("sprite/sprite.svg",a.svg),f.png&&j.add("sprite/sprite.png",a.png,{base64:!0}),i.spriteAdded.resolve()})),c.all(d).then(function(){j.save("icomoon_"+s.length+"_icons.zip"),a.downloading=!1})},a.quickUsage={statusMessage:"Working"+String.fromCharCode(8230),placeholder:'<link rel="stylesheet" href="...">\n<script src="..."></script>'},function(){var b=h('<link rel="stylesheet" href="{{href}}">'),c=a.pref.imageUrlHash||0,d=h('<script src="{{src}}"></script>');a.pref.imageUrlS3&&(a.quickUsage.ref2=b.fillup({href:a.pref.imageUrlS3+"/style-svg.css?"+c})+"\n"+d.fillup({src:a.pref.imageUrlS3+"/svgembedder-s3.js?"+c})),a.pref.imageUrlCF&&(a.quickUsage.ref3=b.fillup({href:a.pref.imageUrlCF+"/style-svg.css?"+c})+"\n"+d.fillup({src:a.pref.imageUrlCF+"/svgembedder-cf.js?"+c}))}(),a.host=function(b){var d,e,f,i,k=b&&b.enable,l=a.imagePref,m=b&&b.onlyDev&&a.pref.imageUploadTime,n={},p=[];(l.autoHost||k)&&(e=o({html:!0,html2:!0,css:!0,defs:!0,demoCss:!0}),d=h().get(l.minifyJs?"svgembedder.min.js":"svgembedder.js"),p=[e.html,e.html2,e.css,e.defs,d],e.html.then(function(a){n.html=a}),e.html2.then(function(a){n.html2=a}),e.css.then(function(a){n.css=a}),e.defs.then(function(a){n.defs=a}),e.demoCss.then(function(a){n.demoCss=a}),d.then(function(a){n.js=a.fillup()}),i=g(),l.autoHost=!0,f=a.project.metadata.name.replace(/[^a-zA-Z\-\_0-9]/g,""),m=m&&a.pref.imageHostingName===f,a.pref.quickUsageToken&&a.pref.quickUsageToken[f]||(a.pref.quickUsageToken={}),a.onlineEditor={disabled:!0},c.all(p).then(function(){var b,c,d;i.add("style-svg.css",n.css),i.add("svgembedder.js",n.js),i.add("svgdefs.svg",n.defs),i.add("demo.css",n.demoCss),d=(n.css+n.js+n.defs).toString(!0),b=d.hashCode(),c={hash:b,zip:i.getArrayBuffer().toString(!0),name:f,token:a.pref.quickUsageToken[f],ssl:!0,type:"svg"},b=b.toString(36),m?(c.onlyDev=!0,a.quickUsage.uploading="Update",b=a.pref.imageUrlHash||0):a.quickUsage.uploading="Uploading"+String.fromCharCode(8230),a.history.ignore=!0,a.quickUsage.icon="sync fgc-warning",a.quickUsage.statusMessage="Uploading"+String.fromCharCode(8230),j.host(c).then(function(c){var d,e=h('<link rel="stylesheet" href="{{href}}">'),g=h('<script src="{{src}}"></script>'),i={};a.quickUsage.url=c.path+"/style-svg.css",i={html:"<!-- Add the following references to the <head> of your HTML.\nFor development purposes only. Do not use in Production. -->\n"},c.path&&(d=g.fillup({src:c.path+"/svgembedder.js"}),a.quickUsage.ref=e.fillup({href:c.path+"/style-svg.css"})+"\n"+d,i.html+=d,i.css_external=c.path+"/demo.css"),c.path2&&(a.quickUsage.ref2=e.fillup({href:c.path2+"/style-svg.css?"+b})+"\n"+g.fillup({src:c.path2+"/svgembedder-s3.js?"+b})),i.html+="\n"+n.html2,i.css=n.css,c.path3&&(a.quickUsage.ref3=e.fillup({href:c.path3+"/style-svg.css?"+b})+"\n"+g.fillup({src:c.path3+"/svgembedder-cf.js?"+b})),a.onlineEditor.data=JSON.stringify(i),a.onlineEditor.disabled=!1,a.pref.quickUsageToken[f]=c.token,a.history.ignore=!0,a.quickUsage.icon="check fgc-success",a.quickUsage.statusMessage="Ready",a.quickUsage.uploading=!1,!m&&c.path2&&(i=new Date,a.pref.imageUploadTime=i.toLocaleDateString()+", "+i.toLocaleTimeString(),a.pref.imageUrlS3=c.path2,a.pref.imageUrlCF=c.path3,a.pref.imageUrlHash=b,a.pref.imageHostingName=f),c.path2||(a.pref.imageHostingName=a.imageUploadTime=!1)},function(){a.quickUsage.icon="warning fgc-error",a.quickUsage.statusMessage="Upload Failed",a.quickUsage.uploading=!1})}))},a.getEmbedCode=function(b){var d,e,f="",g=a.imagePref,h=b.properties.name;d=(g.prefix||"")+h+(g.postfix||""),g.useClassSelector&&(f=g.classSelector.slice(1)+" "),e=o({defs:!0,css:!0,glyphSets:[[b]]}),e=[e.defs,e.css],c.all(e).then(function(b){var c,e=b[1],g=b[0];g=g.slice(g.indexOf("<symbol"),g.indexOf("</symbol>")+9),c=e.indexOf(d),e=-1===c?!1:e.slice(c-1),a.embedCodes={html:'<svg class="'+f+d+'"><use xlink:href="#'+d+'"></use></svg>',def:g,defLines:g.match(/\n/g).length+1,css:e,cssLines:e?e.match(/\n/g).length+1:0},a.visiblePanels.getcode2=!0})},a.getHexColor=function(a){for(a=a.toString(16);a.length<6;)a="0"+a;return a},h().get("demo-svg.html"),h().get("readme-svg.txt"),h().get("demo-svg.css"),h().get("style-svg.css"),h().get("defs.svg"),h().get("image.svg")}]),angular.module("icomoonApp").controller("ProjectsCtrl",["$scope","$state","$q","session","cloud","message","fileSaver","storage",function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=c.defer();!function(){var a=d("icomoon");h.load("currentProject",function(b){j=b,a.load("icomoon-lib/presets.json").then(function(b){var c,e,f,g=[],h=b.projects,i=!1;for(c=0,e=h.length;e>c;c+=1)h[c].iconSets&&(i=!0,f=(new Date).getTime()+c,h[c].metadata.created=f,d(f).quickSave(h[c])),g.push(h[c].metadata?h[c].metadata:h[c]);i?(b.projects=g,b.time+=1,a.quickSave(b).then(function(){n.resolve(b)})):n.resolve(b)})})}(),n.promise.then(function(c){function n(a){var b,c=[];if(a=a||"Untitled Project",a=a.replace(/\d+$/,"").trim(),l.projects.forEach(function(a){c.push(a.name)}),-1===c.indexOf(a))b="";else for(a+=" ",b=1;-1!==c.indexOf(a+b);)b+=1;return a+b}a.projectsReady=!0,function(){var b,d,e;for(l=c,e=l.projects.slice(0),a.order=l.order||"Date Created",l.order=a.order,a.projects=[],b=0,d=e.length;d>b;b+=1)a.projects.push({idx:b,metadata:e[b]}),e[b].created===j&&(i=a.projects[b]);!i&&d>0&&(i=a.projects[0])}();var o=d("icomoon");a.isSyncing=o.isSyncing,e.auth().then(function(){a.signedIn=!0},function(){a.signedIn=!1}),e.hasCloudAccess().then(function(){a.cloudAccess=!0},function(){a.cloudAccess=!1}),a.$watch("order",function(b){var c;c="Date Modified"===b?function(a,b){return b.metadata.lastOpened-a.metadata.lastOpened}:"Date Created"===b?function(a,b){return a.metadata.created-b.metadata.created}:function(a,b){return a.metadata.name>b.metadata.name},a.projects.sort(c)}),a.loadProject=function(c,e){var f;return i=!1,k=!0,e.loading=!0,a.projects.disabled=!0,e.disabled?(setTimeout(function(){a.loadProject(c,e)},200),void 0):(l.projects[c].lastOpened=(new Date).getTime(),l.projects[c].name=e.metadata.name,f=l.projects[c].created||l.projects[c].metadata.created,d(f).downloadProgressHandler=function(b){b.loaded!==b.total&&a.$apply(function(){var a=b.loaded/b.total;a>1&&(a=1),e.progress=a})},h.save("currentProject",f,function(){b.transitionTo("select").then(function(){o.save(l)})}),void 0)},a.newProject=function(b){var c,e,f;b=b||{},c={name:n(),lastOpened:0,created:(new Date).getTime()},e={metadata:c,iconSets:b.iconSets||[]},b.preferences&&(e.preferences=b.preferences),f={idx:l.projects.length,metadata:c,disabled:!0},a.projects.push(f),window.scrollTo(0,99999),d(c.created).quickSave(e).then(function(){l.projects.push(c),f.disabled=!1,o.quickSave(l)})},a.removeProject=function(b,c){var d=function(){var d=l.projects[b];d=d.created?d.created:d.metadata.created,h.remove(d),l.projects.splice(b,1),a.projects.splice(c,1),a.projects.forEach(function(a){a.idx>b&&(a.idx-=1)}),o.quickSave(l)};f.show({message:"Are you sure you want to remove this project?<br><strong>"+l.projects[b].name+"</strong>",firstButton:{caption:"Yes"},secondButton:{caption:"No",focused:!0}}).then(function(a){"Yes"===a&&d()})},a.downloadProject=function(a){d(l.projects[a].created).load().then(function(a){g().save(a.metadata.name+".json",JSON.stringify(a,null,"	"))})},a.import=function(b){var c,e,g,h,i,j,k,m,p;if(b)for(i=b.length,i||f.show("Please select IcoMoon project files (JSON)."),c=0;i>c;c+=1){if(k=JSON.parse(b[c].file),e="icon-set"===k.IcoMoonType,g="selection"===k.IcoMoonType,delete k.uid,delete k.premium,g&&k.icons){for(m=[],h=0,j=k.icons.length;j>h;h+=1)m[h]=k.icons[h].properties,k.icons[h]=k.icons[h].icon;k.selection=m}if((e||g)&&k.icons){if(delete k.IcoMoonType,!k.prevSize)try{k.prevSize=k.selection[0].prevSize}catch(q){}return a.newProject({iconSets:[k],preferences:k.preferences||!1}),void 0}k.iconSets&&k.metadata?(k.metadata.name=n(k.metadata.name),k.metadata.created=(new Date).getTime(),k.metadata.lastOpened=0,p={metadata:k.metadata,idx:l.projects.length,disabled:!0},a.projects.push(p),window.scrollTo(0,99999),d(k.metadata.created).quickSave(k).then(function(){l.projects.push(k.metadata),p.disabled=!1,o.quickSave(l)})):f.show("The project file you selected is not valid.")}},a.reset=function(){d.reset().then(function(){location.reload()})},a.$on("$stateChangeStart",function(){i&&(i.loading=!0,a.projects.disabled=!0,k=!0)}),a.$watch(function(){return a.order+JSON.stringify(a.projects)},function(){return clearTimeout(m),k?(o.quickSave(l),void 0):(a.projects.forEach(function(b,c){var e;b.metadata.name=b.metadata.name.trim(),b.metadata.name||(b.metadata.name=n("Untitled Project")),l.projects[b.idx]&&(l.projects[b.idx].name=b.metadata.name,e=d(b.metadata.created),e.load().then(function(a){a&&a.metadata&&a.metadata.name!==b.metadata.name&&(a.metadata.name=b.metadata.name,e.quickSave())},function(d){"no such project"===d&&(l.projects.splice(b.idx,1),a.projects.splice(c,1))}))}),m=setTimeout(function(){l.order=a.order,k||o.quickSave(l)},1e3),void 0)})})}]),angular.module("icomoonApp").controller("LibCtrl",["$scope","$http","$state","iconSets","cloud",function(a,b,c,d,e){var f=e.getPurchases().then(function(a){var b=[];return a.forEach(function(a){isNaN(a.product)||(b[a.product]=a.jsonlink)}),b});!function(){var a=[];d.forEach(function(b){b.ignore||a.push(b)}),d=a}(),a.$watch(function(){return a.project.iconSets.slice(0)},function(b){var c,e,g,h,i,j=[];for(c=function(a,b){var c=a[b.productId];c?(b.hasAccess=!0,b.json=c):b.hasAccess=!1},h=b.length,e=0;h>e;e+=1)i=b[e],b[e]=i.metadata.name,j[e]=a.getSetHash(i);for(e=0,h=d.length;h>e;e+=1)i=d[e],g=b.indexOf(i.name),i.button={},-1===g?(i.added=i.latest=!1,i.button.caption="Add",i.button.caption2="Adding",i.button.icon="plus"):(i.added={idx:g},i.latest=-1!==j.indexOf(i.iconsHash),i.latest?(i.button.caption="Remove",i.button.caption2="Removing",i.button.icon="minus"):(i.button.caption="Restore / Update",i.button.caption2="Loading",i.button.icon="sync")),i.purchaseLink?(i.hasAccess="loading",function(a){f.then(function(b){c(b,a)})}(i)):i.hasAccess=!0},!0),a.addremove=function(d){var e={transformResponse:!1};d.added&&d.latest&&a.removeSet(d.added.idx),d.latest||(d.button.disabled=!0,d.productId&&(e.withCredentials=!0),b.get(d.json,e).then(function(b){d.added&&a.removeSet(d.added.idx,!0),a.import([{file:b.data}]).finally(function(){a.scrollPositions.select=0,c.transitionTo("select"),d.button.disabled=!1})}))},a.iconSets=d,a.packSubmission={},a.submitPack=function(){a.packSubmission.url&&(a.packSubmission.sending=!0,e.contact({email:a.packSubmission.email,msg:"<b>Icon Pack Submission</b><br /><br />URL: "+a.packSubmission.url}).then(function(){a.packSubmission={submitted:!0}}).finally(function(){a.packSubmission={}}))}}]);